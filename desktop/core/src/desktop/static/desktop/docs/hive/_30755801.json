{"body":"<div><div>\n        <div id=\"title\">\n                        <h1 class=\"hue-doc-title-hive\">Exchange Partition</h1>\n        </div>\n\n        <!--<div id=\"toc\" class=\"content prepend-top\">\n            <h1>Table of Contents</h1>\n            $replacement.render(\"toc\")\n        </div>-->\n\n        <div id=\"src-30755801\">\n            <p>\n    The EXCHANGE PARTITION command will move a partition from a source table to target table and alter each table's metadata. The Exchange Partition feature is implemented as part of <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-4095\" target=\"_blank\">HIVE-4095</a>. Exchanging multiple partitions is supported in Hive versions 1.2.2, 1.3.0, and 2.0.0+ as part of <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-11745\" target=\"_blank\">HIVE-11745</a>.            </p>\n                <p>\n    When the command is executed, the source table's partition folder in HDFS will be renamed to move it to the destination table's partition folder. The Hive metastore will be updated to change the metadata of the source and destination tables accordingly.            </p>\n                <p>\n    The partition specification can be fully or <a data-doc-anchor-id=\"src-30755801_safe-id-RXhjaGFuZ2VQYXJ0aXRpb24tRXhhbXBsZVVzYWdl4oCTUGFydGlhbFBhcnRpdGlvblNwZWM\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_30755801\">partially specified</a>.            </p>\n                <p>\n    See <a data-doc-anchor-id=\"src-27362034_LanguageManualDDL-ExchangePartition\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_27362034\">Language Manual DDL</a> for additional information on the Exchange Partition feature.            </p>\n        <div id=\"src-30755801_ExchangePartition-Constraints\">\n        <h2><span>Constraints</span></h2>\n<ul><li>            <p>\n    The destination table cannot contain the partition to be exchanged.            </p>\n    </li></ul><ul><li>            <p>\n    The operation fails in the presence of an index.            </p>\n    </li><li>            <p>\n    Exchange partition is not allowed with transactional tables either as source or destination. Alternatively, use <a data-doc-anchor-id=\"src-27362036_LanguageManualDML-Loadingfilesintotables\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_27362036\">LOAD DATA</a> or <a data-doc-anchor-id=\"src-27362036_LanguageManualDML-InsertingdataintoHiveTablesfromqueries\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_27362036\">INSERT OVERWRITE</a> commands to move partitions across transactional tables.            </p>\n    </li><li>            <p>\n    This command requires both the source and destination table names to have the same table schema.<br>If the schemas are different, the following exception is thrown:            </p>\n                <p>\n    <tt>The tables have different schemas. Their partitions cannot be exchanged</tt>            </p>\n    </li></ul>    </div>\n    <div id=\"src-30755801_ExchangePartition-Syntax\">\n        <h2><span>Syntax</span></h2>\n    <div style=\"counter-reset: scroll-code-numbering 1\">\n                <div class=\"hue-doc-codeblock\">ALTER TABLE <dest_table> EXCHANGE PARTITION () WITH TABLE <src_table>\n</src_table></dest_table></div>\n    </div>\n    </div>\n    <div id=\"src-30755801_safe-id-RXhjaGFuZ2VQYXJ0aXRpb24tRXhhbXBsZVVzYWdl4oCTQmFzaWM\">\n        <h2><span>Example Usage – Basic</span></h2>\n    <div style=\"counter-reset: scroll-code-numbering 1\">\n                <div class=\"hue-doc-codeblock\">--Create two tables, partitioned by ds\nCREATE TABLE T1(a string, b string) PARTITIONED BY (ds string);\nCREATE TABLE T2(a string, b string) PARTITIONED BY (ds string);\nALTER TABLE T1 ADD PARTITION (ds='1');\n \n--Move partition from T1 to T2\nALTER TABLE T2 EXCHANGE PARTITION (ds='1') WITH TABLE T1;\n</div>\n    </div>\n    </div>\n    <div id=\"src-30755801_safe-id-RXhjaGFuZ2VQYXJ0aXRpb24tRXhhbXBsZVVzYWdl4oCTUGFydGlhbFBhcnRpdGlvblNwZWMoRXhjaGFuZ2luZ011bHRpcGxlUGFydGl0aW9ucyk\">\n        <h2><span>Example Usage – Partial Partition Spec (Exchanging Multiple Partitions)</span></h2>\n    <div style=\"counter-reset: scroll-code-numbering 1\">\n                <div class=\"hue-doc-codeblock\">--Create two tables with multiple partition columns.\nCREATE TABLE T1 (a string, b string) PARTITIONED BY (ds string, hr string);\nCREATE TABLE T2 (a string, b string) PARTITIONED BY (ds string, hr string);\nALTER TABLE T1 ADD PARTITION (ds = '1', hr = '00');\nALTER TABLE T1 ADD PARTITION (ds = '1', hr = '01');\nALTER TABLE T1 ADD PARTITION (ds = '1', hr = '03');\n \n--Alter the table, moving all the three partitions data where ds='1' from table T1 to table T2 (ds=1) \nALTER TABLE T2 EXCHANGE PARTITION (ds='1') WITH TABLE T1;\n</div>\n    </div>\n            <p>\n    <i>Note that the schema for T1 is being used for the newly created partition T2(ds=1). Either all the partitions of T1 will get created or the whole operation will fail. All partitions of T1 are dropped.</i>            </p>\n        </div>\n    <div id=\"src-30755801_safe-id-RXhjaGFuZ2VQYXJ0aXRpb24tRXhhbXBsZVVzYWdl4oCTUGFydGl0aW9uU3BlY1dpdGhNdWx0aXBsZVBhcnRpdGlvbkNvbHVtbnM\">\n        <h2><span>Example Usage – Partition Spec With Multiple Partition Columns</span></h2>\n    <div style=\"counter-reset: scroll-code-numbering 1\">\n                <div class=\"hue-doc-codeblock\">-- Create two tables with multiple partition columns.\nCREATE TABLE T1 (a int) PARTITIONED BY (d1 int, d2 int);\nCREATE TABLE T2 (a int) PARTITIONED BY (d1 int, d2 int);\nALTER TABLE T1 ADD PARTITION (d1=1, d2=2);\n \n-- Alter the table, moving partition data d1=1, d2=2 from table T1 to table T2\nALTER TABLE T2 EXCHANGE PARTITION (d1 = 1, d2 = 2) WITH TABLE T1;\n</div>\n    </div>\n    </div>\n        </div>\n    </div></div>","title":"Exchange Partition"}