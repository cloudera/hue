{"body":"<div><div>\n        <div id=\"title\">\n                        <h1 class=\"hue-doc-title-hive\">Storage Based Authorization in the Metastore Server</h1>\n        </div>\n\n        <!--<div id=\"toc\" class=\"content prepend-top\">\n            <h1>Table of Contents</h1>\n            $replacement.render(\"toc\")\n        </div>-->\n\n        <div id=\"src-45876440\">\n            <p>\n                </p>\n    <ul><li>            <p>\n    <a data-doc-anchor-id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-StorageBasedAuthorizationintheMetastoreServer\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_45876440\">Storage Based Authorization in the Metastore Server</a>            </p>\n    <ul><li>            <p>\n    <a data-doc-anchor-id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-TheNeedforMetastoreServerSecurity\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_45876440\">The Need for Metastore Server Security</a>            </p>\n    </li><li>            <p>\n    <a data-doc-anchor-id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-StorageBasedAuthorization\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_45876440\">Storage Based Authorization</a>            </p>\n    </li><li>            <p>\n    <a data-doc-anchor-id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-ConfigurationParametersforMetastoreSecurity\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_45876440\">Configuration Parameters for Metastore Security</a>            </p>\n    <ul><li>            <p>\n    <a data-doc-anchor-id=\"src-45876440_safe-id-U3RvcmFnZUJhc2VkQXV0aG9yaXphdGlvbmludGhlTWV0YXN0b3JlU2VydmVyLVNhbXBsZWhpdmUtc2l0ZS54bWw6RGVmYXVsdFNldHRpbmdz\" class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_45876440\">Sample hive-site.xml: Default Settings</a>            </p>\n    </li></ul></li></ul></li></ul>            <p>\n                </p>\n        <div id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-StorageBasedAuthorizationintheMetastoreServer\">\n        <h2><span>Storage Based Authorization in the Metastore Server</span></h2>\n            <p>\n    The metastore server security feature with storage based authorization was added to Hive in release 0.10. This feature was introduced previously in <a class=\"hue-doc-external-link\" href=\"https://cwiki.apache.org/confluence/display/Hive/HCatalog+Authorization\" target=\"_blank\">HCatalog</a>.            </p>\n        <div class=\"hue-doc-note-hive\">\n            <div>Version 0.10.0</div>\n                    <p>\n    <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-3705\" target=\"_blank\">HIVE-3705</a> added metastore server security to Hive in release 0.10.0.            </p>\n        </div>\n    <ul><li>            <p>\n    For additional information about storage based authorization in the metastore server, see the HCatalog document <a class=\"hue-doc-external-link\" href=\"https://cwiki.apache.org/confluence/display/Hive/HCatalog+Authorization\" target=\"_blank\">Storage Based Authorization</a>.            </p>\n    </li><li>            <p>\n    For an overview of Hive authorization models and other security options, see the <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"_27362032\">Authorization</a> document.            </p>\n    </li></ul>    <div id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-TheNeedforMetastoreServerSecurity\">\n        <h3><span>The Need for Metastore Server Security</span></h3>\n            <p>\n    When multiple clients access the same metastore in a backing database, such as MySQL, the database connection credentials may be visible in the <tt>hive-site.xml</tt> configuration file. A malicious or incompetent user could cause serious damage to metadata even though the underlying data is protected by HDFS access controls.            </p>\n                <p>\n    Also, when a Hive metastore server uses Thrift to communicate with clients and has a backing database for metadata storage and persistence, the authentication and authorization done on the client side cannot guarantee security on the metastore side. To provide security for metadata, Hive release 0.10 added authorization capability to the metastore. (See <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-3705\" target=\"_blank\">HIVE-3705</a>.)            </p>\n        </div>\n    <div id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-StorageBasedAuthorization\">\n        <h3><span>Storage Based Authorization</span></h3>\n            <p>\n    When metastore server security is configured to use Storage Based Authorization, it uses the file system permissions for folders corresponding to the different metadata objects as the source of truth for the authorization policy. Use of Storage Based Authorization in metastore is recommended.            </p>\n                <p>\n    See details in the HCatalog <a class=\"hue-doc-external-link\" href=\"https://cwiki.apache.org/confluence/display/Hive/HCatalog+Authorization\" target=\"_blank\">Storage Based Authorization document</a>.            </p>\n                <p>\n    Starting in Hive 0.14, storage based authorization authorizes read privilege on database and tables. The <tt>get_database</tt> api call needs database directory read privilege. The <tt>get_table_*</tt> calls that fetch table information and <tt>get_partition_*</tt> calls to list the partitions of a table require read privilege on the table directory. It is enabled by default with storage based authorization. See hive.security.metastore.authorization.auth.reads in the next section on configuration.            </p>\n        </div>\n    <div id=\"src-45876440_StorageBasedAuthorizationintheMetastoreServer-ConfigurationParametersforMetastoreSecurity\">\n        <h3><span>Configuration Parameters for Metastore Security</span></h3>\n            <p>\n    To enable Hive metastore server security, set these parameters in <tt>hive-site.xml</tt>:            </p>\n    <ul><li>            <p>\n    <tt>hive.metastore.pre.event.listeners</tt>            </p>\n                <p>\n    Set to <tt>org.apache.hadoop.hive.ql.security.authorization.AuthorizationPreEventListener</tt> .            </p>\n                <p>\n    This turns on metastore-side security.            </p>\n    </li><li>            <p>\n    <tt>hive.security.metastore.authorization.manager</tt>            </p>\n                <p>\n    Set to <tt>org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider</tt> .            </p>\n                <p>\n    This tells Hive which metastore-side authorization provider to use. The default setting uses <tt>DefaultHiveMetastoreAuthorizationProvider</tt>, which implements the standard Hive grant/revoke model. To use an HDFS permission-based model (recommended) to do your authorization, use <tt>StorageBasedAuthorizationProvider</tt> as instructed above.            </p>\n        <div class=\"hue-doc-note-hive\">\n            <div>Versions 0.10.0 and 0.12.0</div>\n                    <p>\n    The <tt>StorageBasedAuthorizationProvider</tt> was introduced in Hive 0.10.0, running on the metastore side only (<a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-3705\" target=\"_blank\">HIVE-3705</a>). Starting in Hive 0.12.0 it also runs on the client side (<a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-5048\" target=\"_blank\">HIVE-5048</a> and <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-5402\" target=\"_blank\">HIVE-5402</a>).            </p>\n        </div>\n    </li></ul><ul><li>            <p>\n    hive.security.metastore.authenticator.manager            </p>\n                <p>\n    Set to <tt>org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator</tt> .            </p>\n    </li><li>            <p>\n    <tt>hive.security.metastore.authorization.auth.reads</tt><br>When this is set to true, Hive metastore authorization also checks for read access. It is set to true by default. Read authorization checks were introduced in <a class=\"hue-doc-external-link\" href=\"https://issues.apache.org/jira/browse/HIVE-8221\" target=\"_blank\">Hive 0.14.0</a>.            </p>\n    </li></ul>    <div id=\"src-45876440_safe-id-U3RvcmFnZUJhc2VkQXV0aG9yaXphdGlvbmludGhlTWV0YXN0b3JlU2VydmVyLVNhbXBsZWhpdmUtc2l0ZS54bWw6RGVmYXVsdFNldHRpbmdz\">\n        <h4><span>Sample hive-site.xml: Default Settings</span></h4>\n            <p>\n    The snippet below shows the keys as they are in a default state in <tt>hive-site.xml</tt> (metastore-side security set up to use the default authorization/authentication, but disabled). Please edit in information as above to get the desired authorization behaviour:            </p>\n        <div>\n                <div>\n        <pre><code>&lt;property&gt;\n  &lt;name&gt;hive.security.metastore.authorization.manager&lt;/name&gt;\n  &lt;value&gt;org.apache.hadoop.hive.ql.security.authorization.DefaultHiveMetastoreAuthorizationProvider&lt;/value&gt;\n  &lt;description&gt;authorization manager class name to be used in the metastore for authorization.\n  The user defined authorization class should implement interface\n  org.apache.hadoop.hive.ql.security.authorization.HiveMetastoreAuthorizationProvider.\n  &lt;/description&gt;\n &lt;/property&gt;\n\n&lt;property&gt;\n  &lt;name&gt;hive.security.metastore.authenticator.manager&lt;/name&gt;\n  &lt;value&gt;org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator&lt;/value&gt;\n  &lt;description&gt;authenticator manager class name to be used in the metastore for authentication.\n  The user defined authenticator should implement interface \n  org.apache.hadoop.hive.ql.security.HiveAuthenticationProvider.\n  &lt;/description&gt;\n&lt;/property&gt;\n\n&lt;property&gt;\n  &lt;name&gt;hive.metastore.pre.event.listeners&lt;/name&gt;\n  &lt;value&gt; &lt;/value&gt;\n  &lt;description&gt;pre-event listener classes to be loaded on the metastore side to run code\n  whenever databases, tables, and partitions are created, altered, or dropped.\n  Set to org.apache.hadoop.hive.ql.security.authorization.AuthorizationPreEventListener\n  if metastore-side authorization is desired.\n  &lt;/description&gt;\n&lt;/property&gt;</code></pre>\n        </div>\n    </div>\n    </div>\n    </div>\n    </div>\n        </div>\n    </div></div>","title":"Storage Based Authorization in the Metastore Server"}