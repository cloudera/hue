{"body":"<div><div id=\"update\"><div class=\"hue-doc-title\">UPDATE Statement (Impala 2.8 or higher only)</div><div><p>\n      Updates an arbitrary number of rows in a Kudu table.\n      This statement only works for Impala tables that use the Kudu storage engine.\n    </p><p id=\"syntax_blurb\"><b>Syntax:</b></p><div class=\"hue-doc-codeblock\">UPDATE [<span class=\"hue-doc-varname\">database_name</span>.]<span class=\"hue-doc-varname\">table_name</span> SET <span class=\"hue-doc-varname\">col</span> = <span class=\"hue-doc-varname\">val</span> [, <span class=\"hue-doc-varname\">col</span> = <span class=\"hue-doc-varname\">val</span> ... ]\n  [ FROM <span class=\"hue-doc-varname\">joined_table_refs</span> ]\n  [ WHERE <span class=\"hue-doc-varname\">where_conditions</span> ]\n</div><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p>\n      None of the columns that make up the primary key can be updated by the\n      <span class=\"hue-doc-codeph\">SET</span> clause.\n    </p><p>\n      The conditions in the <span class=\"hue-doc-codeph\">WHERE</span> clause are the same ones allowed\n      for the <span class=\"hue-doc-codeph\">SELECT</span> statement. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_select.xml\" data-doc-anchor-id=\"select\">SELECT Statement</a>\n      for details.\n    </p><p>\n      If the <span class=\"hue-doc-codeph\">WHERE</span> clause is omitted, all rows in the table are updated.\n    </p><p>\n      The conditions in the <span class=\"hue-doc-codeph\">WHERE</span> clause can refer to\n      any combination of primary key columns or other columns. Referring to\n      primary key columns in the <span class=\"hue-doc-codeph\">WHERE</span> clause is more efficient\n      than referring to non-primary key columns.\n    </p><p>\n      Because Kudu currently does not enforce strong consistency during concurrent DML operations,\n      be aware that the results after this statement finishes might be different than you\n      intuitively expect:\n    </p><ul><li><p>\n          If some rows cannot be updated because their\n          some primary key columns are not found, due to their being deleted\n          by a concurrent <span class=\"hue-doc-codeph\">DELETE</span> operation,\n          the statement succeeds but returns a warning.\n        </p></li><li><p>\n          An <span class=\"hue-doc-codeph\">UPDATE</span> statement might also overlap with\n          <span class=\"hue-doc-codeph\">INSERT</span>, <span class=\"hue-doc-codeph\">UPDATE</span>,\n          or <span class=\"hue-doc-codeph\">UPSERT</span> statements running concurrently on the same table.\n          After the statement finishes, there might be more or fewer matching rows than expected\n          in the table because it is undefined whether the <span class=\"hue-doc-codeph\">UPDATE</span> applies to rows\n          that are inserted or updated while the <span class=\"hue-doc-codeph\">UPDATE</span> is in progress.\n        </p></li></ul><p>\n      The number of affected rows is reported in an <span class=\"hue-doc-cmdname\">impala-shell</span> message\n      and in the query profile.\n    </p><p>\n      The optional <span class=\"hue-doc-codeph\">FROM</span> clause lets you restrict the\n      updates to only the rows in the specified table that are part\n      of the result set for a join query. The join clauses can include\n      non-Kudu tables, but the table from which the rows are deleted\n      must be a Kudu table.\n    </p><p id=\"dml_blurb_kudu\"><b>Statement type:</b> DML\n      </p><div class=\"hue-doc-note\" id=\"compute_stats_next\">        After adding or replacing data in a table used in performance-critical queries, issue a\n        <span class=\"hue-doc-codeph\">COMPUTE STATS</span> statement to make sure all statistics are up-to-date.\n        Consider updating statistics for a table after any <span class=\"hue-doc-codeph\">INSERT</span>, <span class=\"hue-doc-codeph\">LOAD\n        DATA</span>, or <span class=\"hue-doc-codeph\">CREATE TABLE AS SELECT</span> statement in Impala, or after\n        loading data through Hive and doing a <span class=\"hue-doc-codeph\">REFRESH\n        <span class=\"hue-doc-varname\">table_name</span></span> in Impala. This technique is especially important\n        for tables that are very large, used in join queries, or both.\n      </div><p id=\"example_blurb\"><b>Examples:</b></p><p>\n      The following examples show how to perform a simple update\n      on a table, with or without a <span class=\"hue-doc-codeph\">WHERE</span> clause:\n    </p><div class=\"hue-doc-codeblock\">-- Set all rows to the same value for column c3.\n-- In this case, c1 and c2 are primary key columns\n-- and so cannot be updated.\nUPDATE kudu_table SET c3 = 'not applicable';\n\n-- Update only the rows that match the condition.\nUPDATE kudu_table SET c3 = NULL WHERE c1 &gt; 100 AND c3 IS NULL;\n\n-- Does not update any rows, because the WHERE condition is always false.\nUPDATE kudu_table SET c3 = 'impossible' WHERE 1 = 0;\n\n-- Change the values of multiple columns in a single UPDATE statement.\nUPDATE kudu_table SET c3 = upper(c3), c4 = FALSE, c5 = 0 WHERE c6 = TRUE;\n</div><p>\n      The following examples show how to perform an update using the\n      <span class=\"hue-doc-codeph\">FROM</span> keyword with a join clause:\n    </p><div class=\"hue-doc-codeblock\">-- Uppercase a column value, only for rows that have\n-- an ID that matches the value from another table.\nUPDATE kudu_table SET c3 = upper(c3)\n  FROM kudu_table JOIN non_kudu_table\n  ON kudu_table.id = non_kudu_table.id;\n\n-- Same effect as previous statement.\n-- Assign table aliases in FROM clause, then refer to\n-- short names elsewhere in the statement.\nUPDATE t1 SET c3 = upper(c3)\n  FROM kudu_table t1 JOIN non_kudu_table t2\n  ON t1.id = t2.id;\n\n-- Same effect as previous statements, but more efficient.\n-- Use WHERE clause to skip updating values that are\n-- already uppercase.\nUPDATE t1 SET c3 = upper(c3)\n  FROM kudu_table t1 JOIN non_kudu_table t2\n  ON t1.id = t2.id\n  WHERE c3 != upper(c3);\n</div><p id=\"related_info\"><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_kudu.xml\" data-doc-anchor-id=\"impala_kudu\">Using Impala to Query Kudu Tables</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"insert\">INSERT Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_delete.xml\" data-doc-anchor-id=\"delete\">DELETE Statement (Impala 2.8 or higher only)</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_upsert.xml\" data-doc-anchor-id=\"upsert\">UPSERT Statement (Impala 2.8 or higher only)</a></p></div></div></div>","title":"UPDATE Statement (Impala 2.8 or higher only)"}