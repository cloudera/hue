{"body":"<div><div id=\"tables\"><div class=\"hue-doc-title\">Overview of Impala Tables</div><div><p/><p>\n      Tables are the primary containers for data in Impala. They have the familiar row and column layout similar to\n      other database systems, plus some features such as partitioning often associated with higher-end data\n      warehouse systems.\n    </p><p>\n      Logically, each table has a structure based on the definition of its columns, partitions, and other\n      properties.\n    </p><p>\n      Physically, each table that uses HDFS storage is associated with a directory in HDFS. The table data consists of all the data files\n      underneath that directory:\n    </p><ul><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_tables.xml\" data-doc-anchor-id=\"internal_tables\">Internal tables</a> are managed by Impala, and use directories\n        inside the designated Impala work area.\n      </li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_tables.xml\" data-doc-anchor-id=\"external_tables\">External tables</a> use arbitrary HDFS directories, where\n        the data files are typically shared between different Hadoop components.\n      </li><li>\n        Large-scale data is usually handled by partitioned tables, where the data files are divided among different\n        HDFS subdirectories.\n      </li></ul><p>\n      Impala tables can also represent data that is stored in HBase, or in the Amazon S3 filesystem (Impala 2.2 or higher),\n      or on Isilon storage devices (Impala 2.2.3 or higher).  See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_hbase.xml\" data-doc-anchor-id=\"impala_hbase\">Using Impala to Query HBase Tables</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_s3.xml\" data-doc-anchor-id=\"s3\">Using Impala with Amazon S3 Object Store</a>, and <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_isilon.xml\" data-doc-anchor-id=\"impala_isilon\">Using Impala with Isilon Storage</a>\n      for details about those special kinds of tables.\n    </p><p id=\"ignore_file_extensions\">\n        Impala queries ignore files with extensions commonly used for temporary work files by\n        Hadoop tools. Any files with extensions <span class=\"hue-doc-codeph\">.tmp</span> or\n        <span class=\"hue-doc-codeph\">.copying</span> are not considered part of the Impala table. The suffix\n        matching is case-insensitive, so for example Impala ignores both\n        <span class=\"hue-doc-codeph\">.copying</span> and <span class=\"hue-doc-codeph\">.COPYING</span> suffixes.\n      </p><p/><p><b>Related statements:</b><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_create_table.xml\" data-doc-anchor-id=\"create_table\">CREATE TABLE Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_drop_table.xml\" data-doc-anchor-id=\"drop_table\">DROP TABLE Statement</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_alter_table.xml\" data-doc-anchor-id=\"alter_table\">ALTER TABLE Statement</a><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"insert\">INSERT Statement</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_load_data.xml\" data-doc-anchor-id=\"load_data\">LOAD DATA Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_select.xml\" data-doc-anchor-id=\"select\">SELECT Statement</a></p></div><div id=\"internal_tables\"><div class=\"hue-doc-title\">Internal Tables</div><div><p>\n        The default kind of table produced by the <span class=\"hue-doc-codeph\">CREATE TABLE</span> statement is known as an internal\n        table. (Its counterpart is the external table, produced by the <span class=\"hue-doc-codeph\">CREATE EXTERNAL TABLE</span>\n        syntax.)\n      </p><ul><li><p>\n            Impala creates a directory in HDFS to hold the data files.\n          </p></li><li><p>\n            You can create data in internal tables by issuing <span class=\"hue-doc-codeph\">INSERT</span> or <span class=\"hue-doc-codeph\">LOAD DATA</span>\n            statements.\n          </p></li><li><p>\n            If you add or replace data using HDFS operations, issue the <span class=\"hue-doc-codeph\">REFRESH</span> command in\n            <span class=\"hue-doc-cmdname\">impala-shell</span> so that Impala recognizes the changes in data files, block locations,\n            and so on.\n          </p></li><li><p>\n            When you issue a <span class=\"hue-doc-codeph\">DROP TABLE</span> statement, Impala physically removes all the data files\n            from the directory.\n          </p></li><li><p id=\"check_internal_external_table\">\n        To see whether a table is internal or external, and its associated HDFS location, issue\n        the statement <span class=\"hue-doc-codeph\">DESCRIBE FORMATTED <span class=\"hue-doc-varname\">table_name</span></span>. The\n        <span class=\"hue-doc-codeph\">Table Type</span> field displays <span class=\"hue-doc-codeph\">MANAGED_TABLE</span> for internal\n        tables and <span class=\"hue-doc-codeph\">EXTERNAL_TABLE</span> for external tables. The\n        <span class=\"hue-doc-codeph\">Location</span> field displays the path of the table directory as an HDFS URI.\n      </p></li><li><p>\n            When you issue an <span class=\"hue-doc-codeph\">ALTER TABLE</span> statement to rename an internal table, all data files\n            are moved into the new HDFS directory for the table. The files are moved even if they were formerly in\n            a directory outside the Impala data directory, for example in an internal table with a\n            <span class=\"hue-doc-codeph\">LOCATION</span> attribute pointing to an outside HDFS directory.\n          </p></li></ul><p id=\"example_blurb\"><b>Examples:</b></p><p id=\"switch_internal_external_table\"> You can switch a table from\n        internal to external, or from external to internal, by using the\n          <span class=\"hue-doc-codeph\">ALTER TABLE</span> statement:\n        <div class=\"hue-doc-codeblock\">-- Switch a table from internal to external.\nALTER TABLE <span class=\"hue-doc-varname\">table_name</span> SET TBLPROPERTIES('EXTERNAL'='TRUE');\n\n-- Switch a table from external to internal.\nALTER TABLE <span class=\"hue-doc-varname\">table_name</span> SET TBLPROPERTIES('EXTERNAL'='FALSE');\n</div>If\n        the Kudu service is integrated with the Hive Metastore, the above\n        operations are not supported.</p><p id=\"related_info\"><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_tables.xml\" data-doc-anchor-id=\"external_tables\">External Tables</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_create_table.xml\" data-doc-anchor-id=\"create_table\">CREATE TABLE Statement</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_drop_table.xml\" data-doc-anchor-id=\"drop_table\">DROP TABLE Statement</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_alter_table.xml\" data-doc-anchor-id=\"alter_table\">ALTER TABLE Statement</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_describe.xml\" data-doc-anchor-id=\"describe\">DESCRIBE Statement</a></p></div></div><div id=\"external_tables\"><div class=\"hue-doc-title\">External Tables</div><div><p>\n        The syntax <span class=\"hue-doc-codeph\">CREATE EXTERNAL TABLE</span> sets up an Impala table that points at existing data\n        files, potentially in HDFS locations outside the normal Impala data directories.. This operation saves the\n        expense of importing the data into a new table when you already have the data files in a known location in\n        HDFS, in the desired file format.\n      </p><ul><li><p>\n            You can use Impala to query the data in this table.\n          </p></li><li><p>\n            You can create data in external tables by issuing <span class=\"hue-doc-codeph\">INSERT</span> or <span class=\"hue-doc-codeph\">LOAD DATA</span>\n            statements.\n          </p></li><li><p>\n            If you add or replace data using HDFS operations, issue the <span class=\"hue-doc-codeph\">REFRESH</span> command in\n            <span class=\"hue-doc-cmdname\">impala-shell</span> so that Impala recognizes the changes in data files, block locations,\n            and so on.\n          </p></li><li><p>\n            When you issue a <span class=\"hue-doc-codeph\">DROP TABLE</span> statement in Impala, that removes the connection that\n            Impala has with the associated data files, but does not physically remove the underlying data. You can\n            continue to use the data files with other Hadoop components and HDFS operations.\n          </p></li><li><p id=\"check_internal_external_table\">\n        To see whether a table is internal or external, and its associated HDFS location, issue\n        the statement <span class=\"hue-doc-codeph\">DESCRIBE FORMATTED <span class=\"hue-doc-varname\">table_name</span></span>. The\n        <span class=\"hue-doc-codeph\">Table Type</span> field displays <span class=\"hue-doc-codeph\">MANAGED_TABLE</span> for internal\n        tables and <span class=\"hue-doc-codeph\">EXTERNAL_TABLE</span> for external tables. The\n        <span class=\"hue-doc-codeph\">Location</span> field displays the path of the table directory as an HDFS URI.\n      </p></li><li><p>\n            When you issue an <span class=\"hue-doc-codeph\">ALTER TABLE</span> statement to rename an external table, all data files\n            are left in their original locations.\n          </p></li><li><p>\n            You can point multiple external tables at the same HDFS directory by using the same\n            <span class=\"hue-doc-codeph\">LOCATION</span> attribute for each one. The tables could have different column definitions,\n            as long as the number and types of columns are compatible with the schema evolution considerations for\n            the underlying file type. For example, for text data files, one table might define a certain column as\n            a <span class=\"hue-doc-codeph\">STRING</span> while another defines the same column as a <span class=\"hue-doc-codeph\">BIGINT</span>.\n          </p></li></ul><p id=\"example_blurb\"><b>Examples:</b></p><p id=\"switch_internal_external_table\"> You can switch a table from\n        internal to external, or from external to internal, by using the\n          <span class=\"hue-doc-codeph\">ALTER TABLE</span> statement:\n        <div class=\"hue-doc-codeblock\">-- Switch a table from internal to external.\nALTER TABLE <span class=\"hue-doc-varname\">table_name</span> SET TBLPROPERTIES('EXTERNAL'='TRUE');\n\n-- Switch a table from external to internal.\nALTER TABLE <span class=\"hue-doc-varname\">table_name</span> SET TBLPROPERTIES('EXTERNAL'='FALSE');\n</div>If\n        the Kudu service is integrated with the Hive Metastore, the above\n        operations are not supported.</p><p id=\"related_info\"><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_tables.xml\" data-doc-anchor-id=\"internal_tables\">Internal Tables</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_create_table.xml\" data-doc-anchor-id=\"create_table\">CREATE TABLE Statement</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_drop_table.xml\" data-doc-anchor-id=\"drop_table\">DROP TABLE Statement</a>, <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_alter_table.xml\" data-doc-anchor-id=\"alter_table\">ALTER TABLE Statement</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_describe.xml\" data-doc-anchor-id=\"describe\">DESCRIBE Statement</a></p></div></div><div id=\"table_file_formats\"><div class=\"hue-doc-title\">File Formats</div><div><p>\n        Each table has an associated file format, which determines how Impala interprets the\n        associated data files. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_file_formats.xml\" data-doc-anchor-id=\"file_formats\">How Impala Works with Hadoop File Formats</a> for details.\n      </p><p>\n        You set the file format during the <span class=\"hue-doc-codeph\">CREATE TABLE</span> statement,\n        or change it later using the <span class=\"hue-doc-codeph\">ALTER TABLE</span> statement.\n        Partitioned tables can have a different file format for individual partitions,\n        allowing you to change the file format used in your ETL process for new data\n        without going back and reconverting all the existing data in the same table.\n      </p><p>\n        Any <span class=\"hue-doc-codeph\">INSERT</span> statements produce new data files with the current file format of the table.\n        For existing data files, changing the file format of the table does not automatically do any data conversion.\n        You must use <span class=\"hue-doc-codeph\">TRUNCATE TABLE</span> or <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> to remove any previous data\n        files that use the old file format.\n        Then you use the <span class=\"hue-doc-codeph\">LOAD DATA</span> statement, <span class=\"hue-doc-codeph\">INSERT ... SELECT</span>, or other mechanism\n        to put data files of the correct format into the table.\n      </p><p>\n        The default file format, text, is the most flexible and easy to produce when you are just getting started with\n        Impala. The Parquet file format offers the highest query performance and uses compression to reduce storage\n        requirements; therefore, where practical, use Parquet for Impala tables with substantial amounts of data.\n        <span class=\"hue-doc-ph\">Also, the complex types (<span class=\"hue-doc-codeph\">ARRAY</span>, <span class=\"hue-doc-codeph\">STRUCT</span>, and <span class=\"hue-doc-codeph\">MAP</span>)\n        available in Impala 2.3 and higher are currently only supported with the Parquet file type.</span>\n        Based on your existing ETL workflow, you might use other file formats such as Avro, possibly doing a final\n        conversion step to Parquet to take advantage of its performance for analytic queries.\n      </p></div></div><div id=\"kudu_tables\"><div class=\"hue-doc-title\">Kudu Tables</div><div><p> By default, tables stored in Apache Kudu are treated specially,\n        because Kudu manages its data independently of HDFS files. </p><p>All metadata that Impala needs is stored in the HMS.</p><p> When Kudu is not integrated with the HMS, when you create a Kudu table\n        through Impala, the table is assigned an internal Kudu table name of the\n        form\n            <span class=\"hue-doc-codeph\">impala::<span class=\"hue-doc-varname\">db_name</span>.<span class=\"hue-doc-varname\">table_name</span></span>.\n        You can see the Kudu-assigned name in the output of <span class=\"hue-doc-codeph\">DESCRIBE\n          FORMATTED</span>, in the <span class=\"hue-doc-codeph\">kudu.table_name</span> field of\n        the table properties. </p><p> \n        For Impala-Kudu managed tables, <span class=\"hue-doc-codeph\">ALTER TABLE ...\n          RENAME</span> renames both the Impala and the Kudu table. \n      </p><p> \n        For Impala-Kudu external tables, <span class=\"hue-doc-codeph\">ALTER TABLE ...\n          RENAME</span> renames just the Impala table. To change the Kudu\n        table that an Impala external table points to, use <span class=\"hue-doc-codeph\">ALTER TABLE\n            <span class=\"hue-doc-varname\">impala_name</span> SET TBLPROPERTIES('kudu.table_name' =\n            '<span class=\"hue-doc-varname\">different_kudu_table_name</span>')</span>. The\n        underlying Kudu table must already exist. \n      </p><p>\n        In practice, external tables are typically used to access underlying\n        Kudu tables that were created outside of Impala, that is, through the\n        Kudu API.\n      </p><p>\n        The <span class=\"hue-doc-codeph\">SHOW TABLE STATS</span> output for a Kudu table shows\n        Kudu-specific details about the layout of the table. Instead of\n        information about the number and sizes of files, the information is\n        divided by the Kudu tablets. For each tablet, the output includes the\n        fields <span class=\"hue-doc-codeph\"># Rows</span> (although this number is not currently\n        computed), <span class=\"hue-doc-codeph\">Start Key</span>, <span class=\"hue-doc-codeph\">Stop Key</span>,\n          <span class=\"hue-doc-codeph\">Leader Replica</span>, and <span class=\"hue-doc-codeph\"># Replicas</span>. The\n        output of <span class=\"hue-doc-codeph\">SHOW COLUMN STATS</span>, illustrating the\n        distribution of values within each column, is the same for Kudu tables\n        as for HDFS-backed tables.\n      </p><p id=\"kudu_internal_external_tables\"> If the Kudu service is not\n        integrated with the Hive Metastore, the distinction between internal and\n        external tables has some special details for Kudu tables. Tables created\n        entirely through Impala are internal tables. The table name as\n        represented within Kudu includes notation such as an\n          <span class=\"hue-doc-codeph\">impala::</span> prefix and the Impala database name.\n        External Kudu tables are those created by a non-Impala mechanism, such\n        as a user application calling the Kudu APIs. For these tables, the\n          <span class=\"hue-doc-codeph\">CREATE EXTERNAL TABLE</span> syntax lets you establish a\n        mapping from Impala to the existing Kudu table:\n        <div class=\"hue-doc-codeblock\">CREATE EXTERNAL TABLE impala_name STORED AS KUDU\n  TBLPROPERTIES('kudu.table_name' = 'original_kudu_name');\n</div>\n        External Kudu tables differ in one important way from other external\n        tables: adding or dropping a column or range partition changes the data\n        in the underlying Kudu table, in contrast to an HDFS-backed external\n        table where existing data files are left untouched.</p></div></div></div></div>","title":"Overview of Impala Tables"}