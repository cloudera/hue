{"body":"<div><div><div class=\"hue-doc-title\">APPX_COUNT_DISTINCT Query Option (Impala 2.0 or higher only)</div><div><p>\n      Allows multiple <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> operations within a single query, by internally rewriting\n      each <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> to use the <span class=\"hue-doc-codeph\">NDV()</span> function. The resulting count is\n      approximate rather than precise.\n    </p><p><b>Type:</b> Boolean; recognized values are 1 and 0, or <span class=\"hue-doc-codeph\">true</span> and <span class=\"hue-doc-codeph\">false</span>;\n        any other value interpreted as <span class=\"hue-doc-codeph\">false</span></p><p><b>Default:</b><span class=\"hue-doc-codeph\">false</span> (shown as 0 in output of <span class=\"hue-doc-codeph\">SET</span> statement)\n      </p><p><b>Examples:</b></p><p>\n      The following examples show how the <span class=\"hue-doc-codeph\">APPX_COUNT_DISTINCT</span> lets you work around the restriction\n      where a query can only evaluate <span class=\"hue-doc-codeph\">COUNT(DISTINCT <span class=\"hue-doc-varname\">col_name</span>)</span> for a single\n      column. By default, you can count the distinct values of one column or another, but not both in a single\n      query:\n    </p><div class=\"hue-doc-codeblock\">[localhost:21000] &gt; select count(distinct x) from int_t;\n+-------------------+\n| count(distinct x) |\n+-------------------+\n| 10                |\n+-------------------+\n[localhost:21000] &gt; select count(distinct property) from int_t;\n+--------------------------+\n| count(distinct property) |\n+--------------------------+\n| 7                        |\n+--------------------------+\n[localhost:21000] &gt; select count(distinct x), count(distinct property) from int_t;\nERROR: AnalysisException: all DISTINCT aggregate functions need to have the same set of parameters\nas count(DISTINCT x); deviating function: count(DISTINCT property)\n</div><p>\n      When you enable the <span class=\"hue-doc-codeph\">APPX_COUNT_DISTINCT</span> query option, now the query with multiple\n      <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> works. The reason this behavior requires a query option is that each\n      <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> is rewritten internally to use the <span class=\"hue-doc-codeph\">NDV()</span> function instead,\n      which provides an approximate result rather than a precise count.\n    </p><div class=\"hue-doc-codeblock\">[localhost:21000] &gt; set APPX_COUNT_DISTINCT=true;\n[localhost:21000] &gt; select count(distinct x), count(distinct property) from int_t;\n+-------------------+--------------------------+\n| count(distinct x) | count(distinct property) |\n+-------------------+--------------------------+\n| 10                | 7                        |\n+-------------------+--------------------------+\n</div><p><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_count.xml\" data-doc-anchor-id=\"count\">COUNT Function</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_distinct.xml\" data-doc-anchor-id=\"distinct\">DISTINCT Operator</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_ndv.xml\" data-doc-anchor-id=\"ndv\">NDV Function</a></p></div></div></div>","title":"APPX_COUNT_DISTINCT Query Option (Impala 2.0 or higher only)"}