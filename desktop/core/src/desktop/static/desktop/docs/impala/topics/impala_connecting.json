{"body":"<div><div id=\"connecting\"><div class=\"hue-doc-title\">Connecting to Impala Daemon from impala-shell</div><div><p> Within an <span class=\"hue-doc-cmdname\">impala-shell</span> session, you can only issue\n      queries while connected to an instance of the <span class=\"hue-doc-cmdname\">impalad</span>\n      daemon. You can specify the connection information: <ul><li> Through command-line options when you run the\n            <span class=\"hue-doc-cmdname\">impala-shell</span> command. </li><li> Through a configuration file that is read when you run the\n            <span class=\"hue-doc-cmdname\">impala-shell</span> command. </li><li> During an <span class=\"hue-doc-cmdname\">impala-shell</span> session, by issuing a\n            <span class=\"hue-doc-codeph\">CONNECT</span> command. </li></ul><div class=\"hue-doc-note\">You cannot connect to the 3.2 or earlier versions of Impala\n        using the <span class=\"hue-doc-codeph\">'hs2'</span> or <span class=\"hue-doc-codeph\">'hs2-http'</span> protocol\n          (<span class=\"hue-doc-codeph\">--protocol</span> option).</div> See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_shell_options.xml\">impala-shell Configuration Options</a> for the command-line and configuration\n      file options you can use. </p><p> You can connect to any Impala daemon (<span class=\"hue-doc-cmdname\">impalad</span>), and\n      that daemon coordinates the execution of all queries sent to it. </p><p>\n      For simplicity during development, you might always connect to the same host, perhaps running <span class=\"hue-doc-cmdname\">impala-shell</span> on\n      the same host as <span class=\"hue-doc-cmdname\">impalad</span> and specifying the hostname as <span class=\"hue-doc-codeph\">localhost</span>.\n    </p><p> In a production environment, you might enable load balancing, in which\n      you connect to specific host/port combination but queries are forwarded to\n      arbitrary hosts. This technique spreads the overhead of acting as the\n      coordinator node among all the Impala daemons in the cluster. See <a class=\"hue-doc-external-link\" href=\"https://www.cloudera.com/documentation/enterprise/latest/topics/impala_proxy.html\" target=\"_blank\">Using Impala through a Proxy for High Availability</a> for details. </p><p><b>To connect to an Impala during shell startup:</b></p><ol><li> Locate the hostname that is running an instance of the\n          <span class=\"hue-doc-cmdname\">impalad</span> daemon. If that <span class=\"hue-doc-cmdname\">impalad</span>\n        uses a non-default port (something other than port 21000) for\n          <span class=\"hue-doc-cmdname\">impala-shell</span> connections, find out the port number\n        also. </li><li> Use the <span class=\"hue-doc-codeph\">-i</span> option to the\n          <span class=\"hue-doc-cmdname\">impala-shell</span> interpreter to specify the connection\n        information for that instance of <span class=\"hue-doc-cmdname\">impalad</span>:\n        <div class=\"hue-doc-codeblock\"># When you are connecting to an impalad running on the same machine.\n# The prompt will reflect the current hostname.\n$ impala-shell\n\n# When you are connecting to an impalad running on a remote machine, and impalad is listening\n# on a non-default port over the HTTP HiveServer2 protocol.\n$ impala-shell -i <span class=\"hue-doc-varname\">some.other.hostname</span>:<span class=\"hue-doc-varname\">port_number</span> --protocol='hs2-http'\n# When you are connecting to an impalad running on a remote machine, and impalad is listening\n# on a non-default port.\n$ impala-shell -i <span class=\"hue-doc-varname\">some.other.hostname</span>:<span class=\"hue-doc-varname\">port_number</span></div></li></ol><p><b>To connect to an Impala in the<span class=\"hue-doc-cmdname\">impala-shell</span>\n        session:</b></p><ol><li> Start the Impala shell with no connection:\n        <div class=\"hue-doc-codeblock\">$ impala-shell</div></li><li> Locate the hostname that is running the <span class=\"hue-doc-cmdname\">impalad</span>\n        daemon. If that <span class=\"hue-doc-cmdname\">impalad</span> uses a non-default port\n        (something other than port 21000) for <span class=\"hue-doc-cmdname\">impala-shell</span>\n        connections, find out the port number also. </li><li> Use the <span class=\"hue-doc-codeph\">connect</span> command to connect to an Impala\n        instance. Enter a command of the form:\n          <div class=\"hue-doc-codeblock\">[Not connected] &gt; connect <span class=\"hue-doc-varname\">impalad-host</span></div><div class=\"hue-doc-note\">          Replace <span class=\"hue-doc-varname\">impalad-host</span> with the hostname you have\n          configured to run Impala in your environment. The changed prompt\n          indicates a successful connection. </div></li></ol><p><b>To start <span class=\"hue-doc-cmdname\">impala-shell</span> in a specific database:</b></p><p> You can use all the same connection options as in previous examples. For\n      simplicity, these examples assume that you are logged into one of the\n      Impala daemons. </p><ol><li>\n        Find the name of the database containing the relevant tables, views, and so\n        on that you want to operate on.\n      </li><li>\n        Use the <span class=\"hue-doc-codeph\">-d</span> option to the\n        <span class=\"hue-doc-cmdname\">impala-shell</span> interpreter to connect and immediately\n        switch to the specified database, without the need for a <span class=\"hue-doc-codeph\">USE</span>\n        statement or fully qualified names:\n<div class=\"hue-doc-codeblock\"># Subsequent queries with unqualified names operate on\n# tables, views, and so on inside the database named 'staging'.\n$ impala-shell -i localhost -d staging\n\n# It is common during development, ETL, benchmarking, and so on\n# to have different databases containing the same table names\n# but with different contents or layouts.\n$ impala-shell -i localhost -d parquet_snappy_compression\n$ impala-shell -i localhost -d parquet_gzip_compression\n</div></li></ol><p><b>To run one or several statements in non-interactive mode:</b></p><p> You can use all the same connection options as in previous examples. For\n      simplicity, these examples assume that you are logged into one of the\n      Impala daemons. </p><ol><li>\n        Construct a statement, or a file containing a sequence of statements,\n        that you want to run in an automated way, without typing or copying\n        and pasting each time.\n      </li><li>\n        Invoke <span class=\"hue-doc-cmdname\">impala-shell</span> with the <span class=\"hue-doc-codeph\">-q</span> option to run a single statement, or\n        the <span class=\"hue-doc-codeph\">-f</span> option to run a sequence of statements from a file.\n        The <span class=\"hue-doc-cmdname\">impala-shell</span> command returns immediately, without going into\n        the interactive interpreter.\n<div class=\"hue-doc-codeblock\"># A utility command that you might run while developing shell scripts\n# to manipulate HDFS files.\n$ impala-shell -i localhost -d database_of_interest -q 'show tables'\n\n# A sequence of CREATE TABLE, CREATE VIEW, and similar DDL statements\n# can go into a file to make the setup process repeatable.\n$ impala-shell -i localhost -d database_of_interest -f recreate_tables.sql\n</div></li></ol></div></div></div>","title":"Connecting to Impala Daemon from impala-shell"}