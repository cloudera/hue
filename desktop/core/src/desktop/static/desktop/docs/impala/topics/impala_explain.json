{"body":"<div><div id=\"explain\"><div class=\"hue-doc-title\">EXPLAIN Statement</div><div><p> Returns the execution plan for a statement, showing the low-level\n      mechanisms that Impala will use to read the data, divide the work among\n      nodes in the cluster, and transmit intermediate and final results across\n      the network. Use <span class=\"hue-doc-codeph\">explain</span> followed by a complete\n        <span class=\"hue-doc-codeph\">SELECT</span> query. For example: </p><p id=\"syntax_blurb\"><b>Syntax:</b></p><div class=\"hue-doc-codeblock\">EXPLAIN { <span class=\"hue-doc-varname\">select_query</span> | <span class=\"hue-doc-varname\">ctas_stmt</span> | <span class=\"hue-doc-varname\">insert_stmt</span> }\n</div><p>\n      The <span class=\"hue-doc-varname\">select_query</span> is a <span class=\"hue-doc-codeph\">SELECT</span> statement, optionally prefixed by a\n      <span class=\"hue-doc-codeph\">WITH</span> clause. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_select.xml\" data-doc-anchor-id=\"select\">SELECT Statement</a> for details.\n    </p><p>\n      The <span class=\"hue-doc-varname\">insert_stmt</span> is an <span class=\"hue-doc-codeph\">INSERT</span> statement that inserts into or overwrites an\n      existing table. It can use either the <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> or <span class=\"hue-doc-codeph\">INSERT ...\n      VALUES</span> syntax. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"insert\">INSERT Statement</a> for details.\n    </p><p>\n      The <span class=\"hue-doc-varname\">ctas_stmt</span> is a <span class=\"hue-doc-codeph\">CREATE TABLE</span> statement using the <span class=\"hue-doc-codeph\">AS\n      SELECT</span> clause, typically abbreviated as a <q>CTAS</q> operation. See\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_create_table.xml\" data-doc-anchor-id=\"create_table\">CREATE TABLE Statement</a> for details.\n    </p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p>\n      You can interpret the output to judge whether the query is performing efficiently, and adjust the query\n      and/or the schema if not. For example, you might change the tests in the <span class=\"hue-doc-codeph\">WHERE</span> clause, add\n      hints to make join operations more efficient, introduce subqueries, change the order of tables in a join, add\n      or change partitioning for a table, collect column statistics and/or table statistics in Hive, or any other\n      performance tuning steps.\n    </p><p>\n      The <span class=\"hue-doc-codeph\">EXPLAIN</span> output reminds you if table or column statistics are missing from any table\n      involved in the query. These statistics are important for optimizing queries involving large tables or\n      multi-table joins. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_compute_stats.xml\" data-doc-anchor-id=\"compute_stats\">COMPUTE STATS Statement</a> for how to gather statistics,\n      and <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_perf_stats.xml\" data-doc-anchor-id=\"perf_stats\">Table and Column Statistics</a> for how to use this information for query tuning.\n    </p><p id=\"explain_interpret\">\n        Read the <span class=\"hue-doc-codeph\">EXPLAIN</span> plan from bottom to top:\n        <ul><li>\n            The last part of the plan shows the low-level details such as the expected amount of\n            data that will be read, where you can judge the effectiveness of your partitioning\n            strategy and estimate how long it will take to scan a table based on total data size\n            and the size of the cluster.\n          </li><li>\n            As you work your way up, next you see the operations that will be parallelized and\n            performed on each Impala node.\n          </li><li>\n            At the higher levels, you see how data flows when intermediate result sets are\n            combined and transmitted from one node to another.\n          </li><li>\n            See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_explain_level.xml\" data-doc-anchor-id=\"explain_level\">EXPLAIN_LEVEL Query Option</a> for details\n            about the <span class=\"hue-doc-codeph\">EXPLAIN_LEVEL</span> query option, which lets you customize how\n            much detail to show in the <span class=\"hue-doc-codeph\">EXPLAIN</span> plan depending on whether you\n            are doing high-level or low-level tuning, dealing with logical or physical aspects\n            of the query.\n          </li></ul></p><p>\n      If you come from a traditional database background and are not familiar with data warehousing, keep in mind\n      that Impala is optimized for full table scans across very large tables. The structure and distribution of\n      this data is typically not suitable for the kind of indexing and single-row lookups that are common in OLTP\n      environments. Seeing a query scan entirely through a large table is common, not necessarily an indication of\n      an inefficient query. Of course, if you can reduce the volume of scanned data by orders of magnitude, for\n      example by using a query that affects only certain partitions within a partitioned table, then you might be\n      able to optimize a query so that it executes in seconds rather than minutes.\n    </p><p> The <span class=\"hue-doc-codeph\">EXPLAIN</span> output becomes more accurate and informative\n      as statistics are gathered by the <span class=\"hue-doc-codeph\">COMPUTE STATS</span>\n      statement. Initially, the information about data size and distribution,\n      such as the number of rows or number of distinct values for each column,\n      is marked \"<span class=\"hue-doc-codeph\">unavailable</span>\". The <span class=\"hue-doc-codeph\">COMPUTE\n        STATS</span> statement performs the analysis, so a subsequent\n        <span class=\"hue-doc-codeph\">EXPLAIN</span> statement has additional information to use in\n      deciding how to optimize the distributed query. </p><p>\n      For more information and examples to help you interpret <span class=\"hue-doc-codeph\">EXPLAIN</span> output, see\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_explain_plan.xml\" data-doc-anchor-id=\"perf_explain\">Using the EXPLAIN Plan for Performance Tuning</a>.\n    </p><p><b>Extended EXPLAIN output:</b></p><p> For performance tuning of complex queries, and capacity\n      planning (such as using the admission control and resource management\n      features), you can enable more detailed and informative output for the\n        <span class=\"hue-doc-codeph\">EXPLAIN</span> statement. In the\n        <span class=\"hue-doc-cmdname\">impala-shell</span> interpreter, issue the command\n        <span class=\"hue-doc-codeph\">SET EXPLAIN_LEVEL=<span class=\"hue-doc-varname\">level</span></span>, where\n        <span class=\"hue-doc-varname\">level</span> is <span class=\"hue-doc-codeph\">MINIMAL</span>,\n        <span class=\"hue-doc-codeph\">STANDARD</span>, <span class=\"hue-doc-codeph\">EXTENDED</span>, or\n        <span class=\"hue-doc-codeph\">VERBOSE</span>. </p><p> When extended <span class=\"hue-doc-codeph\">EXPLAIN</span> output is enabled,\n        <span class=\"hue-doc-codeph\">EXPLAIN</span> statements print information about estimated\n      memory requirements, minimum number of virtual cores, and so on. </p><p>Starting in Impala 3.2, if the\n        <span class=\"hue-doc-codeph\">EXPLAIN_LEVEL</span> option is set to\n        <span class=\"hue-doc-codeph\">EXTENDED</span> level or <span class=\"hue-doc-codeph\">VERBOSE</span>, the output\n      contains the following additional information.</p><ul><li>The analyzed query, in the output header. <p>The analyzed query may\n          have been rewritten to include various optimizations and implicit\n          casts. See the example below.</p></li><li>The predicates in the plan output includes the same implicit casts and\n        literals printed with a cast to show the type.</li></ul><p>\n      See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_explain_level.xml\" data-doc-anchor-id=\"explain_level\">EXPLAIN_LEVEL Query Option</a> for details and examples.\n    </p><p id=\"example_blurb\"><b>Examples:</b></p><p> This example shows how the standard <span class=\"hue-doc-codeph\">EXPLAIN</span> output\n      moves from the lowest (physical) level to the higher (logical) levels. </p><ol><li>The query begins by scanning a certain amount of data; each node\n        performs an aggregation operation (evaluating <span class=\"hue-doc-codeph\">COUNT(*)</span>)\n        on some subset of data that is local to that node.</li><li>The intermediate results are transmitted back to the coordinator node\n        (labelled here as the <span class=\"hue-doc-codeph\">EXCHANGE</span> node).</li><li>Lastly, the intermediate results are summed to display the final\n        result. </li></ol><div class=\"hue-doc-codeblock\" id=\"explain_plan_simple\">[impalad-host:21000] &gt; EXPLAIN SELECT COUNT(*) FROM customer_address;\n+----------------------------------------------------------+\n| Explain String                                           |\n+----------------------------------------------------------+\n| ...                                                      |\n|                                                          |\n| 03:AGGREGATE [FINALIZE]                                  |\n| |  output: sum(count(*))                                 |\n| |                                                        |\n| 02:EXCHANGE [UNPARTITIONED]                              |\n| |                                                        |\n| 01:AGGREGATE                                             |\n| |  output: count(*)                                      |\n| |                                                        |\n| 00:SCAN HDFS [default.customer_address]                  |\n|    partitions=1/1 size=5.25MB                            |\n+----------------------------------------------------------+\n</div><p>The following example shows an extended <span class=\"hue-doc-codeph\">EXPLAIN</span> output.\n      Note that the analyzed query was rewritten to include:</p><ul><li>The 'constant folding' optimization, which simplified the expression\n        in the original query, '<span class=\"hue-doc-codeph\">1000 / 100</span>' to\n          '<span class=\"hue-doc-codeph\">10</span>'.</li><li>The implicit casts in the <span class=\"hue-doc-codeph\">WHERE</span> clause.</li></ul><div class=\"hue-doc-codeblock\">EXPLAIN SELECT * FROM functional_kudu.alltypestiny WHERE bigint_col &lt; 1000 / 100;\n+----------------------------------------------------------+\n| Explain String                                           |\n+----------------------------------------------------------+\n| ...\n| Analyzed query: SELECT * FROM mytable WHERE CAST(bigint_col AS DOUBLE) &lt; CAST(10 AS DOUBLE)\n| ...\n| 00:SCAN KUDU [functional_kudu.alltypestiny]\n| predicates: CAST(bigint_col AS DOUBLE) &lt; CAST(10 AS DOUBLE)\n...</div><p id=\"security_blurb\"><b>Security considerations:</b></p><p id=\"redaction_yes\">\n        If these statements in your environment contain sensitive literal values such as credit\n        card numbers or tax identifiers, Impala can redact this sensitive information when\n        displaying the statements in log files and other administrative contexts. See\n        \n    the documentation for your Apache Hadoop distribution\n   for details.\n      </p><p id=\"cancel_blurb_no\"><b>Cancellation:</b> Cannot be cancelled.\n      </p><p id=\"permissions_blurb\"><b>HDFS permissions:</b></p><p>\n      The user ID that the <span class=\"hue-doc-cmdname\">impalad</span> daemon runs under,\n      typically the <span class=\"hue-doc-codeph\">impala</span> user, must have read\n      and execute permissions for all applicable directories in all source tables\n      for the query that is being explained.\n      (A <span class=\"hue-doc-codeph\">SELECT</span> operation could read files from multiple different HDFS directories\n      if the source table is partitioned.)\n    </p><p id=\"kudu_blurb\"><b>Kudu considerations:</b></p><p>\n      The <span class=\"hue-doc-codeph\">EXPLAIN</span> statement displays equivalent plan\n      information for queries against Kudu tables as for queries\n      against HDFS-based tables.\n    </p><p>\n      To see which predicates Impala can <q>push down</q> to Kudu for\n      efficient evaluation, without transmitting unnecessary rows back\n      to Impala, look for the <span class=\"hue-doc-codeph\">kudu predicates</span> item in\n      the scan phase of the query. The label <span class=\"hue-doc-codeph\">kudu predicates</span>\n      indicates a condition that can be evaluated efficiently on the Kudu\n      side. The label <span class=\"hue-doc-codeph\">predicates</span> in a <span class=\"hue-doc-codeph\">SCAN KUDU</span>\n      node indicates a condition that is evaluated by Impala.\n      For example, in a table with primary key column <span class=\"hue-doc-codeph\">X</span>\n      and non-primary key column <span class=\"hue-doc-codeph\">Y</span>, you can see that\n      some operators in the <span class=\"hue-doc-codeph\">WHERE</span> clause are evaluated\n      immediately by Kudu and others are evaluated later by Impala:\n    </p><div class=\"hue-doc-codeblock\">EXPLAIN SELECT x,y from kudu_table WHERE\n  x = 1 AND y NOT IN (2,3) AND z = 1\n  AND a IS NOT NULL AND b &gt; 0 AND length(s) &gt; 5;\n+----------------\n| Explain String\n+----------------\n...\n| 00:SCAN KUDU [kudu_table]\n|    predicates: y NOT IN (2, 3), length(s) &gt; 5\n|    kudu predicates: a IS NOT NULL, b &gt; 0, x = 1, z = 1\n</div><p>\n      Only binary predicates, <span class=\"hue-doc-codeph\">IS NULL</span> and <span class=\"hue-doc-codeph\">IS NOT NULL</span>\n      (in Impala 2.9 and higher), and <span class=\"hue-doc-codeph\">IN</span> predicates\n      containing literal values that exactly match the types in the Kudu table, and do not\n      require any casting, can be pushed to Kudu.\n    </p><p id=\"related_info\"><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_select.xml\" data-doc-anchor-id=\"select\">SELECT Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"insert\">INSERT Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_create_table.xml\" data-doc-anchor-id=\"create_table\">CREATE TABLE Statement</a>,\n      <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_explain_plan.xml\" data-doc-anchor-id=\"explain_plan\">Understanding Impala Query Performance - EXPLAIN Plans and Query Profiles</a></p></div></div></div>","title":"EXPLAIN Statement"}