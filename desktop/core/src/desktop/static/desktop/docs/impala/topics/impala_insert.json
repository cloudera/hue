{"body":"<div><div id=\"insert\"><div class=\"hue-doc-title\">INSERT Statement</div><div><p>\n      Impala supports inserting into tables and partitions that you create with the Impala <span class=\"hue-doc-codeph\">CREATE\n      TABLE</span> statement, or pre-defined tables and partitions created through Hive.\n    </p><p id=\"syntax_blurb\"><b>Syntax:</b></p><div class=\"hue-doc-codeblock\">[<span class=\"hue-doc-varname\">with_clause</span>]\n  INSERT <span class=\"hue-doc-ph\">[<span class=\"hue-doc-varname\">hint_clause</span>]</span> { INTO | OVERWRITE } [TABLE] <span class=\"hue-doc-varname\">table_name</span>\n  [(<span class=\"hue-doc-varname\">column_list</span>)]\n  [ PARTITION (<span class=\"hue-doc-varname\">partition_clause</span>)]\n{\n    [<span class=\"hue-doc-varname\">hint_clause</span>] <span class=\"hue-doc-varname\">select_statement</span>\n  | VALUES (<span class=\"hue-doc-varname\">value</span> [, <span class=\"hue-doc-varname\">value</span> ...]) [, (<span class=\"hue-doc-varname\">value</span> [, <span class=\"hue-doc-varname\">value</span> ...]) ...]\n}\n\npartition_clause ::= <span class=\"hue-doc-varname\">col_name</span> [= <span class=\"hue-doc-varname\">constant</span>] [, <span class=\"hue-doc-varname\">col_name</span> [= <span class=\"hue-doc-varname\">constant</span>] ...]\n\nhint_clause ::=\n  <span class=\"hue-doc-varname\">hint_with_dashes</span> |\n  <span class=\"hue-doc-varname\">hint_with_cstyle_delimiters</span> |\n  <span class=\"hue-doc-varname\">hint_with_brackets</span>\n\nhint_with_dashes ::= -- +SHUFFLE | -- +NOSHUFFLE <span class=\"hue-doc-ph\">-- +CLUSTERED</span>\n\nhint_with_cstyle_comments ::= /* +SHUFFLE */ | /* +NOSHUFFLE */ <span class=\"hue-doc-ph\">| /* +CLUSTERED */</span>\n\nhint_with_brackets ::= [SHUFFLE] | [NOSHUFFLE]\n  (With this hint format, the square brackets are part of the syntax.)\n</div><div class=\"hue-doc-note\" id=\"square_bracket_hint_caveat\">        The square bracket style of hint is now deprecated and might be removed in a future\n        release. For that reason, any newly added hints are not available with the square\n        bracket syntax.\n      </div><p><b>Appending or replacing (INTO and OVERWRITE clauses):</b></p><p>\n      The <span class=\"hue-doc-codeph\">INSERT INTO</span> syntax appends data to a table. The existing data files are left as-is, and\n      the inserted data is put into one or more new data files.\n    </p><p>\n      The <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> syntax replaces the data in a table.\n\n      Currently, the overwritten data files are deleted immediately; they do not go through the HDFS trash\n      mechanism.\n    </p><p id=\"complex_types_blurb\"><b>Complex type considerations:</b></p><p>\n      The <span class=\"hue-doc-codeph\">INSERT</span> statement currently does not support writing data files\n      containing complex types (<span class=\"hue-doc-codeph\">ARRAY</span>, <span class=\"hue-doc-codeph\">STRUCT</span>, and <span class=\"hue-doc-codeph\">MAP</span>).\n      To prepare Parquet data for such tables, you generate the data files outside Impala and then\n      use <span class=\"hue-doc-codeph\">LOAD DATA</span> or <span class=\"hue-doc-codeph\">CREATE EXTERNAL TABLE</span> to associate those\n      data files with the table. Currently, such tables must use the Parquet file format.\n      See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_complex_types.xml\" data-doc-anchor-id=\"complex_types\">Complex Types (Impala 2.3 or higher only)</a> for details about working with complex types.\n    </p><p id=\"kudu_blurb\"><b>Kudu considerations:</b></p><p id=\"kudu_no_insert_overwrite\">\n        Currently, the <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> syntax cannot be used with Kudu tables.\n      </p><p>\n      Kudu tables require a unique primary key for each row. If an <span class=\"hue-doc-codeph\">INSERT</span>\n      statement attempts to insert a row with the same values for the primary key columns\n      as an existing row, that row is discarded and the insert operation continues.\n      When rows are discarded due to duplicate primary keys, the statement finishes\n      with a warning, not an error. (This is a change from early releases of Kudu\n      where the default was to return in error in such cases, and the syntax\n      <span class=\"hue-doc-codeph\">INSERT IGNORE</span> was required to make the statement succeed.\n      The <span class=\"hue-doc-codeph\">IGNORE</span> clause is no longer part of the <span class=\"hue-doc-codeph\">INSERT</span>\n      syntax.)\n    </p><p>\n      For situations where you prefer to replace rows with duplicate primary key values,\n      rather than discarding the new data, you can use the <span class=\"hue-doc-codeph\">UPSERT</span>\n      statement instead of <span class=\"hue-doc-codeph\">INSERT</span>. <span class=\"hue-doc-codeph\">UPSERT</span> inserts\n      rows that are entirely new, and for rows that match an existing primary key in the\n      table, the non-primary-key columns are updated to reflect the values in the\n      <q>upserted</q> data.\n    </p><p>\n      If you really want to store new rows, not replace existing ones, but cannot do so\n      because of the primary key uniqueness constraint, consider recreating the table\n      with additional columns included in the primary key.\n    </p><p>\n      See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_kudu.xml\" data-doc-anchor-id=\"impala_kudu\">Using Impala to Query Kudu Tables</a> for more details about using Impala with Kudu.\n    </p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p>\n      Impala currently supports:\n    </p><ul><li>\n        Copy data from another table using <span class=\"hue-doc-codeph\">SELECT</span> query. In Impala 1.2.1 and higher, you can\n        combine <span class=\"hue-doc-codeph\">CREATE TABLE</span> and <span class=\"hue-doc-codeph\">INSERT</span> operations into a single step with the\n        <span class=\"hue-doc-codeph\">CREATE TABLE AS SELECT</span> syntax, which bypasses the actual <span class=\"hue-doc-codeph\">INSERT</span> keyword.\n      </li><li>\n        An optional <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_with.xml\" data-doc-anchor-id=\"with\"><span class=\"hue-doc-codeph\">WITH</span> clause</a> before the\n        <span class=\"hue-doc-codeph\">INSERT</span> keyword, to define a subquery referenced in the <span class=\"hue-doc-codeph\">SELECT</span> portion.\n      </li><li>\n        Create one or more new rows using constant expressions through <span class=\"hue-doc-codeph\">VALUES</span> clause. (The\n        <span class=\"hue-doc-codeph\">VALUES</span> clause was added in Impala 1.0.1.)\n      </li><li><p>\n          By default, the first column of each newly inserted row goes into the first column of the table, the\n          second column into the second column, and so on.\n        </p><p>\n          You can also specify the columns to be inserted, an arbitrarily ordered subset of the columns in the\n          destination table, by specifying a column list immediately after the name of the destination table. This\n          feature lets you adjust the inserted columns to match the layout of a <span class=\"hue-doc-codeph\">SELECT</span> statement,\n          rather than the other way around. (This feature was added in Impala 1.1.)\n        </p><p>\n          The number of columns mentioned in the column list (known as the <q>column permutation</q>) must match\n          the number of columns in the <span class=\"hue-doc-codeph\">SELECT</span> list or the <span class=\"hue-doc-codeph\">VALUES</span> tuples. The\n          order of columns in the column permutation can be different than in the underlying table, and the columns\n          of each input row are reordered to match. If the number of columns in the column permutation is less than\n          in the destination table, all unmentioned columns are set to <span class=\"hue-doc-codeph\">NULL</span>.\n        </p></li><li>\n        An optional hint clause immediately either before the <span class=\"hue-doc-codeph\">SELECT</span> keyword or after the\n        <span class=\"hue-doc-codeph\">INSERT</span> keyword, to fine-tune the behavior when doing an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span>\n        operation into partitioned Parquet tables. The hint clause cannot be specified in multiple places.\n        The hint keywords are <span class=\"hue-doc-codeph\">[SHUFFLE]</span> and <span class=\"hue-doc-codeph\">[NOSHUFFLE]</span>, including the square brackets.\n        Inserting into partitioned Parquet tables can be a resource-intensive operation because it potentially\n        involves many files being written to HDFS simultaneously, and separate\n        <span class=\"hue-doc-ph\">large</span> memory buffers being allocated to buffer the data for each\n        partition. For usage details, see <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_parquet.xml\" data-doc-anchor-id=\"parquet_etl\">Loading Data into Parquet Tables</a>.\n      </li></ul><div class=\"hue-doc-note\"><ul><li>\n          Insert commands that partition or add files result in changes to Hive metadata. Because Impala uses Hive\n          metadata, such changes may necessitate a metadata refresh. For more information, see the\n          <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_refresh.xml\" data-doc-anchor-id=\"refresh\">REFRESH</a> function.\n        </li><li>\n          Currently, Impala can only insert data into tables that use the text and Parquet formats. For other file\n          formats, insert the data using Hive and use Impala to query it.\n        </li><li>\n          As an alternative to the <span class=\"hue-doc-codeph\">INSERT</span> statement, if you have existing data files elsewhere in\n          HDFS, the <span class=\"hue-doc-codeph\">LOAD DATA</span> statement can move those files into a table. This statement works\n          with tables of any file format.\n        </li></ul></div><p id=\"dml_blurb\"><b>Statement type:</b> DML (but still affected by\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_sync_ddl.xml\" data-doc-anchor-id=\"sync_ddl\">SYNC_DDL</a> query option)\n      </p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p>\n      When you insert the results of an expression, particularly of a built-in function call, into a small numeric\n      column such as <span class=\"hue-doc-codeph\">INT</span>, <span class=\"hue-doc-codeph\">SMALLINT</span>, <span class=\"hue-doc-codeph\">TINYINT</span>, or\n      <span class=\"hue-doc-codeph\">FLOAT</span>, you might need to use a <span class=\"hue-doc-codeph\">CAST()</span> expression to coerce values into the\n      appropriate type. Impala does not automatically convert from a larger type to a smaller one. For example, to\n      insert cosine values into a <span class=\"hue-doc-codeph\">FLOAT</span> column, write <span class=\"hue-doc-codeph\">CAST(COS(angle) AS FLOAT)</span>\n      in the <span class=\"hue-doc-codeph\">INSERT</span> statement to make the conversion explicit.\n    </p><p id=\"file_format_blurb\"><b>File format considerations:</b></p><p>\n      Because Impala can read certain file formats that it cannot write,\n      the <span class=\"hue-doc-codeph\">INSERT</span> statement does not work for all kinds of\n      Impala tables. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_file_formats.xml\" data-doc-anchor-id=\"file_formats\">How Impala Works with Hadoop File Formats</a>\n      for details about what file formats are supported by the\n      <span class=\"hue-doc-codeph\">INSERT</span> statement.\n    </p><p id=\"insert_parquet_blocksize\">\n        Any <span class=\"hue-doc-codeph\">INSERT</span> statement for a Parquet table requires enough free space in\n        the HDFS filesystem to write one block. Because Parquet data files use a block size of 1\n        GB by default, an <span class=\"hue-doc-codeph\">INSERT</span> might fail (even for a very small amount of\n        data) if your HDFS is running low on space.\n      </p><p id=\"sync_ddl_blurb\">\n        If you connect to different Impala nodes within an <span class=\"hue-doc-cmdname\">impala-shell</span>\n        session for load-balancing purposes, you can enable the <span class=\"hue-doc-codeph\">SYNC_DDL</span> query\n        option to make each DDL statement wait before returning, until the new or changed\n        metadata has been received by all the Impala nodes. See\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_sync_ddl.xml\" data-doc-anchor-id=\"sync_ddl\">SYNC_DDL Query Option</a> for details.\n      </p><div class=\"hue-doc-note\" id=\"compute_stats_next\">        After adding or replacing data in a table used in performance-critical queries, issue a\n        <span class=\"hue-doc-codeph\">COMPUTE STATS</span> statement to make sure all statistics are up-to-date.\n        Consider updating statistics for a table after any <span class=\"hue-doc-codeph\">INSERT</span>, <span class=\"hue-doc-codeph\">LOAD\n        DATA</span>, or <span class=\"hue-doc-codeph\">CREATE TABLE AS SELECT</span> statement in Impala, or after\n        loading data through Hive and doing a <span class=\"hue-doc-codeph\">REFRESH\n        <span class=\"hue-doc-varname\">table_name</span></span> in Impala. This technique is especially important\n        for tables that are very large, used in join queries, or both.\n      </div><p id=\"example_blurb\"><b>Examples:</b></p><p>\n      The following example sets up new tables with the same definition as the <span class=\"hue-doc-codeph\">TAB1</span> table from the\n      <a class=\"hue-doc-external-link\" href=\"https://www.cloudera.com/documentation/enterprise/latest/topics/impala_tutorial.html#tutorial\" target=\"_blank\">Tutorial</a> section, using different file\n      formats, and demonstrates inserting data into the tables created with the <span class=\"hue-doc-codeph\">STORED AS TEXTFILE</span>\n      and <span class=\"hue-doc-codeph\">STORED AS PARQUET</span> clauses:\n    </p><div class=\"hue-doc-codeblock\">CREATE DATABASE IF NOT EXISTS file_formats;\nUSE file_formats;\n\nDROP TABLE IF EXISTS text_table;\nCREATE TABLE text_table\n( id INT, col_1 BOOLEAN, col_2 DOUBLE, col_3 TIMESTAMP )\nSTORED AS TEXTFILE;\n\nDROP TABLE IF EXISTS parquet_table;\nCREATE TABLE parquet_table\n( id INT, col_1 BOOLEAN, col_2 DOUBLE, col_3 TIMESTAMP )\nSTORED AS PARQUET;</div><p>\n      With the <span class=\"hue-doc-codeph\">INSERT INTO TABLE</span> syntax, each new set of inserted rows is appended to any existing\n      data in the table. This is how you would record small amounts of data that arrive continuously, or ingest new\n      batches of data alongside the existing data. For example, after running 2 <span class=\"hue-doc-codeph\">INSERT INTO TABLE</span>\n      statements with 5 rows each, the table contains 10 rows total:\n    </p><div class=\"hue-doc-codeblock\">[localhost:21000] &gt; insert into table text_table select * from default.tab1;\nInserted 5 rows in 0.41s\n\n[localhost:21000] &gt; insert into table text_table select * from default.tab1;\nInserted 5 rows in 0.46s\n\n[localhost:21000] &gt; select count(*) from text_table;\n+----------+\n| count(*) |\n+----------+\n| 10       |\n+----------+\nReturned 1 row(s) in 0.26s</div><p>\n      With the <span class=\"hue-doc-codeph\">INSERT OVERWRITE TABLE</span> syntax, each new set of inserted rows replaces any existing\n      data in the table. This is how you load data to query in a data warehousing scenario where you analyze just\n      the data for a particular day, quarter, and so on, discarding the previous data each time. You might keep the\n      entire set of data in one raw table, and transfer and transform certain rows into a more compact and\n      efficient form to perform intensive analysis on that subset.\n    </p><p>\n      For example, here we insert 5 rows into a table using the <span class=\"hue-doc-codeph\">INSERT INTO</span> clause, then replace\n      the data by inserting 3 rows with the <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> clause. Afterward, the table only\n      contains the 3 rows from the final <span class=\"hue-doc-codeph\">INSERT</span> statement.\n    </p><div class=\"hue-doc-codeblock\">[localhost:21000] &gt; insert into table parquet_table select * from default.tab1;\nInserted 5 rows in 0.35s\n\n[localhost:21000] &gt; insert overwrite table parquet_table select * from default.tab1 limit 3;\nInserted 3 rows in 0.43s\n[localhost:21000] &gt; select count(*) from parquet_table;\n+----------+\n| count(*) |\n+----------+\n| 3        |\n+----------+\nReturned 1 row(s) in 0.43s</div><p>\n      The <span class=\"hue-doc-codeph\"><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"values\">VALUES</a></span> clause lets you insert one or more\n      rows by specifying constant values for all the columns. The number, types, and order of the expressions must\n      match the table definition.\n    </p><div class=\"hue-doc-note\" id=\"insert_values_warning\">      The <span class=\"hue-doc-codeph\">INSERT ... VALUES</span> technique is not suitable for loading large quantities of data into\n      HDFS-based tables, because the insert operations cannot be parallelized, and each one produces a separate\n      data file. Use it for setting up small dimension tables or tiny amounts of data for experimenting with SQL\n      syntax, or with HBase tables. Do not use it for large ETL jobs or benchmark tests for load operations. Do not\n      run scripts with thousands of <span class=\"hue-doc-codeph\">INSERT ... VALUES</span> statements that insert a single row each\n      time. If you do run <span class=\"hue-doc-codeph\">INSERT ... VALUES</span> operations to load data into a staging table as one\n      stage in an ETL pipeline, include multiple row values if possible within each <span class=\"hue-doc-codeph\">VALUES</span> clause,\n      and use a separate database to make cleanup easier if the operation does produce many tiny files.\n    </div><p>\n      The following example shows how to insert one row or multiple rows, with expressions of different types,\n      using literal values, expressions, and function return values:\n    </p><div class=\"hue-doc-codeblock\">create table val_test_1 (c1 int, c2 float, c3 string, c4 boolean, c5 timestamp);\ninsert into val_test_1 values (100, 99.9/10, 'abc', true, now());\ncreate table val_test_2 (id int, token string);\ninsert overwrite val_test_2 values (1, 'a'), (2, 'b'), (-1,'xyzzy');</div><p>\n      These examples show the type of <q>not implemented</q> error that you see when attempting to insert data into\n      a table with a file format that Impala currently does not write to:\n    </p><div class=\"hue-doc-codeblock\">DROP TABLE IF EXISTS sequence_table;\nCREATE TABLE sequence_table\n( id INT, col_1 BOOLEAN, col_2 DOUBLE, col_3 TIMESTAMP )\nSTORED AS SEQUENCEFILE;\n\nDROP TABLE IF EXISTS rc_table;\nCREATE TABLE rc_table\n( id INT, col_1 BOOLEAN, col_2 DOUBLE, col_3 TIMESTAMP )\nSTORED AS RCFILE;\n\n[localhost:21000] &gt; insert into table rc_table select * from default.tab1;\nRemote error\nBackend 0:RC_FILE not implemented.\n\n[localhost:21000] &gt; insert into table sequence_table select * from default.tab1;\nRemote error\nBackend 0:SEQUENCE_FILE not implemented. </div><p>\n      The following examples show how you can copy the data in all the columns from one table to another, copy the\n      data from only some columns, or specify the columns in the select list in a different order than they\n      actually appear in the table:\n    </p><div class=\"hue-doc-codeblock\">-- Start with 2 identical tables.\ncreate table t1 (c1 int, c2 int);\ncreate table t2 like t1;\n\n-- If there is no () part after the destination table name,\n-- all columns must be specified, either as * or by name.\ninsert into t2 select * from t1;\ninsert into t2 select c1, c2 from t1;\n\n-- With the () notation following the destination table name,\n-- you can omit columns (all values for that column are NULL\n-- in the destination table), and/or reorder the values\n-- selected from the source table. This is the \"column permutation\" feature.\ninsert into t2 (c1) select c1 from t1;\ninsert into t2 (c2, c1) select c1, c2 from t1;\n\n-- The column names can be entirely different in the source and destination tables.\n-- You can copy any columns, not just the corresponding ones, from the source table.\n-- But the number and type of selected columns must match the columns mentioned in the () part.\nalter table t2 replace columns (x int, y int);\ninsert into t2 (y) select c1 from t1;\n</div><p id=\"insert_sort_blurb\"><b>Sorting considerations:</b> Although you can specify an <span class=\"hue-doc-codeph\">ORDER BY</span>\n        clause in an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> statement, any <span class=\"hue-doc-codeph\">ORDER BY</span>\n        clause is ignored and the results are not necessarily sorted. An <span class=\"hue-doc-codeph\">INSERT ...\n        SELECT</span> operation potentially creates many different data files, prepared by\n        different executor Impala daemons, and therefore the notion of the data being stored in\n        sorted order is impractical.\n      </p><p><b>Concurrency considerations:</b> Each <span class=\"hue-doc-codeph\">INSERT</span> operation creates new data files with unique\n      names, so you can run multiple <span class=\"hue-doc-codeph\">INSERT INTO</span> statements simultaneously without filename\n      conflicts.\n\n      While data is being inserted into an Impala table, the data is staged temporarily in a subdirectory inside\n      the data directory; during this period, you cannot issue queries against that table in Hive. If an\n      <span class=\"hue-doc-codeph\">INSERT</span> operation fails, the temporary data file and the subdirectory could be left behind in\n      the data directory. If so, remove the relevant subdirectory and any data files it contains manually, by\n      issuing an <span class=\"hue-doc-codeph\">hdfs dfs -rm -r</span> command, specifying the full path of the work subdirectory, whose\n      name ends in <span class=\"hue-doc-codeph\">_dir</span>.\n    </p></div><div id=\"values\"><div class=\"hue-doc-title\">VALUES Clause</div><div><p>\n        The <span class=\"hue-doc-codeph\">VALUES</span> clause is a general-purpose way to specify the columns of one or more rows,\n        typically within an <span class=\"hue-doc-codeph\"><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_insert.xml\" data-doc-anchor-id=\"insert\">INSERT</a></span> statement.\n      </p><div class=\"hue-doc-note\" id=\"insert_values_warning\">        The <span class=\"hue-doc-codeph\">INSERT ... VALUES</span> technique is not suitable for loading large\n        quantities of data into HDFS-based tables, because the insert operations cannot be\n        parallelized, and each one produces a separate data file. Use it for setting up small\n        dimension tables or tiny amounts of data for experimenting with SQL syntax, or with\n        HBase tables. Do not use it for large ETL jobs or benchmark tests for load operations.\n        Do not run scripts with thousands of <span class=\"hue-doc-codeph\">INSERT ... VALUES</span> statements that\n        insert a single row each time. If you do run <span class=\"hue-doc-codeph\">INSERT ... VALUES</span>\n        operations to load data into a staging table as one stage in an ETL pipeline, include\n        multiple row values if possible within each <span class=\"hue-doc-codeph\">VALUES</span> clause, and use a\n        separate database to make cleanup easier if the operation does produce many tiny files.\n      </div><p>\n        The following examples illustrate:\n      </p><ul><li>\n          How to insert a single row using a <span class=\"hue-doc-codeph\">VALUES</span> clause.\n        </li><li>\n          How to insert multiple rows using a <span class=\"hue-doc-codeph\">VALUES</span> clause.\n        </li><li>\n          How the row or rows from a <span class=\"hue-doc-codeph\">VALUES</span> clause can be appended to a table through\n          <span class=\"hue-doc-codeph\">INSERT INTO</span>, or replace the contents of the table through <span class=\"hue-doc-codeph\">INSERT\n          OVERWRITE</span>.\n        </li><li>\n          How the entries in a <span class=\"hue-doc-codeph\">VALUES</span> clause can be literals, function results, or any other kind\n          of expression. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_literals.xml\" data-doc-anchor-id=\"literals\">Literals</a> for the notation to use for literal\n          values, especially <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_literals.xml\" data-doc-anchor-id=\"string_literals\">String Literals</a> for quoting and escaping\n          conventions for strings. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_operators.xml\" data-doc-anchor-id=\"operators\">SQL Operators</a> and\n          <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_functions.xml\" data-doc-anchor-id=\"builtins\">Impala Built-In Functions</a> for other things you can include in expressions with the\n          <span class=\"hue-doc-codeph\">VALUES</span> clause.\n        </li></ul><div class=\"hue-doc-codeblock\">[localhost:21000] &gt; describe val_example;\nQuery: describe val_example\nQuery finished, fetching results ...\n+-------+---------+---------+\n| name  | type    | comment |\n+-------+---------+---------+\n| id    | int     |         |\n| col_1 | boolean |         |\n| col_2 | double  |         |\n+-------+---------+---------+\n\n[localhost:21000] &gt; insert into val_example values (1,true,100.0);\nInserted 1 rows in 0.30s\n[localhost:21000] &gt; select * from val_example;\n+----+-------+-------+\n| id | col_1 | col_2 |\n+----+-------+-------+\n| 1  | true  | 100   |\n+----+-------+-------+\n\n[localhost:21000] &gt; insert overwrite val_example values (10,false,pow(2,5)), (50,true,10/3);\nInserted 2 rows in 0.16s\n[localhost:21000] &gt; select * from val_example;\n+----+-------+-------------------+\n| id | col_1 | col_2             |\n+----+-------+-------------------+\n| 10 | false | 32                |\n| 50 | true  | 3.333333333333333 |\n+----+-------+-------------------+</div><p>\n        When used in an <span class=\"hue-doc-codeph\">INSERT</span> statement, the Impala <span class=\"hue-doc-codeph\">VALUES</span> clause can specify\n        some or all of the columns in the destination table, and the columns can be specified in a different order\n        than they actually appear in the table. To specify a different set or order of columns than in the table,\n        use the syntax:\n      </p><div class=\"hue-doc-codeblock\">INSERT INTO <span class=\"hue-doc-varname\">destination</span>\n  (<span class=\"hue-doc-varname\">col_x</span>, <span class=\"hue-doc-varname\">col_y</span>, <span class=\"hue-doc-varname\">col_z</span>)\n  VALUES\n  (<span class=\"hue-doc-varname\">val_x</span>, <span class=\"hue-doc-varname\">val_y</span>, <span class=\"hue-doc-varname\">val_z</span>);\n</div><p>\n        Any columns in the table that are not listed in the <span class=\"hue-doc-codeph\">INSERT</span> statement are set to\n        <span class=\"hue-doc-codeph\">NULL</span>.\n      </p><p id=\"hdfs_blurb\"><b>HDFS considerations:</b></p><p>\n        Impala physically writes all inserted files under the ownership of its default user, typically\n        <span class=\"hue-doc-codeph\">impala</span>. Therefore, this user must have HDFS write permission in the corresponding table\n        directory.\n      </p><p>\n        The permission requirement is independent of the authorization performed by the Ranger framework. (If the\n        connected user is not authorized to insert into a table, Ranger blocks that operation immediately,\n        regardless of the privileges available to the <span class=\"hue-doc-codeph\">impala</span> user.) Files created by Impala are\n        not owned by and do not inherit permissions from the connected user.\n      </p><p>\n        The number of data files produced by an <span class=\"hue-doc-codeph\">INSERT</span> statement depends on the size of the\n        cluster, the number of data blocks that are processed, the partition key columns in a partitioned table,\n        and the mechanism Impala uses for dividing the work in parallel. Do not assume that an\n        <span class=\"hue-doc-codeph\">INSERT</span> statement will produce some particular number of output files. In case of\n        performance issues with data written by Impala, check that the output files do not suffer from issues such\n        as many tiny files or many tiny partitions. (In the Hadoop context, even files or partitions of a few tens\n        of megabytes are considered <q>tiny</q>.)\n      </p><p id=\"insert_hidden_work_directory\">\n        The <span class=\"hue-doc-codeph\">INSERT</span> statement has always left behind a hidden work directory\n        inside the data directory of the table. Formerly, this hidden work directory was named\n        <span class=\"hue-doc-filepath\">.impala_insert_staging</span> . In Impala 2.0.1 and later, this directory\n        name is changed to <span class=\"hue-doc-filepath\">_impala_insert_staging</span> . (While HDFS tools are\n        expected to treat names beginning either with underscore and dot as hidden, in practice\n        names beginning with an underscore are more widely supported.) If you have any scripts,\n        cleanup jobs, and so on that rely on the name of this work directory, adjust them to use\n        the new name.\n      </p><p id=\"hbase_blurb\"><b>HBase considerations:</b></p><p>\n        You can use the <span class=\"hue-doc-codeph\">INSERT</span> statement with HBase tables as follows:\n      </p><ul><li><p>\n            You can insert a single row or a small set of rows into an HBase table with the <span class=\"hue-doc-codeph\">INSERT ...\n            VALUES</span> syntax. This is a good use case for HBase tables with Impala, because HBase tables are\n            not subject to the same kind of fragmentation from many small insert operations as HDFS tables are.\n          </p></li><li><p>\n            You can insert any number of rows at once into an HBase table using the <span class=\"hue-doc-codeph\">INSERT ...\n            SELECT</span> syntax.\n          </p></li><li><p>\n            If more than one inserted row has the same value for the HBase key column, only the last inserted row\n            with that value is visible to Impala queries. You can take advantage of this fact with <span class=\"hue-doc-codeph\">INSERT\n            ... VALUES</span> statements to effectively update rows one at a time, by inserting new rows with the\n            same key values as existing rows. Be aware that after an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> operation\n            copying from an HDFS table, the HBase table might contain fewer rows than were inserted, if the key\n            column in the source table contained duplicate values.\n          </p></li><li><p>\n            You cannot <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> into an HBase table. New rows are always appended.\n          </p></li><li><p>\n            When you create an Impala or Hive table that maps to an HBase table, the column order you specify with\n            the <span class=\"hue-doc-codeph\">INSERT</span> statement might be different than the order you declare with the\n            <span class=\"hue-doc-codeph\">CREATE TABLE</span> statement. Behind the scenes, HBase arranges the columns based on how\n            they are divided into column families. This might cause a mismatch during insert operations, especially\n            if you use the syntax <span class=\"hue-doc-codeph\">INSERT INTO <span class=\"hue-doc-varname\">hbase_table</span> SELECT * FROM\n            <span class=\"hue-doc-varname\">hdfs_table</span></span>. Before inserting data, verify the column order by issuing a\n            <span class=\"hue-doc-codeph\">DESCRIBE</span> statement for the table, and adjust the order of the select list in the\n            <span class=\"hue-doc-codeph\">INSERT</span> statement.\n          </p></li></ul><p>\n        See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_hbase.xml\" data-doc-anchor-id=\"impala_hbase\">Using Impala to Query HBase Tables</a> for more details about using Impala with HBase.\n      </p><p id=\"s3_blurb\"><b>Amazon S3 considerations:</b></p><p id=\"s3_dml\"> In Impala 2.6 and higher, the Impala DML statements (<span class=\"hue-doc-codeph\">INSERT</span>,\n          <span class=\"hue-doc-codeph\">LOAD DATA</span>, and <span class=\"hue-doc-codeph\">CREATE TABLE AS\n          SELECT</span>) can write data into a table or partition that resides\n        in S3. The syntax of the DML statements is the same as for any other\n        tables, because the S3 location for tables and partitions is specified\n        by an <span class=\"hue-doc-codeph\">s3a://</span> prefix in the <span class=\"hue-doc-codeph\">LOCATION</span>\n        attribute of <span class=\"hue-doc-codeph\">CREATE TABLE</span> or <span class=\"hue-doc-codeph\">ALTER\n          TABLE</span> statements. If you bring data into S3 using the normal\n        S3 transfer mechanisms instead of Impala DML statements, issue a\n          <span class=\"hue-doc-codeph\">REFRESH</span> statement for the table before using Impala\n        to query the S3 data. </p><p id=\"s3_dml_performance\"> Because of differences\n        between S3 and traditional filesystems, DML operations for S3 tables can\n        take longer than for tables on HDFS. For example, both the <span class=\"hue-doc-codeph\">LOAD\n          DATA</span> statement and the final stage of the\n          <span class=\"hue-doc-codeph\">INSERT</span> and <span class=\"hue-doc-codeph\">CREATE TABLE AS SELECT</span>\n        statements involve moving files from one directory to another. (In the\n        case of <span class=\"hue-doc-codeph\">INSERT</span> and <span class=\"hue-doc-codeph\">CREATE TABLE AS\n          SELECT</span>, the files are moved from a temporary staging\n        directory to the final destination directory.) Because S3 does not\n        support a <q>rename</q> operation for existing objects, in these cases\n        Impala actually copies the data files from one location to another and\n        then removes the original files. In Impala 2.6,\n        the <span class=\"hue-doc-codeph\">S3_SKIP_INSERT_STAGING</span> query option provides a way\n        to speed up <span class=\"hue-doc-codeph\">INSERT</span> statements for S3 tables and\n        partitions, with the tradeoff that a problem during statement execution\n        could leave data in an inconsistent state. It does not apply to\n          <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> or <span class=\"hue-doc-codeph\">LOAD DATA</span>\n        statements. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_s3_skip_insert_staging.xml\" data-doc-anchor-id=\"s3_skip_insert_staging\">S3_SKIP_INSERT_STAGING Query Option</a> for details. </p><p>See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_s3.xml\" data-doc-anchor-id=\"s3\">Using Impala with Amazon S3 Object Store</a> for details about reading and writing S3 data with Impala.</p><p id=\"adls_blurb\"><b>ADLS considerations:</b></p><p id=\"adls_dml\">\n        In Impala 2.9 and higher, the Impala DML statements\n        (<span class=\"hue-doc-codeph\">INSERT</span>, <span class=\"hue-doc-codeph\">LOAD DATA</span>, and <span class=\"hue-doc-codeph\">CREATE TABLE AS\n        SELECT</span>) can write data into a table or partition that resides in the Azure Data\n        Lake Store (ADLS). ADLS Gen2 is supported in Impala 3.1 and higher.\n      </p><p>See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_adls.xml\" data-doc-anchor-id=\"adls\">Using Impala with the Azure Data Lake Store (ADLS)</a> for details about reading and writing ADLS data with Impala.</p><p id=\"security_blurb\"><b>Security considerations:</b></p><p id=\"redaction_yes\">\n        If these statements in your environment contain sensitive literal values such as credit\n        card numbers or tax identifiers, Impala can redact this sensitive information when\n        displaying the statements in log files and other administrative contexts. See\n        \n    the documentation for your Apache Hadoop distribution\n   for details.\n      </p><p id=\"cancel_blurb_yes\"><b>Cancellation:</b> Can be cancelled. To cancel this statement, use Ctrl-C from the\n        <span class=\"hue-doc-cmdname\">impala-shell</span> interpreter, the <div class=\"hue-doc-uicontrol\">Cancel</div> button\n        from the <div class=\"hue-doc-uicontrol\">Watch</div> page in Hue, or <div class=\"hue-doc-uicontrol\">Cancel</div> from\n        the list of in-flight queries (for a particular node) on the\n        <div class=\"hue-doc-uicontrol\">Queries</div> tab in the Impala web UI (port 25000).\n      </p><p id=\"permissions_blurb\"><b>HDFS permissions:</b></p><p>\n        The user ID that the <span class=\"hue-doc-cmdname\">impalad</span> daemon runs under,\n        typically the <span class=\"hue-doc-codeph\">impala</span> user, must have read\n        permission for the files in the source directory of an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span>\n        operation, and write permission for all affected directories in the destination table.\n        (An <span class=\"hue-doc-codeph\">INSERT</span> operation could write files to multiple different HDFS directories\n        if the destination table is partitioned.)\n        This user must also have write permission to create a temporary work directory\n        in the top-level HDFS directory of the destination table.\n        An <span class=\"hue-doc-codeph\">INSERT OVERWRITE</span> operation does not require write permission on\n        the original data files in the table, only on the table directories themselves.\n      </p><p id=\"restrictions_blurb\"><b>Restrictions:</b></p><p id=\"char_varchar_cast_from_string\">\n        For <span class=\"hue-doc-codeph\">INSERT</span> operations into <span class=\"hue-doc-codeph\">CHAR</span> or\n        <span class=\"hue-doc-codeph\">VARCHAR</span> columns, you must cast all <span class=\"hue-doc-codeph\">STRING</span> literals or\n        expressions returning <span class=\"hue-doc-codeph\">STRING</span> to to a <span class=\"hue-doc-codeph\">CHAR</span> or\n        <span class=\"hue-doc-codeph\">VARCHAR</span> type with the appropriate length.\n      </p><p id=\"related_options\"><b>Related startup options:</b></p><p id=\"insert_inherit_permissions\">\n        By default, if an <span class=\"hue-doc-codeph\">INSERT</span> statement creates any new subdirectories\n        underneath a partitioned table, those subdirectories are assigned default HDFS\n        permissions for the <span class=\"hue-doc-codeph\">impala</span> user. To make each subdirectory have the\n        same permissions as its parent directory in HDFS, specify the\n        <span class=\"hue-doc-codeph\">‑‑insert_inherit_permissions</span> startup option for the\n        <span class=\"hue-doc-cmdname\">impalad</span> daemon.\n      </p></div></div><div id=\"partition_insert\"><div class=\"hue-doc-title\">Inserting Into Partitioned Tables with PARTITION Clause</div><div><p>\n        For a partitioned table, the optional <span class=\"hue-doc-codeph\">PARTITION</span> clause\n        identifies which partition or partitions the values are inserted\n        into.\n      </p><p>\n        All examples in this section will use the table declared as below:\n      </p><div class=\"hue-doc-codeblock\">CREATE TABLE t1 (w INT) PARTITIONED BY (x INT, y STRING);</div></div><div id=\"static_partition_insert\"><div class=\"hue-doc-title\">Static Partition Inserts</div><div><p>\n          In a static partition insert where a partition key column is given a\n          constant value, such as <span class=\"hue-doc-codeph\">PARTITION</span><span class=\"hue-doc-codeph\">(year=2012, month=2)</span>, the rows are inserted with the\n          same values specified for those partition key columns.\n        </p><p>\n          The number of columns in the <span class=\"hue-doc-codeph\">SELECT</span> list must equal\n          the number of columns in the column permutation.\n        </p><p>\n          The <span class=\"hue-doc-codeph\">PARTITION</span> clause must be used for static\n          partitioning inserts.\n        </p><p>\n          Example:\n        </p><p>\n          The following statement will insert the\n            <span class=\"hue-doc-codeph\">some_other_table.c1</span> values for the\n            <span class=\"hue-doc-codeph\">w</span> column, and all the rows inserted will have the\n          same <span class=\"hue-doc-codeph\">x</span> value of <span class=\"hue-doc-codeph\">10</span>, and the same\n            <span class=\"hue-doc-codeph\">y</span> value of\n          <span class=\"hue-doc-codeph\">‘a’</span>.<div class=\"hue-doc-codeblock\">INSERT INTO t1 PARTITION (x=10, y='a')\n            SELECT c1 FROM some_other_table;</div></p></div></div><div id=\"dynamic_partition_insert\"><div class=\"hue-doc-title\">Dynamic Partition Inserts</div><div><p>\n            In a dynamic partition insert where a partition key\n          column is in the <span class=\"hue-doc-codeph\">INSERT</span> statement but not assigned a\n          value, such as in <span class=\"hue-doc-codeph\">PARTITION (year, region)</span>(both\n          columns unassigned) or <span class=\"hue-doc-codeph\">PARTITION(year, region='CA')</span>\n            (<span class=\"hue-doc-codeph\">year</span> column unassigned), the unassigned columns\n          are filled in with the final columns of the <span class=\"hue-doc-codeph\">SELECT</span> or\n            <span class=\"hue-doc-codeph\">VALUES</span> clause. In this case, the number of columns\n          in the <span class=\"hue-doc-codeph\">SELECT</span> list must equal the number of columns\n          in the column permutation plus the number of partition key columns not\n          assigned a constant value.\n          </p><p>\n            See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_partitioning.xml\" data-doc-anchor-id=\"partition_static_dynamic\">Static and Dynamic Partitioning Clauses</a> for examples and performance characteristics of static and dynamic\n          partitioned inserts.\n          </p><p>\n            The following rules apply to dynamic partition\n            inserts.\n          </p><ul><li><p>\n                The columns are bound in the order they appear in the\n                  <span class=\"hue-doc-codeph\">INSERT</span> statement.\n              </p><p>\n                The table below shows the values inserted with the\n                <span class=\"hue-doc-codeph\">INSERT</span> statements of different column\n              orders.\n              </p></li></ul><table id=\"table_vyx_dp3_ldb\"><tbody><tr><td/><td>Column <span class=\"hue-doc-codeph\">w</span> Value</td><td>Column <span class=\"hue-doc-codeph\">x</span> Value</td><td>Column <span class=\"hue-doc-codeph\">y</span> Value</td></tr><tr><td><span class=\"hue-doc-codeph\">INSERT INTO t1 (w, x, y) VALUES (1, 2,\n                      'c');</span></td><td><span class=\"hue-doc-codeph\">1</span></td><td><span class=\"hue-doc-codeph\">2</span></td><td><span class=\"hue-doc-codeph\">‘c’</span></td></tr><tr><td><span class=\"hue-doc-codeph\">INSERT INTO t1 (x,w) PARTITION (y) VALUES (1,\n                      2, 'c');</span></td><td><span class=\"hue-doc-codeph\">2</span></td><td><span class=\"hue-doc-codeph\">1</span></td><td><span class=\"hue-doc-codeph\">‘c’</span></td></tr></tbody></table><ul><li>\n              When a partition clause is specified but the non-partition\n            columns are not specified in the <span class=\"hue-doc-codeph\">INSERT</span> statement,\n            as in the first example below, the non-partition columns are treated\n            as though they had been specified before the\n              <span class=\"hue-doc-codeph\">PARTITION</span> clause in the SQL.\n              <p>\n                Example: These\n              three statements are equivalent, inserting <span class=\"hue-doc-codeph\">1</span> to\n                <span class=\"hue-doc-codeph\">w</span>, <span class=\"hue-doc-codeph\">2</span> to <span class=\"hue-doc-codeph\">x</span>,\n              and <span class=\"hue-doc-codeph\">‘c’</span> to <span class=\"hue-doc-codeph\">y</span>\n            columns.\n              </p><div class=\"hue-doc-codeblock\">INSERT INTO t1 PARTITION (x,y) VALUES (1, 2, ‘c’);\nINSERT INTO t1 (w) PARTITION (x, y) VALUES (1, 2, ‘c’);\nINSERT INTO t1 PARTITION (x, y='c') VALUES (1, 2);</div></li><li>\n              The <span class=\"hue-doc-codeph\">PARTITION</span> clause is not required for\n            dynamic partition, but all the partition columns must be explicitly\n            present in the <span class=\"hue-doc-codeph\">INSERT</span> statement in the column list\n            or in the <span class=\"hue-doc-codeph\">PARTITION</span> clause. The partition columns\n            cannot be defaulted to <span class=\"hue-doc-codeph\">NULL</span>.\n              <p>\n                Example:\n              </p><p>The following statements are valid because the partition\n              columns, <span class=\"hue-doc-codeph\">x</span> and <span class=\"hue-doc-codeph\">y</span>, are present in\n              the <span class=\"hue-doc-codeph\">INSERT</span> statements, either in the\n                <span class=\"hue-doc-codeph\">PARTITION</span> clause or in the column\n              list.\n              </p><div class=\"hue-doc-codeblock\">INSERT INTO t1 PARTITION (x,y) VALUES (1, 2, ‘c’);\nINSERT INTO t1 (w, x) PARTITION (y) VALUES (1, 2, ‘c’);</div><p>\n                The following statement is not valid for the partitioned table as\n              defined above because the partition columns, <span class=\"hue-doc-codeph\">x</span>\n              and <span class=\"hue-doc-codeph\">y</span>, are not present in the\n                <span class=\"hue-doc-codeph\">INSERT</span> statement.\n              </p><div class=\"hue-doc-codeblock\">INSERT INTO t1 VALUES (1, 2, 'c');</div></li><li>\n              If partition columns do not exist in the source table, you can\n              specify a specific value for that column in the\n              <span class=\"hue-doc-codeph\">PARTITION</span> clause.\n              <p>\n                Example: The <span class=\"hue-doc-codeph\">source</span> table only contains the column\n                <span class=\"hue-doc-codeph\">w</span> and <span class=\"hue-doc-codeph\">y</span>. The value,\n                <span class=\"hue-doc-codeph\">20</span>, specified in the <span class=\"hue-doc-codeph\">PARTITION</span>\n              clause, is inserted into the <span class=\"hue-doc-codeph\">x</span> column.\n              </p><div class=\"hue-doc-codeblock\">INSERT INTO t1 PARTITION (x=20, y) SELECT * FROM source;</div></li></ul></div></div></div></div></div>","title":"INSERT Statement"}