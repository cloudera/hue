{"body":"<div><div><div class=\"hue-doc-title\">DISTINCT Operator</div><div><p>\n      The <span class=\"hue-doc-codeph\">DISTINCT</span> operator in a <span class=\"hue-doc-codeph\">SELECT</span> statement filters the result set to\n      remove duplicates:\n    </p><div class=\"hue-doc-codeblock\">-- Returns the unique values from one column.\n-- NULL is included in the set of values if any rows have a NULL in this column.\nselect distinct c_birth_country from customer;\n-- Returns the unique combinations of values from multiple columns.\nselect distinct c_salutation, c_last_name from customer;</div><p>\n      You can use <span class=\"hue-doc-codeph\">DISTINCT</span> in combination with an aggregation function, typically\n      <span class=\"hue-doc-codeph\">COUNT()</span>, to find how many different values a column contains:\n    </p><div class=\"hue-doc-codeblock\">-- Counts the unique values from one column.\n-- NULL is not included as a distinct value in the count.\nselect count(distinct c_birth_country) from customer;\n-- Counts the unique combinations of values from multiple columns.\nselect count(distinct c_salutation, c_last_name) from customer;</div><p>\n      One construct that Impala SQL does <i>not</i> support is using <span class=\"hue-doc-codeph\">DISTINCT</span> in more than one\n      aggregation function in the same query. For example, you could not have a single query with both\n      <span class=\"hue-doc-codeph\">COUNT(DISTINCT c_first_name)</span> and <span class=\"hue-doc-codeph\">COUNT(DISTINCT c_last_name)</span> in the\n      <span class=\"hue-doc-codeph\">SELECT</span> list.\n    </p><p><b>Zero-length strings:</b> For purposes of clauses such as <span class=\"hue-doc-codeph\">DISTINCT</span> and <span class=\"hue-doc-codeph\">GROUP\n        BY</span>, Impala considers zero-length strings (<span class=\"hue-doc-codeph\">\"\"</span>), <span class=\"hue-doc-codeph\">NULL</span>, and space\n        to all be different values.\n      </p><div class=\"hue-doc-note\"><p>\n          By default, Impala only allows a single <span class=\"hue-doc-codeph\">COUNT(DISTINCT <span class=\"hue-doc-varname\">columns</span>)</span>\n          expression in each query.\n        </p><p>\n          If you do not need precise accuracy, you can produce an estimate of the distinct values for a column by\n          specifying <span class=\"hue-doc-codeph\">NDV(<span class=\"hue-doc-varname\">column</span>)</span>; a query can contain multiple instances of\n          <span class=\"hue-doc-codeph\">NDV(<span class=\"hue-doc-varname\">column</span>)</span>. To make Impala automatically rewrite\n          <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> expressions to <span class=\"hue-doc-codeph\">NDV()</span>, enable the\n          <span class=\"hue-doc-codeph\">APPX_COUNT_DISTINCT</span> query option.\n        </p><p>\n          To produce the same result as multiple <span class=\"hue-doc-codeph\">COUNT(DISTINCT)</span> expressions, you can use the\n          following technique for queries involving a single table:\n        </p><div class=\"hue-doc-codeblock\">select v1.c1 result1, v2.c1 result2 from\n  (select count(distinct col1) as c1 from t1) v1\n    cross join\n  (select count(distinct col2) as c1 from t1) v2;\n</div><p>\n          Because <span class=\"hue-doc-codeph\">CROSS JOIN</span> is an expensive operation, prefer to use the <span class=\"hue-doc-codeph\">NDV()</span>\n          technique wherever practical.\n        </p></div><div class=\"hue-doc-note\"><p>\n        In contrast with some database systems that always return <span class=\"hue-doc-codeph\">DISTINCT</span> values in sorted order,\n        Impala does not do any ordering of <span class=\"hue-doc-codeph\">DISTINCT</span> values. Always include an <span class=\"hue-doc-codeph\">ORDER\n        BY</span> clause if you need the values in alphabetical or numeric sorted order.\n      </p></div></div></div></div>","title":"DISTINCT Operator"}