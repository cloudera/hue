{"body":"<div><div id=\"conditional_functions\"><div class=\"hue-doc-title\">Impala Conditional Functions</div><div><p>\n      Impala supports the following conditional functions for testing equality, comparison\n      operators, and nullity:\n    </p><ul><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/case\">CASE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/case2\">CASE2</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/coalesce\">COALESCE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/decode\">DECODE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/if\">IF</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/ifnull\">IFNULL</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/isfalse\">ISFALSE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/isnotfalse\">ISNOTFALSE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/isnottrue\">ISNOTTRUE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/isnull\">ISNULL</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/istrue\">ISTRUE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nonnullvalue\">NONNULLVALUE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nullif\">NULLIF</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nullifzero\">NULLIFZERO</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nullvalue\">NULLVALUE</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nvl\">NVL</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/nvl2\">NVL2</a></li><li><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_conditional_functions.xml\" data-doc-anchor-id=\"conditional_functions/zeroifnull\">ZEROIFNULL</a></li></ul><dl><dt id=\"case\">\n          CASE a WHEN b THEN c [WHEN d THEN e]... [ELSE f] END\n        </dt><dd><b>Purpose:</b> Compares an expression to one or more possible values, and returns a\n          corresponding result when a match is found.\n          <p id=\"return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are\n        promoted to <span class=\"hue-doc-codeph\">BIGINT</span> and floating-point values are promoted to\n        <span class=\"hue-doc-codeph\">DOUBLE</span>; use <span class=\"hue-doc-codeph\">CAST()</span> when inserting into a smaller\n        numeric column\n      </p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p>\n            In this form of the <span class=\"hue-doc-codeph\">CASE</span> expression, the initial value\n            <span class=\"hue-doc-codeph\">A</span> being evaluated for each row it typically a column reference, or\n            an expression involving a column. This form can only compare against a set of\n            specified values, not ranges, multi-value comparisons such as\n            <span class=\"hue-doc-codeph\">BETWEEN</span> or <span class=\"hue-doc-codeph\">IN</span>, regular expressions, or\n            <span class=\"hue-doc-codeph\">NULL</span>.\n          </p><p id=\"example_blurb\"><b>Examples:</b></p><p>\n            Although this example is split across multiple lines, you can put any or all parts\n            of a <span class=\"hue-doc-codeph\">CASE</span> expression on a single line, with no punctuation or other\n            separators between the <span class=\"hue-doc-codeph\">WHEN</span>, <span class=\"hue-doc-codeph\">ELSE</span>, and\n            <span class=\"hue-doc-codeph\">END</span> clauses.\n          </p><div class=\"hue-doc-codeblock\">select case x\n    when 1 then 'one'\n    when 2 then 'two'\n    when 0 then 'zero'\n    else 'out of range'\n  end\n    from t1;\n</div></dd><dt id=\"case2\">\n          CASE WHEN a THEN b [WHEN c THEN d]... [ELSE e] END\n        </dt><dd><b>Purpose:</b> Tests whether any of a sequence of expressions is\n          <span class=\"hue-doc-codeph\">TRUE</span>, and returns a corresponding result for the first true\n          expression.\n          <p id=\"return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are\n        promoted to <span class=\"hue-doc-codeph\">BIGINT</span> and floating-point values are promoted to\n        <span class=\"hue-doc-codeph\">DOUBLE</span>; use <span class=\"hue-doc-codeph\">CAST()</span> when inserting into a smaller\n        numeric column\n      </p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p><span class=\"hue-doc-codeph\">CASE</span> expressions without an initial test value have more\n            flexibility. For example, they can test different columns in different\n            <span class=\"hue-doc-codeph\">WHEN</span> clauses, or use comparison operators such as\n            <span class=\"hue-doc-codeph\">BETWEEN</span>, <span class=\"hue-doc-codeph\">IN</span> and <span class=\"hue-doc-codeph\">IS NULL</span> rather\n            than comparing against discrete values.\n          </p><p><span class=\"hue-doc-codeph\">CASE</span> expressions are often the foundation of long queries that\n            summarize and format results for easy-to-read reports. For example, you might use a\n            <span class=\"hue-doc-codeph\">CASE</span> function call to turn values from a numeric column into\n            category strings corresponding to integer values, or labels such as <q>Small</q>,\n            <q>Medium</q> and <q>Large</q> based on ranges. Then subsequent parts of the query\n            might aggregate based on the transformed values, such as how many values are\n            classified as small, medium, or large. You can also use <span class=\"hue-doc-codeph\">CASE</span> to\n            signal problems with out-of-bounds values, <span class=\"hue-doc-codeph\">NULL</span> values, and so on.\n          </p><p>\n            By using operators such as <span class=\"hue-doc-codeph\">OR</span>, <span class=\"hue-doc-codeph\">IN</span>,\n            <span class=\"hue-doc-codeph\">REGEXP</span>, and so on in <span class=\"hue-doc-codeph\">CASE</span> expressions, you can\n            build extensive tests and transformations into a single query. Therefore,\n            applications that construct SQL statements often rely heavily on\n            <span class=\"hue-doc-codeph\">CASE</span> calls in the generated SQL code.\n          </p><p>\n            Because this flexible form of the <span class=\"hue-doc-codeph\">CASE</span> expressions allows you to\n            perform many comparisons and call multiple functions when evaluating each row, be\n            careful applying elaborate <span class=\"hue-doc-codeph\">CASE</span> expressions to queries that process\n            large amounts of data. For example, when practical, evaluate and transform values\n            through <span class=\"hue-doc-codeph\">CASE</span> after applying operations such as aggregations that\n            reduce the size of the result set; transform numbers to strings after performing\n            joins with the original numeric values.\n          </p><p id=\"example_blurb\"><b>Examples:</b></p><p>\n            Although this example is split across multiple lines, you can put any or all parts\n            of a <span class=\"hue-doc-codeph\">CASE</span> expression on a single line, with no punctuation or other\n            separators between the <span class=\"hue-doc-codeph\">WHEN</span>, <span class=\"hue-doc-codeph\">ELSE</span>, and\n            <span class=\"hue-doc-codeph\">END</span> clauses.\n          </p><div class=\"hue-doc-codeblock\">select case\n    when dayname(now()) in ('Saturday','Sunday') then 'result undefined on weekends'\n    when x &gt; y then 'x greater than y'\n    when x = y then 'x and y are equal'\n    when x is null or y is null then 'one of the columns is null'\n    else null\n  end\n    from t1;\n</div></dd><dt id=\"coalesce\">\n          COALESCE(type v1, type v2, ...)\n        </dt><dd><b>Purpose:</b> Returns the first specified argument that is not\n          <span class=\"hue-doc-codeph\">NULL</span>, or <span class=\"hue-doc-codeph\">NULL</span> if all arguments are\n          <span class=\"hue-doc-codeph\">NULL</span>.\n          <p id=\"return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are\n        promoted to <span class=\"hue-doc-codeph\">BIGINT</span> and floating-point values are promoted to\n        <span class=\"hue-doc-codeph\">DOUBLE</span>; use <span class=\"hue-doc-codeph\">CAST()</span> when inserting into a smaller\n        numeric column\n      </p></dd><dt id=\"decode\">\n          DECODE(type expression, type search1, type result1 [, type search2, type result2 ...]\n          [, type default] )\n        </dt><dd><b>Purpose:</b> Compares the first argument, <span class=\"hue-doc-codeph\">expression</span>, to the\n          <span class=\"hue-doc-codeph\">search</span> expressions using the <span class=\"hue-doc-codeph\">IS NOT DISTINCT</span>\n          operator, and returns:\n          <ul><li>\n              The corresponding <span class=\"hue-doc-codeph\">result</span> when a match is found.\n            </li><li>\n              The first corresponding <span class=\"hue-doc-codeph\">result</span> if there are more than one\n              matching <span class=\"hue-doc-codeph\">search</span> expressions.\n            </li><li>\n              The <span class=\"hue-doc-codeph\">default</span> expression if none of the search expressions matches\n              the first argument <span class=\"hue-doc-codeph\">expression</span>.\n            </li><li><span class=\"hue-doc-codeph\">NULL</span> if the final <span class=\"hue-doc-codeph\">default</span> expression is omitted\n              and none of the <span class=\"hue-doc-codeph\">search</span> expressions matches the first argument.\n            </li></ul><p><b>Return type:</b> Same as the first argument with the following exceptions:\n            <ul><li>\n                Integer values are promoted to <span class=\"hue-doc-codeph\">BIGINT</span>.\n              </li><li>\n                Floating-point values are promoted to <span class=\"hue-doc-codeph\">DOUBLE</span>.\n              </li><li>\n                Use <span class=\"hue-doc-codeph\">CAST()</span> when inserting into a smaller numeric column.\n              </li></ul></p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><ul><li>\n              Can be used as shorthand for a <span class=\"hue-doc-codeph\">CASE</span> expression.\n            </li><li>\n              The first argument, <span class=\"hue-doc-codeph\">expression</span>, and the search expressions must\n              be of the same type or convertible types.\n            </li><li>\n              The result expression can be a different type, but all result expressions must be\n              of the same type.\n            </li><li>\n              Returns a successful match if the first argument is <span class=\"hue-doc-codeph\">NULL</span> and a\n              search expression is also <span class=\"hue-doc-codeph\">NULL</span>.\n            </li><li><span class=\"hue-doc-codeph\">NULL</span> can be used as a search expression.\n            </li></ul><p id=\"example_blurb\"><b>Examples:</b></p><p>\n            The following example translates numeric day values into weekday names, such as 1 to\n            Monday, 2 to Tuesday, etc.\n          </p><div class=\"hue-doc-codeblock\">SELECT event, DECODE(day_of_week, 1, \"Monday\", 2, \"Tuesday\", 3, \"Wednesday\",\n  4, \"Thursday\", 5, \"Friday\", 6, \"Saturday\", 7, \"Sunday\", \"Unknown day\")\n  FROM calendar;\n</div></dd><dt id=\"if\">\n          IF(BOOLEAN condition, type ifTrue, type ifFalseOrNull)\n        </dt><dd><b>Purpose:</b> Tests an expression and returns a corresponding result depending on\n          whether the result is <span class=\"hue-doc-codeph\">TRUE</span>, <span class=\"hue-doc-codeph\">FALSE</span>, or\n          <span class=\"hue-doc-codeph\">NULL</span>.\n          <p><b>Return type:</b> Same as the <span class=\"hue-doc-codeph\">ifTrue</span> argument value\n          </p></dd><dt id=\"ifnull\">\n          IFNULL(type a, type ifNull)\n        </dt><dd><b>Purpose:</b> Alias for the <span class=\"hue-doc-codeph\">ISNULL()</span> function, with the same\n          behavior. To simplify porting SQL with vendor extensions to Impala.\n          <p id=\"added_in_130\"><b>Added in:</b> Impala 1.3.0\n      </p></dd><dt id=\"isfalse\">\n          ISFALSE(BOOLEAN expression)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">TRUE</span> if the expression is\n          <span class=\"hue-doc-codeph\">FALSE</span>. Returns <span class=\"hue-doc-codeph\">FALSE</span> if the expression is\n          <span class=\"hue-doc-codeph\">TRUE</span> or <span class=\"hue-doc-codeph\">NULL</span>.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS FALSE</span> operator.\n          </p><p>\n            Similar to <span class=\"hue-doc-codeph\">ISNOTTRUE()</span>, except it returns the opposite value for a\n            <span class=\"hue-doc-codeph\">NULL</span> argument.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"boolean_functions_vs_expressions\">\n        In Impala 2.11 and higher, you can use the operators <span class=\"hue-doc-codeph\">IS\n        [NOT] TRUE</span> and <span class=\"hue-doc-codeph\">IS [NOT] FALSE</span> as equivalents for the built-in\n        functions <span class=\"hue-doc-codeph\">ISTRUE()</span>, <span class=\"hue-doc-codeph\">ISNOTTRUE()</span>,\n        <span class=\"hue-doc-codeph\">ISFALSE()</span>, and <span class=\"hue-doc-codeph\">ISNOTFALSE()</span>.\n      </p></dd><dt id=\"isnotfalse\">\n          ISNOTFALSE(BOOLEAN expression)\n        </dt><dd><b>Purpose:</b> Tests if a Boolean expression is not <span class=\"hue-doc-codeph\">FALSE</span> (that is,\n          either <span class=\"hue-doc-codeph\">TRUE</span> or <span class=\"hue-doc-codeph\">NULL</span>). Returns <span class=\"hue-doc-codeph\">TRUE</span>\n          if so. If the argument is <span class=\"hue-doc-codeph\">NULL</span>, returns <span class=\"hue-doc-codeph\">TRUE</span>.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS NOT FALSE</span> operator.\n          </p><p>\n            Similar to <span class=\"hue-doc-codeph\">ISTRUE()</span>, except it returns the opposite value for a\n            <span class=\"hue-doc-codeph\">NULL</span> argument.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"for_compatibility_only\"><b>Usage notes:</b> Primarily for compatibility with code containing industry extensions\n        to SQL.\n      </p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"boolean_functions_vs_expressions\">\n        In Impala 2.11 and higher, you can use the operators <span class=\"hue-doc-codeph\">IS\n        [NOT] TRUE</span> and <span class=\"hue-doc-codeph\">IS [NOT] FALSE</span> as equivalents for the built-in\n        functions <span class=\"hue-doc-codeph\">ISTRUE()</span>, <span class=\"hue-doc-codeph\">ISNOTTRUE()</span>,\n        <span class=\"hue-doc-codeph\">ISFALSE()</span>, and <span class=\"hue-doc-codeph\">ISNOTFALSE()</span>.\n      </p></dd><dt id=\"isnottrue\">\n          ISNOTTRUE(BOOLEAN expression)\n        </dt><dd><b>Purpose:</b> Tests if a Boolean expression is not <span class=\"hue-doc-codeph\">TRUE</span> (that is,\n          either <span class=\"hue-doc-codeph\">FALSE</span> or <span class=\"hue-doc-codeph\">NULL</span>). Returns <span class=\"hue-doc-codeph\">TRUE</span>\n          if so. If the argument is <span class=\"hue-doc-codeph\">NULL</span>, returns <span class=\"hue-doc-codeph\">TRUE</span>.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS NOT TRUE</span> operator.\n          </p><p>\n            Similar to <span class=\"hue-doc-codeph\">ISFALSE()</span>, except it returns the opposite value for a\n            <span class=\"hue-doc-codeph\">NULL</span> argument.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"boolean_functions_vs_expressions\">\n        In Impala 2.11 and higher, you can use the operators <span class=\"hue-doc-codeph\">IS\n        [NOT] TRUE</span> and <span class=\"hue-doc-codeph\">IS [NOT] FALSE</span> as equivalents for the built-in\n        functions <span class=\"hue-doc-codeph\">ISTRUE()</span>, <span class=\"hue-doc-codeph\">ISNOTTRUE()</span>,\n        <span class=\"hue-doc-codeph\">ISFALSE()</span>, and <span class=\"hue-doc-codeph\">ISNOTFALSE()</span>.\n      </p></dd><dt id=\"isnull\">\n          ISNULL(type a, type ifNull)\n        </dt><dd><b>Purpose:</b> Tests if an expression is <span class=\"hue-doc-codeph\">NULL</span>, and returns the\n          expression result value if not. If the first argument is <span class=\"hue-doc-codeph\">NULL</span>,\n          returns the second argument.\n          <p><b>Compatibility notes:</b> Equivalent to the <span class=\"hue-doc-codeph\">NVL()</span> function from\n            Oracle Database or <span class=\"hue-doc-codeph\">IFNULL()</span> from MySQL. The <span class=\"hue-doc-codeph\">NVL()</span>\n            and <span class=\"hue-doc-codeph\">IFNULL()</span> functions are also available in Impala.\n          </p><p><b>Return type:</b> Same as the first argument value\n          </p></dd><dt id=\"istrue\">\n          ISTRUE(BOOLEAN expression)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">TRUE</span> if the expression is\n          <span class=\"hue-doc-codeph\">TRUE</span>. Returns <span class=\"hue-doc-codeph\">FALSE</span> if the expression is\n          <span class=\"hue-doc-codeph\">FALSE</span> or <span class=\"hue-doc-codeph\">NULL</span>.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS TRUE</span> operator.\n          </p><p>\n            Similar to <span class=\"hue-doc-codeph\">ISNOTFALSE()</span>, except it returns the opposite value for a\n            <span class=\"hue-doc-codeph\">NULL</span> argument.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"for_compatibility_only\"><b>Usage notes:</b> Primarily for compatibility with code containing industry extensions\n        to SQL.\n      </p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"boolean_functions_vs_expressions\">\n        In Impala 2.11 and higher, you can use the operators <span class=\"hue-doc-codeph\">IS\n        [NOT] TRUE</span> and <span class=\"hue-doc-codeph\">IS [NOT] FALSE</span> as equivalents for the built-in\n        functions <span class=\"hue-doc-codeph\">ISTRUE()</span>, <span class=\"hue-doc-codeph\">ISNOTTRUE()</span>,\n        <span class=\"hue-doc-codeph\">ISFALSE()</span>, and <span class=\"hue-doc-codeph\">ISNOTFALSE()</span>.\n      </p></dd><dt id=\"nonnullvalue\">\n          NONNULLVALUE(type expression)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">TRUE</span> if the expression is non-null and\n          returns <span class=\"hue-doc-codeph\">FALSE</span> if the expression is <span class=\"hue-doc-codeph\">NULL</span>.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS NOT NULL</span> operator.\n          </p><p>\n            The converse of <span class=\"hue-doc-codeph\">NULLVALUE()</span>.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"for_compatibility_only\"><b>Usage notes:</b> Primarily for compatibility with code containing industry extensions\n        to SQL.\n      </p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p></dd><dt id=\"nullif\">\n          NULLIF(type expr1, type expr2)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">NULL</span> if the two specified arguments are\n          equal. If the specified arguments are not equal, returns the value of\n          <span class=\"hue-doc-varname\">expr1</span>. The data types of the expressions must be compatible,\n          according to the conversion rules from <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_datatypes.xml\" data-doc-anchor-id=\"datatypes\">Data Types</a>.\n          You cannot use an expression that evaluates to <span class=\"hue-doc-codeph\">NULL</span> for\n          <span class=\"hue-doc-varname\">expr1</span>; that way, you can distinguish a return value of\n          <span class=\"hue-doc-codeph\">NULL</span> from an argument value of <span class=\"hue-doc-codeph\">NULL</span>, which would\n          never match <span class=\"hue-doc-varname\">expr2</span>.\n          <p><b>Usage notes:</b> This function is effectively shorthand for a\n            <span class=\"hue-doc-codeph\">CASE</span> expression of the form:\n          </p><div class=\"hue-doc-codeblock\">CASE\n  WHEN <span class=\"hue-doc-varname\">expr1</span> = <span class=\"hue-doc-varname\">expr2</span> THEN NULL\n  ELSE <span class=\"hue-doc-varname\">expr1</span>\nEND</div><p>\n            It is commonly used in division expressions, to produce a <span class=\"hue-doc-codeph\">NULL</span>\n            result instead of a divide-by-zero error when the divisor is equal to zero:\n          </p><div class=\"hue-doc-codeblock\">select 1.0 / nullif(c1,0) as reciprocal from t1;</div><p>\n            You might also use it for compatibility with other database systems that support the\n            same <span class=\"hue-doc-codeph\">NULLIF()</span> function.\n          </p><p id=\"return_same_type\"><b>Return type:</b> same as the initial argument value, except that integer values are\n        promoted to <span class=\"hue-doc-codeph\">BIGINT</span> and floating-point values are promoted to\n        <span class=\"hue-doc-codeph\">DOUBLE</span>; use <span class=\"hue-doc-codeph\">CAST()</span> when inserting into a smaller\n        numeric column\n      </p><p id=\"added_in_130\"><b>Added in:</b> Impala 1.3.0\n      </p></dd><dt id=\"nullifzero\">\n          NULLIFZERO(type numeric_expr)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">NULL</span> if the numeric expression evaluates to\n          0, otherwise returns the result of the expression.\n          <p><b>Usage notes:</b> Used to avoid error conditions such as divide-by-zero in numeric\n            calculations. Serves as shorthand for a more elaborate <span class=\"hue-doc-codeph\">CASE</span>\n            expression, to simplify porting SQL with vendor extensions to Impala.\n          </p><p><b>Return type:</b> Same type as the input argument\n          </p><p id=\"added_in_130\"><b>Added in:</b> Impala 1.3.0\n      </p></dd><dt id=\"nullvalue\">\n          NULLVALUE(type expression)\n        </dt><dd><b>Purpose:</b> Returns <span class=\"hue-doc-codeph\">TRUE</span> if the expression is\n          <span class=\"hue-doc-codeph\">NULL</span>, and returns <span class=\"hue-doc-codeph\">FALSE</span> otherwise.\n          <p>\n            Same as the <span class=\"hue-doc-codeph\">IS NULL</span> operator.\n          </p><p>\n            The converse of <span class=\"hue-doc-codeph\">NONNULLVALUE()</span>.\n          </p><p id=\"return_type_boolean\"><b>Return type:</b><span class=\"hue-doc-codeph\">BOOLEAN</span></p><p id=\"for_compatibility_only\"><b>Usage notes:</b> Primarily for compatibility with code containing industry extensions\n        to SQL.\n      </p><p id=\"added_in_220\"><b>Added in:</b>Impala 2.2.0</p></dd><dt id=\"nvl\">\n          NVL(type a, type ifNull)\n        </dt><dd><b>Purpose:</b> Alias for the <span class=\"hue-doc-codeph\">ISNULL()</span> function. Returns the first\n          argument if the first argument is not <span class=\"hue-doc-codeph\">NULL</span>. Returns the second\n          argument if the first argument is <span class=\"hue-doc-codeph\">NULL</span>.\n          <p>\n            Equivalent to the <span class=\"hue-doc-codeph\">NVL()</span> function in Oracle Database or\n            <span class=\"hue-doc-codeph\">IFNULL()</span> in MySQL.\n          </p><p><b>Return type:</b> Same as the first argument value\n          </p><p id=\"added_in_11\"><b>Added in:</b> Impala 1.1\n      </p></dd><dt id=\"nvl2\">\n          NVL2(type a, type ifNotNull, type ifNull)\n        </dt><dd><b>Purpose:</b> Returns the second argument,\n            <span class=\"hue-doc-codeph\">ifNotNull</span>, if the first argument is not\n            <span class=\"hue-doc-codeph\">NULL</span>. Returns the third argument,\n            <span class=\"hue-doc-codeph\">ifNull</span>, if the first argument is\n            <span class=\"hue-doc-codeph\">NULL</span>. <p> Equivalent to the <span class=\"hue-doc-codeph\">NVL2()</span>\n            function in Oracle Database. </p><p><b>Return type:</b> Same as the first argument value </p><p id=\"added_in_290\"><b>Added in:</b>Impala 2.9.0</p><p id=\"example_blurb\"><b>Examples:</b></p><div class=\"hue-doc-codeblock\">SELECT NVL2(NULL, 999, 0); -- Returns 0\nSELECT NVL2('ABC', 'Is Not Null', 'Is Null'); -- Returns 'Is Not Null'</div></dd><dt id=\"zeroifnull\">\n          ZEROIFNULL(type numeric_expr)\n        </dt><dd><b>Purpose:</b> Returns 0 if the numeric expression evaluates to\n          <span class=\"hue-doc-codeph\">NULL</span>, otherwise returns the result of the expression.\n          <p><b>Usage notes:</b> Used to avoid unexpected results due to unexpected propagation\n            of <span class=\"hue-doc-codeph\">NULL</span> values in numeric calculations. Serves as shorthand for a\n            more elaborate <span class=\"hue-doc-codeph\">CASE</span> expression, to simplify porting SQL with vendor\n            extensions to Impala.\n          </p><p><b>Return type:</b> Same type as the input argument\n          </p><p id=\"added_in_130\"><b>Added in:</b> Impala 1.3.0\n      </p></dd></dl></div></div></div>","title":"Impala Conditional Functions"}