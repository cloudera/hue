{"body":"<div><div id=\"map\"><div class=\"hue-doc-title\">MAP Complex Type (Impala 2.3 or higher only)</div><div><p>\n        A complex data type representing an arbitrary set of key-value pairs.\n        The key part is a scalar type, while the value part can be a scalar or\n        another complex type (<span class=\"hue-doc-codeph\">ARRAY</span>, <span class=\"hue-doc-codeph\">STRUCT</span>,\n        or <span class=\"hue-doc-codeph\">MAP</span>).\n      </p><p id=\"syntax_blurb\"><b>Syntax:</b></p><div class=\"hue-doc-codeblock\"><span class=\"hue-doc-varname\">column_name</span> MAP &lt; <span class=\"hue-doc-varname\">primitive_type</span>, <span class=\"hue-doc-varname\">type</span> &gt;\n\ntype ::= <span class=\"hue-doc-varname\">primitive_type</span> | <span class=\"hue-doc-varname\">complex_type</span></div><p id=\"usage_notes_blurb\"><b>Usage notes:</b></p><p id=\"complex_types_combo\">\n        Because complex types are often used in combination, for example an\n        <span class=\"hue-doc-codeph\">ARRAY</span> of <span class=\"hue-doc-codeph\">STRUCT</span> elements, if you are unfamiliar with\n        the Impala complex types, start with\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_complex_types.xml\" data-doc-anchor-id=\"complex_types\">Complex Types (Impala 2.3 or higher only)</a> for background\n        information and usage examples.\n      </p><p>\n        The <span class=\"hue-doc-codeph\">MAP</span> complex data type represents a set of key-value pairs.\n        Each element of the map is indexed by a primitive type such as <span class=\"hue-doc-codeph\">BIGINT</span> or\n        <span class=\"hue-doc-codeph\">STRING</span>, letting you define sequences that are not continuous or categories with arbitrary names.\n        You might find it convenient for modelling data produced in other languages, such as a\n        Python dictionary or Java HashMap, where a single scalar value serves as the lookup key.\n      </p><p>\n        In a big data context, the keys in a map column might represent a numeric sequence of events during a\n        manufacturing process, or <span class=\"hue-doc-codeph\">TIMESTAMP</span> values corresponding to sensor observations.\n        The map itself is inherently unordered, so you choose whether to make the key values significant\n        (such as a recorded <span class=\"hue-doc-codeph\">TIMESTAMP</span>) or synthetic (such as a random global universal ID).\n      </p><div class=\"hue-doc-note\">        Behind the scenes, the <span class=\"hue-doc-codeph\">MAP</span> type is implemented in a similar way as the\n        <span class=\"hue-doc-codeph\">ARRAY</span> type. Impala does not enforce any uniqueness constraint on the\n        <span class=\"hue-doc-codeph\">KEY</span> values, and the <span class=\"hue-doc-codeph\">KEY</span> values are processed by\n        looping through the elements of the <span class=\"hue-doc-codeph\">MAP</span> rather than by a constant-time lookup.\n        Therefore, this type is primarily for ease of understanding when importing data and\n        algorithms from non-SQL contexts, rather than optimizing the performance of key lookups.\n      </div><p id=\"complex_types_describe\">\n        You can pass a multi-part qualified name to <span class=\"hue-doc-codeph\">DESCRIBE</span> to specify an\n        <span class=\"hue-doc-codeph\">ARRAY</span>, <span class=\"hue-doc-codeph\">STRUCT</span>, or <span class=\"hue-doc-codeph\">MAP</span> column and\n        visualize its structure as if it were a table. For example, if table <span class=\"hue-doc-codeph\">T1</span>\n        contains an <span class=\"hue-doc-codeph\">ARRAY</span> column <span class=\"hue-doc-codeph\">A1</span>, you could issue the\n        statement <span class=\"hue-doc-codeph\">DESCRIBE t1.a1</span>. If table <span class=\"hue-doc-codeph\">T1</span> contained a\n        <span class=\"hue-doc-codeph\">STRUCT</span> column <span class=\"hue-doc-codeph\">S1</span>, and a field <span class=\"hue-doc-codeph\">F1</span>\n        within the <span class=\"hue-doc-codeph\">STRUCT</span> was a <span class=\"hue-doc-codeph\">MAP</span>, you could issue the\n        statement <span class=\"hue-doc-codeph\">DESCRIBE t1.s1.f1</span>. An <span class=\"hue-doc-codeph\">ARRAY</span> is shown as a\n        two-column table, with <span class=\"hue-doc-codeph\">ITEM</span> and <span class=\"hue-doc-codeph\">POS</span> columns. A\n        <span class=\"hue-doc-codeph\">STRUCT</span> is shown as a table with each field representing a column in the\n        table. A <span class=\"hue-doc-codeph\">MAP</span> is shown as a two-column table, with <span class=\"hue-doc-codeph\">KEY</span>\n        and <span class=\"hue-doc-codeph\">VALUE</span> columns.\n      </p><p id=\"added_in_230\"><b>Added in:</b>Impala 2.3.0</p><p id=\"restrictions_blurb\"><b>Restrictions:</b></p><ul id=\"complex_types_restrictions\"><li><p>\n            Columns with this data type can only be used in tables or partitions with the\n            Parquet or ORC file format.\n          </p></li><li><p>\n            Columns with this data type cannot be used as partition key columns in a partitioned\n            table.\n          </p></li><li><p>\n            The <span class=\"hue-doc-codeph\">COMPUTE STATS</span> statement does not produce any statistics for\n            columns of this data type.\n          </p></li><li><p id=\"complex_types_max_length\">\n            The maximum length of the column definition for any complex type, including\n            declarations for any nested types, is 4000 characters.\n          </p></li><li><p>\n            See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_complex_types.xml\" data-doc-anchor-id=\"complex_types_limits\">Limitations and Restrictions for Complex Types</a> for a\n            full list of limitations and associated guidelines about complex type columns.\n          </p></li></ul><p id=\"kudu_blurb\"><b>Kudu considerations:</b></p><p id=\"kudu_unsupported_data_type\"> Currently, the data types\n        <span class=\"hue-doc-codeph\">CHAR</span>, <span class=\"hue-doc-codeph\">ARRAY</span>, <span class=\"hue-doc-codeph\">MAP</span>, and\n          <span class=\"hue-doc-codeph\">STRUCT</span> cannot be used with Kudu tables.\n      </p><p id=\"example_blurb\"><b>Examples:</b></p><div class=\"hue-doc-note\" id=\"complex_type_schema_pointer\">        Many of the complex type examples refer to tables such as <span class=\"hue-doc-codeph\">CUSTOMER</span> and\n        <span class=\"hue-doc-codeph\">REGION</span> adapted from the tables used in the TPC-H benchmark. See\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_complex_types.xml\" data-doc-anchor-id=\"complex_sample_schema\">Sample Schema and Data for Experimenting with Impala Complex Types</a> for the table\n        definitions.\n      </div><p>\n        The following example shows a table with various kinds of <span class=\"hue-doc-codeph\">MAP</span> columns,\n        both at the top level and nested within other complex types.\n        Each row represents information about a specific country, with complex type fields\n        of various levels of nesting to represent different information associated\n        with the country: factual measurements such as area and population,\n        notable people in different categories, geographic features such as\n        cities, points of interest within each city, and mountains with associated facts.\n        Practice the <span class=\"hue-doc-codeph\">CREATE TABLE</span> and query notation for complex type columns\n        using empty tables, until you can visualize a complex data structure and construct corresponding SQL statements reliably.\n      </p><div class=\"hue-doc-codeblock\">create TABLE map_demo\n(\n  country_id BIGINT,\n\n-- Numeric facts about each country, looked up by name.\n-- For example, 'Area':1000, 'Population':999999.\n-- Using a MAP instead of a STRUCT because there could be\n-- a different set of facts for each country.\n  metrics MAP &lt;STRING, BIGINT&gt;,\n\n-- MAP whose value part is an ARRAY.\n-- For example, the key 'Famous Politicians' could represent an array of 10 elements,\n-- while the key 'Famous Actors' could represent an array of 20 elements.\n  notables MAP &lt;STRING, ARRAY &lt;STRING&gt;&gt;,\n\n-- MAP that is a field within a STRUCT.\n-- (The STRUCT is inside another ARRAY, because it is rare\n-- for a STRUCT to be a top-level column.)\n-- For example, city #1 might have points of interest with key 'Zoo',\n-- representing an array of 3 different zoos.\n-- City #2 might have completely different kinds of points of interest.\n-- Because the set of field names is potentially large, and most entries could be blank,\n-- a MAP makes more sense than a STRUCT to represent such a sparse data structure.\n  cities ARRAY &lt; STRUCT &lt;\n    name: STRING,\n    points_of_interest: MAP &lt;STRING, ARRAY &lt;STRING&gt;&gt;\n  &gt;&gt;,\n\n-- MAP that is an element within an ARRAY. The MAP is inside a STRUCT field to associate\n-- the mountain name with all the facts about the mountain.\n-- The \"key\" of the map (the first STRING field) represents the name of some fact whose value\n-- can be expressed as an integer, such as 'Height', 'Year First Climbed', and so on.\n  mountains ARRAY &lt; STRUCT &lt; name: STRING, facts: MAP &lt;STRING, INT &gt; &gt; &gt;\n)\nSTORED AS PARQUET;\n</div><div class=\"hue-doc-codeblock\">DESCRIBE map_demo;\n+------------+------------------------------------------------+\n| name       | type                                           |\n+------------+------------------------------------------------+\n| country_id | bigint                                         |\n| metrics    | map&lt;string,bigint&gt;                             |\n| notables   | map&lt;string,array&lt;string&gt;&gt;                      |\n| cities     | array&lt;struct&lt;                                  |\n|            |   name:string,                                 |\n|            |   points_of_interest:map&lt;string,array&lt;string&gt;&gt; |\n|            | &gt;&gt;                                             |\n| mountains  | array&lt;struct&lt;                                  |\n|            |   name:string,                                 |\n|            |   facts:map&lt;string,int&gt;                        |\n|            | &gt;&gt;                                             |\n+------------+------------------------------------------------+\n\nDESCRIBE map_demo.metrics;\n+-------+--------+\n| name  | type   |\n+-------+--------+\n| key   | string |\n| value | bigint |\n+-------+--------+\n\nDESCRIBE map_demo.notables;\n+-------+---------------+\n| name  | type          |\n+-------+---------------+\n| key   | string        |\n| value | array&lt;string&gt; |\n+-------+---------------+\n\nDESCRIBE map_demo.notables.value;\n+------+--------+\n| name | type   |\n+------+--------+\n| item | string |\n| pos  | bigint |\n+------+--------+\n\nDESCRIBE map_demo.cities;\n+------+------------------------------------------------+\n| name | type                                           |\n+------+------------------------------------------------+\n| item | struct&lt;                                        |\n|      |   name:string,                                 |\n|      |   points_of_interest:map&lt;string,array&lt;string&gt;&gt; |\n|      | &gt;                                              |\n| pos  | bigint                                         |\n+------+------------------------------------------------+\n\nDESCRIBE map_demo.cities.item.points_of_interest;\n+-------+---------------+\n| name  | type          |\n+-------+---------------+\n| key   | string        |\n| value | array&lt;string&gt; |\n+-------+---------------+\n\nDESCRIBE map_demo.cities.item.points_of_interest.value;\n+------+--------+\n| name | type   |\n+------+--------+\n| item | string |\n| pos  | bigint |\n+------+--------+\n\nDESCRIBE map_demo.mountains;\n+------+-------------------------+\n| name | type                    |\n+------+-------------------------+\n| item | struct&lt;                 |\n|      |   name:string,          |\n|      |   facts:map&lt;string,int&gt; |\n|      | &gt;                       |\n| pos  | bigint                  |\n+------+-------------------------+\n\nDESCRIBE map_demo.mountains.item.facts;\n+-------+--------+\n| name  | type   |\n+-------+--------+\n| key   | string |\n| value | int    |\n+-------+--------+\n</div><p>\n        The following example shows a table that uses a variety of data types for the <span class=\"hue-doc-codeph\">MAP</span><q>key</q> field. Typically, you use <span class=\"hue-doc-codeph\">BIGINT</span> or <span class=\"hue-doc-codeph\">STRING</span> to use\n        numeric or character-based keys without worrying about exceeding any size or length constraints.\n      </p><div class=\"hue-doc-codeblock\">CREATE TABLE map_demo_obscure\n(\n  id BIGINT,\n  m1 MAP &lt;INT, INT&gt;,\n  m2 MAP &lt;SMALLINT, INT&gt;,\n  m3 MAP &lt;TINYINT, INT&gt;,\n  m4 MAP &lt;TIMESTAMP, INT&gt;,\n  m5 MAP &lt;BOOLEAN, INT&gt;,\n  m6 MAP &lt;CHAR(5), INT&gt;,\n  m7 MAP &lt;VARCHAR(25), INT&gt;,\n  m8 MAP &lt;FLOAT, INT&gt;,\n  m9 MAP &lt;DOUBLE, INT&gt;,\n  m10 MAP &lt;DECIMAL(12,2), INT&gt;\n)\nSTORED AS PARQUET;\n</div><div class=\"hue-doc-codeblock\">CREATE TABLE celebrities (name STRING, birth_year MAP &lt; STRING, SMALLINT &gt;) STORED AS PARQUET;\n-- A typical row might represent values with 2 different birth years, such as:\n-- (\"Joe Movie Star\", { \"real\": 1972, \"claimed\": 1977 })\n\nCREATE TABLE countries (name STRING, famous_leaders MAP &lt; INT, STRING &gt;) STORED AS PARQUET;\n-- A typical row might represent values with different leaders, with key values corresponding to their numeric sequence, such as:\n-- (\"United States\", { 1: \"George Washington\", 3: \"Thomas Jefferson\", 16: \"Abraham Lincoln\" })\n\nCREATE TABLE airlines (name STRING, special_meals MAP &lt; STRING, MAP &lt; STRING, STRING &gt; &gt;) STORED AS PARQUET;\n-- A typical row might represent values with multiple kinds of meals, each with several components:\n-- (\"Elegant Airlines\",\n--   {\n--     \"vegetarian\": { \"breakfast\": \"pancakes\", \"snack\": \"cookies\", \"dinner\": \"rice pilaf\" },\n--     \"gluten free\": { \"breakfast\": \"oatmeal\", \"snack\": \"fruit\", \"dinner\": \"chicken\" }\n--   } )\n</div><p id=\"related_info\"><b>Related information:</b></p><p><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_complex_types.xml\" data-doc-anchor-id=\"complex_types\">Complex Types (Impala 2.3 or higher only)</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_array.xml\" data-doc-anchor-id=\"array\">ARRAY Complex Type (Impala 2.3 or higher only)</a>,\n        <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_struct.xml\" data-doc-anchor-id=\"struct\">STRUCT Complex Type (Impala 2.3 or higher only)</a></p></div></div></div>","title":"MAP Complex Type (Impala 2.3 or higher only)"}