{"body":"<div><div><div class=\"hue-doc-title\">Impala Date and Time Functions</div><div><p>\n      The underlying Impala data type for date and time data is\n      <span class=\"hue-doc-codeph\"><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP</a></span>, which has both a date and a\n      time portion. Functions that extract a single field, such as <span class=\"hue-doc-codeph\">hour()</span> or\n      <span class=\"hue-doc-codeph\">minute()</span>, typically return an integer value. Functions that format the date portion, such as\n      <span class=\"hue-doc-codeph\">date_add()</span> or <span class=\"hue-doc-codeph\">to_date()</span>, typically return a string value.\n    </p><p>\n      You can also adjust a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value by adding or subtracting an <span class=\"hue-doc-codeph\">INTERVAL</span>\n      expression. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details. <span class=\"hue-doc-codeph\">INTERVAL</span>\n      expressions are also allowed as the second argument for the <span class=\"hue-doc-codeph\">date_add()</span> and\n      <span class=\"hue-doc-codeph\">date_sub()</span> functions, rather than integers.\n    </p><p>\n      Some of these functions are affected by the setting of the\n      <span class=\"hue-doc-codeph\">--use_local_tz_for_unix_timestamp_conversions</span> startup flag for the\n      <span class=\"hue-doc-cmdname\">impalad</span> daemon. This setting is off by default, meaning that\n      functions such as <span class=\"hue-doc-codeph\">from_unixtime()</span> and <span class=\"hue-doc-codeph\">unix_timestamp()</span>\n      consider the input values to always represent the UTC time zone.\n      This setting also applies when you <span class=\"hue-doc-codeph\">CAST()</span> a <span class=\"hue-doc-codeph\">BIGINT</span>\n      value to <span class=\"hue-doc-codeph\">TIMESTAMP</span>, or a <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n      value to <span class=\"hue-doc-codeph\">BIGINT</span>.\n      When this setting is enabled, these functions and operations convert to and from\n      values representing the local time zone.\n      See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details about how\n      Impala handles time zone considerations for the <span class=\"hue-doc-codeph\">TIMESTAMP</span> data type.\n    </p><p><b>Function reference:</b></p><p>\n      Impala supports the following data and time functions:\n    </p><dl><dt><span class=\"hue-doc-codeph\">add_months(timestamp date, int months)</span>, <span class=\"hue-doc-codeph\">add_months(timestamp date, bigint\n          months)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of months.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Usage notes:</b></p><p>\n            Same as <span class=\"hue-doc-codeph\"><a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_datetime_functions.xml\" data-doc-anchor-id=\"datetime_functions/months_add\">months_add()</a></span>.\n            Available in Impala 1.4 and higher. For\n            compatibility when porting code with vendor extensions.\n          </p><p><b>Examples:</b></p><p>\n            The following examples demonstrate adding months to construct the same\n            day of the month in a different month; how if the current day of the month\n            does not exist in the target month, the last day of that month is substituted;\n            and how a negative argument produces a return value from a previous month.\n          </p><div class=\"hue-doc-codeblock\">\nselect now(), add_months(now(), 2);\n+-------------------------------+-------------------------------+\n| now()                         | add_months(now(), 2)          |\n+-------------------------------+-------------------------------+\n| 2016-05-31 10:47:00.429109000 | 2016-07-31 10:47:00.429109000 |\n+-------------------------------+-------------------------------+\n\nselect now(), add_months(now(), 1);\n+-------------------------------+-------------------------------+\n| now()                         | add_months(now(), 1)          |\n+-------------------------------+-------------------------------+\n| 2016-05-31 10:47:14.540226000 | 2016-06-30 10:47:14.540226000 |\n+-------------------------------+-------------------------------+\n\nselect now(), add_months(now(), -1);\n+-------------------------------+-------------------------------+\n| now()                         | add_months(now(), -1)         |\n+-------------------------------+-------------------------------+\n| 2016-05-31 10:47:31.732298000 | 2016-04-30 10:47:31.732298000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">adddate(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">adddate(timestamp startdate, bigint\n          days)</span>,\n        </dt><dd><b>Purpose:</b> Adds a specified number of days to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. Similar to\n          <span class=\"hue-doc-codeph\">date_add()</span>, but starts with an actual <span class=\"hue-doc-codeph\">TIMESTAMP</span> value instead of a\n          string that is converted to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following examples show how to add a number of days to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n            The number of days can also be negative, which gives the same effect as the <span class=\"hue-doc-codeph\">subdate()</span> function.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, adddate(now(), 30) as now_plus_30;\n+-------------------------------+-------------------------------+\n| right_now                     | now_plus_30                   |\n+-------------------------------+-------------------------------+\n| 2016-05-20 10:23:08.640111000 | 2016-06-19 10:23:08.640111000 |\n+-------------------------------+-------------------------------+\n\nselect now() as right_now, adddate(now(), -15) as now_minus_15;\n+-------------------------------+-------------------------------+\n| right_now                     | now_minus_15                  |\n+-------------------------------+-------------------------------+\n| 2016-05-20 10:23:38.214064000 | 2016-05-05 10:23:38.214064000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">current_timestamp()</span></dt><dd><b>Purpose:</b> Alias for the <span class=\"hue-doc-codeph\">now()</span> function.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now(), current_timestamp();\n+-------------------------------+-------------------------------+\n| now()                         | current_timestamp()           |\n+-------------------------------+-------------------------------+\n| 2016-05-19 16:10:14.237849000 | 2016-05-19 16:10:14.237849000 |\n+-------------------------------+-------------------------------+\n\nselect current_timestamp() as right_now,\n  current_timestamp() + interval 3 hours as in_three_hours;\n+-------------------------------+-------------------------------+\n| right_now                     | in_three_hours                |\n+-------------------------------+-------------------------------+\n| 2016-05-19 16:13:20.017117000 | 2016-05-19 19:13:20.017117000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">date_add(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">date_add(timestamp startdate,\n          <span class=\"hue-doc-varname\">interval_expression</span>)</span></dt><dd><b>Purpose:</b> Adds a specified number of days to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          \n          With an <span class=\"hue-doc-codeph\">INTERVAL</span>\n          expression as the second argument, you can calculate a delta value using other units such as weeks,\n          years, hours, seconds, and so on; see <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following example shows the simplest usage, of adding a specified number of days\n            to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value:\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, date_add(now(), 7) as next_week;\n+-------------------------------+-------------------------------+\n| right_now                     | next_week                     |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:03:48.687055000 | 2016-05-27 11:03:48.687055000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following examples show the shorthand notation of an <span class=\"hue-doc-codeph\">INTERVAL</span>\n            expression, instead of specifying the precise number of days.\n            The <span class=\"hue-doc-codeph\">INTERVAL</span> notation also lets you work with units smaller than\n            a single day.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, date_add(now(), interval 3 weeks) as in_3_weeks;\n+-------------------------------+-------------------------------+\n| right_now                     | in_3_weeks                    |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:05:39.173331000 | 2016-06-10 11:05:39.173331000 |\n+-------------------------------+-------------------------------+\n\nselect now() as right_now, date_add(now(), interval 6 hours) as in_6_hours;\n+-------------------------------+-------------------------------+\n| right_now                     | in_6_hours                    |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:13:51.492536000 | 2016-05-20 17:13:51.492536000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            Like all date/time functions that deal with months, <span class=\"hue-doc-codeph\">date_add()</span>\n            handles nonexistent dates past the end of a month by setting the date to the\n            last day of the month. The following example shows how the nonexistent date\n            April 31st is normalized to April 30th:\n          </p><div class=\"hue-doc-codeblock\">\nselect date_add(cast('2016-01-31' as timestamp), interval 3 months) as 'april_31st';\n+---------------------+\n| april_31st          |\n+---------------------+\n| 2016-04-30 00:00:00 |\n+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">date_part(string, timestamp)</span></dt><dd><b>Purpose:</b> Similar to\n          <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_datetime_functions.xml\" data-doc-anchor-id=\"datetime_functions/extract\"><span class=\"hue-doc-codeph\">EXTRACT()</span></a>,\n          with the argument order reversed. Supports the same date and time units as <span class=\"hue-doc-codeph\">EXTRACT()</span>.\n          For compatibility with SQL code containing vendor extensions.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect date_part('year',now()) as current_year;\n+--------------+\n| current_year |\n+--------------+\n| 2016         |\n+--------------+\n\nselect date_part('hour',now()) as hour_of_day;\n+-------------+\n| hour_of_day |\n+-------------+\n| 11          |\n+-------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">date_sub(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">date_sub(timestamp startdate,\n          <span class=\"hue-doc-varname\">interval_expression</span>)</span></dt><dd><b>Purpose:</b> Subtracts a specified number of days from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          \n          With an\n          <span class=\"hue-doc-codeph\">INTERVAL</span> expression as the second argument, you can calculate a delta value using other\n          units such as weeks, years, hours, seconds, and so on; see <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a>\n          for details.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following example shows the simplest usage, of subtracting a specified number of days\n            from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value:\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, date_sub(now(), 7) as last_week;\n+-------------------------------+-------------------------------+\n| right_now                     | last_week                     |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:21:30.491011000 | 2016-05-13 11:21:30.491011000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following examples show the shorthand notation of an <span class=\"hue-doc-codeph\">INTERVAL</span>\n            expression, instead of specifying the precise number of days.\n            The <span class=\"hue-doc-codeph\">INTERVAL</span> notation also lets you work with units smaller than\n            a single day.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, date_sub(now(), interval 3 weeks) as 3_weeks_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 3_weeks_ago                   |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:23:05.176953000 | 2016-04-29 11:23:05.176953000 |\n+-------------------------------+-------------------------------+\n\nselect now() as right_now, date_sub(now(), interval 6 hours) as 6_hours_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 6_hours_ago                   |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:23:35.439631000 | 2016-05-20 05:23:35.439631000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            Like all date/time functions that deal with months, <span class=\"hue-doc-codeph\">date_add()</span>\n            handles nonexistent dates past the end of a month by setting the date to the\n            last day of the month. The following example shows how the nonexistent date\n            April 31st is normalized to April 30th:\n          </p><div class=\"hue-doc-codeblock\">\nselect date_sub(cast('2016-05-31' as timestamp), interval 1 months) as 'april_31st';\n+---------------------+\n| april_31st          |\n+---------------------+\n| 2016-04-30 00:00:00 |\n+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">date_trunc(string unit, timestamp)</span></dt><dd><b>Purpose:</b> Truncates a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value to the specified precision.\n          <p><b>Unit argument:</b> The <span class=\"hue-doc-codeph\">unit</span> argument value for truncating\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> values is not case-sensitive. This argument string\n            can be one of:\n          </p><ul><li>microseconds</li><li>milliseconds</li><li>second</li><li>minute</li><li>hour</li><li>day</li><li>week</li><li>month</li><li>year</li><li>decade</li><li>century</li><li>millennium</li></ul><p>\n            For example, calling <span class=\"hue-doc-codeph\">date_trunc('hour',ts)</span> truncates\n            <span class=\"hue-doc-codeph\">ts</span> to the beginning of the corresponding hour, with\n            all minutes, seconds, milliseconds, and so on set to zero. Calling\n            <span class=\"hue-doc-codeph\">date_trunc('milliseconds',ts)</span> truncates\n            <span class=\"hue-doc-codeph\">ts</span> to the beginning of the corresponding millisecond,\n            with all microseconds and nanoseconds set to zero.\n          </p><div class=\"hue-doc-note\">\n            The sub-second units are specified in plural form. All units representing\n            one second or more are specified in singular form.\n          </div><p><b>Added in:</b>Impala 2.11.0</p><p><b>Usage notes:</b></p><p>\n            Although this function is similar to calling <span class=\"hue-doc-codeph\">TRUNC()</span>\n            with a <span class=\"hue-doc-codeph\">TIMESTAMP</span> argument, the order of arguments\n            and the recognized units are different between <span class=\"hue-doc-codeph\">TRUNC()</span>\n            and <span class=\"hue-doc-codeph\">DATE_TRUNC()</span>. Therefore, these functions are not\n            interchangeable.\n          </p><p>\n            This function is typically used in <span class=\"hue-doc-codeph\">GROUP BY</span>\n            queries to aggregate results from the same hour, day, week, month, quarter, and so on.\n            You can also use this function in an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> into a\n            partitioned table to divide <span class=\"hue-doc-codeph\">TIMESTAMP</span> values into the correct partition.\n          </p><p>\n            Because the return value is a <span class=\"hue-doc-codeph\">TIMESTAMP</span>, if you cast the result of\n            <span class=\"hue-doc-codeph\">DATE_TRUNC()</span> to <span class=\"hue-doc-codeph\">STRING</span>, you will often see zeroed-out portions such as\n            <span class=\"hue-doc-codeph\">00:00:00</span> in the time field. If you only need the individual units such as hour, day,\n            month, or year, use the <span class=\"hue-doc-codeph\">EXTRACT()</span> function instead. If you need the individual units\n            from a truncated <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, run the <span class=\"hue-doc-codeph\">TRUNCATE()</span> function on the\n            original value, then run <span class=\"hue-doc-codeph\">EXTRACT()</span> on the result.\n          </p><p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following examples show how to call <span class=\"hue-doc-codeph\">DATE_TRUNC()</span> with different unit values:\n          </p><div class=\"hue-doc-codeblock\">\nselect now(), date_trunc('second', now());\n+-------------------------------+-----------------------------------+\n| now()                         | date_trunc('second', now())       |\n+-------------------------------+-----------------------------------+\n| 2017-12-05 13:58:04.565403000 | 2017-12-05 13:58:04               |\n+-------------------------------+-----------------------------------+\n\nselect now(), date_trunc('hour', now());\n+-------------------------------+---------------------------+\n| now()                         | date_trunc('hour', now()) |\n+-------------------------------+---------------------------+\n| 2017-12-05 13:59:01.884459000 | 2017-12-05 13:00:00       |\n+-------------------------------+---------------------------+\n\nselect now(), date_trunc('millennium', now());\n+-------------------------------+---------------------------------+\n| now()                         | date_trunc('millennium', now()) |\n+-------------------------------+---------------------------------+\n| 2017-12-05 14:00:30.296812000 | 2000-01-01 00:00:00             |\n+-------------------------------+---------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">datediff(timestamp enddate, timestamp startdate)</span></dt><dd><b>Purpose:</b> Returns the number of days between two <span class=\"hue-doc-codeph\">TIMESTAMP</span> values.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Usage notes:</b></p><p>\n            If the first argument represents a later date than the second argument,\n            the return value is positive. If both arguments represent the same date,\n            the return value is zero. The time portions of the <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            values are irrelevant. For example, 11:59 PM on one day and 12:01 on the next\n            day represent a <span class=\"hue-doc-codeph\">datediff()</span> of -1 because the date/time values\n            represent different days, even though the <span class=\"hue-doc-codeph\">TIMESTAMP</span> values differ by only 2 minutes.\n          </p><p><b>Examples:</b></p><p>\n            The following example shows how comparing a <q>late</q> value with\n            an <q>earlier</q> value produces a positive number. In this case,\n            the result is (365 * 5) + 1, because one of the intervening years is\n            a leap year.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, datediff(now() + interval 5 years, now()) as in_5_years;\n+-------------------------------+------------+\n| right_now                     | in_5_years |\n+-------------------------------+------------+\n| 2016-05-20 13:43:55.873826000 | 1826       |\n+-------------------------------+------------+\n</div><p>\n            The following examples show how the return value represent the number of days\n            between the associated dates, regardless of the time portion of each <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n            For example, different times on the same day produce a <span class=\"hue-doc-codeph\">date_diff()</span> of 0,\n            regardless of which one is earlier or later. But if the arguments represent different dates,\n            <span class=\"hue-doc-codeph\">date_diff()</span> returns a non-zero integer value, regardless of the time portions\n            of the dates.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, datediff(now(), now() + interval 4 hours) as in_4_hours;\n+-------------------------------+------------+\n| right_now                     | in_4_hours |\n+-------------------------------+------------+\n| 2016-05-20 13:42:05.302747000 | 0          |\n+-------------------------------+------------+\n\nselect now() as right_now, datediff(now(), now() - interval 4 hours) as 4_hours_ago;\n+-------------------------------+-------------+\n| right_now                     | 4_hours_ago |\n+-------------------------------+-------------+\n| 2016-05-20 13:42:21.134958000 | 0           |\n+-------------------------------+-------------+\n\nselect now() as right_now, datediff(now(), now() + interval 12 hours) as in_12_hours;\n+-------------------------------+-------------+\n| right_now                     | in_12_hours |\n+-------------------------------+-------------+\n| 2016-05-20 13:42:44.765873000 | -1          |\n+-------------------------------+-------------+\n\nselect now() as right_now, datediff(now(), now() - interval 18 hours) as 18_hours_ago;\n+-------------------------------+--------------+\n| right_now                     | 18_hours_ago |\n+-------------------------------+--------------+\n| 2016-05-20 13:54:38.829827000 | 1            |\n+-------------------------------+--------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">day(timestamp date), <span class=\"hue-doc-ph\">dayofmonth(timestamp date)</span></span></dt><dd><b>Purpose:</b> Returns the day field from the date portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          The value represents the day of the month, therefore is in the range 1-31, or less for\n          months without 31 days.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><p>\n            The following examples show how the day value corresponds to the day\n            of the month, resetting back to 1 at the start of each month.\n          </p><div class=\"hue-doc-codeblock\">\nselect now(), day(now());\n+-------------------------------+------------+\n| now()                         | day(now()) |\n+-------------------------------+------------+\n| 2016-05-20 15:01:51.042185000 | 20         |\n+-------------------------------+------------+\n\nselect now() + interval 11 days, day(now() + interval 11 days);\n+-------------------------------+-------------------------------+\n| now() + interval 11 days      | day(now() + interval 11 days) |\n+-------------------------------+-------------------------------+\n| 2016-05-31 15:05:56.843139000 | 31                            |\n+-------------------------------+-------------------------------+\n\nselect now() + interval 12 days, day(now() + interval 12 days);\n+-------------------------------+-------------------------------+\n| now() + interval 12 days      | day(now() + interval 12 days) |\n+-------------------------------+-------------------------------+\n| 2016-06-01 15:06:05.074236000 | 1                             |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following examples show how the day value is <span class=\"hue-doc-codeph\">NULL</span>\n            for nonexistent dates or misformatted date strings.\n          </p><div class=\"hue-doc-codeblock\">\n-- 2016 is a leap year, so it has a Feb. 29.\nselect day('2016-02-29');\n+-------------------+\n| day('2016-02-29') |\n+-------------------+\n| 29                |\n+-------------------+\n\n-- 2015 is not a leap year, so Feb. 29 is nonexistent.\nselect day('2015-02-29');\n+-------------------+\n| day('2015-02-29') |\n+-------------------+\n| NULL              |\n+-------------------+\n\n-- A string that does not match the expected YYYY-MM-DD format\n-- produces an invalid TIMESTAMP, causing day() to return NULL.\nselect day('2016-02-028');\n+--------------------+\n| day('2016-02-028') |\n+--------------------+\n| NULL               |\n+--------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">dayname(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the day field from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, converted to the string\n          corresponding to that day name. The range of return values is <span class=\"hue-doc-codeph\">'Sunday'</span> to\n          <span class=\"hue-doc-codeph\">'Saturday'</span>. Used in report-generating queries, as an alternative to calling\n          <span class=\"hue-doc-codeph\">dayofweek()</span> and turning that numeric return value into a string using a\n          <span class=\"hue-doc-codeph\">CASE</span> expression.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p><p><b>Examples:</b></p><p>\n            The following examples show the day name associated with\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> values representing different days.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  dayofweek(now()) as todays_day_of_week,\n  dayname(now()) as todays_day_name;\n+-------------------------------+--------------------+-----------------+\n| right_now                     | todays_day_of_week | todays_day_name |\n+-------------------------------+--------------------+-----------------+\n| 2016-05-31 10:57:03.953670000 | 3                  | Tuesday         |\n+-------------------------------+--------------------+-----------------+\n\nselect now() + interval 1 day as tomorrow,\n  dayname(now() + interval 1 day) as tomorrows_day_name;\n+-------------------------------+--------------------+\n| tomorrow                      | tomorrows_day_name |\n+-------------------------------+--------------------+\n| 2016-06-01 10:58:53.945761000 | Wednesday          |\n+-------------------------------+--------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">dayofweek(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the day field from the date portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span>, corresponding to the day of\n          the week. The range of return values is 1 (Sunday) to 7 (Saturday).\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  dayofweek(now()) as todays_day_of_week,\n  dayname(now()) as todays_day_name;\n+-------------------------------+--------------------+-----------------+\n| right_now                     | todays_day_of_week | todays_day_name |\n+-------------------------------+--------------------+-----------------+\n| 2016-05-31 10:57:03.953670000 | 3                  | Tuesday         |\n+-------------------------------+--------------------+-----------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">dayofyear(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the day field from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, corresponding to the day\n          of the year. The range of return values is 1 (January 1) to 366 (December 31 of a leap year).\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><p>\n            The following examples show return values from the\n            <span class=\"hue-doc-codeph\">dayofyear()</span> function. The same date\n            in different years returns a different day number\n            for all dates after February 28,\n            because 2016 is a leap year while 2015 is not a leap year.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  dayofyear(now()) as today_day_of_year;\n+-------------------------------+-------------------+\n| right_now                     | today_day_of_year |\n+-------------------------------+-------------------+\n| 2016-05-31 11:05:48.314932000 | 152               |\n+-------------------------------+-------------------+\n\nselect now() - interval 1 year as last_year,\n  dayofyear(now() - interval 1 year) as year_ago_day_of_year;\n+-------------------------------+----------------------+\n| last_year                     | year_ago_day_of_year |\n+-------------------------------+----------------------+\n| 2015-05-31 11:07:03.733689000 | 151                  |\n+-------------------------------+----------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">days_add(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">days_add(timestamp startdate, bigint\n          days)</span></dt><dd><b>Purpose:</b> Adds a specified number of days to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. Similar to\n          <span class=\"hue-doc-codeph\">date_add()</span>, but starts with an actual <span class=\"hue-doc-codeph\">TIMESTAMP</span> value instead of a\n          string that is converted to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, days_add(now(), 31) as 31_days_later;\n+-------------------------------+-------------------------------+\n| right_now                     | 31_days_later                 |\n+-------------------------------+-------------------------------+\n| 2016-05-31 11:12:32.216764000 | 2016-07-01 11:12:32.216764000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">days_sub(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">days_sub(timestamp startdate, bigint\n          days)</span></dt><dd><b>Purpose:</b> Subtracts a specified number of days from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. Similar to\n          <span class=\"hue-doc-codeph\">date_sub()</span>, but starts with an actual <span class=\"hue-doc-codeph\">TIMESTAMP</span> value instead of a\n          string that is converted to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, days_sub(now(), 31) as 31_days_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 31_days_ago                   |\n+-------------------------------+-------------------------------+\n| 2016-05-31 11:13:42.163905000 | 2016-04-30 11:13:42.163905000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">extract(timestamp, string unit)</span>, <span class=\"hue-doc-codeph\">extract(unit FROM timestamp)</span></dt><dd><b>Purpose:</b> Returns one of the numeric date or time fields from a\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Unit argument:</b> The <span class=\"hue-doc-codeph\">unit</span> string can be one of\n              <span class=\"hue-doc-codeph\">epoch</span>, <span class=\"hue-doc-codeph\">year</span>,\n              <span class=\"hue-doc-codeph\">quarter</span>, <span class=\"hue-doc-codeph\">month</span>,\n              <span class=\"hue-doc-codeph\">day</span>, <span class=\"hue-doc-codeph\">hour</span>,\n              <span class=\"hue-doc-codeph\">minute</span>, <span class=\"hue-doc-codeph\">second</span>, or\n              <span class=\"hue-doc-codeph\">millisecond</span>. This argument value is\n            case-insensitive.\n          </p><p> In Impala 2.0 and higher, you can use special syntax\n            rather than a regular function call, for compatibility with code\n            that uses the SQL-99 format with the <span class=\"hue-doc-codeph\">FROM</span> keyword.\n            With this style, the unit names are identifiers rather than\n              <span class=\"hue-doc-codeph\">STRING</span> literals. For example, the following calls\n            are both equivalent:\n            <div class=\"hue-doc-codeblock\">extract(year from now());\nextract(now(), \"year\");\n</div></p><p><b>Usage notes:</b></p><p> Typically used in <span class=\"hue-doc-codeph\">GROUP BY</span> queries to arrange\n            results by hour, day, month, and so on. You can also use this\n            function in an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> into a partitioned\n            table to split up <span class=\"hue-doc-codeph\">TIMESTAMP</span> values into individual\n            parts, if the partitioned table has separate partition key columns\n            representing year, month, day, and so on. If you need to divide by\n            more complex units of time, such as by week or by quarter, use the\n              <span class=\"hue-doc-codeph\">TRUNC()</span> function instead. </p><p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  extract(year from now()) as this_year,\n  extract(month from now()) as this_month;\n+-------------------------------+-----------+------------+\n| right_now                     | this_year | this_month |\n+-------------------------------+-----------+------------+\n| 2016-05-31 11:18:43.310328000 | 2016      | 5          |\n+-------------------------------+-----------+------------+\n\nselect now() as right_now,\n  extract(day from now()) as this_day,\n  extract(hour from now()) as this_hour;\n+-------------------------------+----------+-----------+\n| right_now                     | this_day | this_hour |\n+-------------------------------+----------+-----------+\n| 2016-05-31 11:19:24.025303000 | 31       | 11        |\n+-------------------------------+----------+-----------+\n</div></dd><dt><span class=\"hue-doc-codeph\">from_timestamp(datetime timestamp, pattern string)</span></dt><dd><b>Purpose:</b> Converts a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value into a\n          string representing the same value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b></p><p>\n            The <span class=\"hue-doc-codeph\">from_timestamp()</span> function provides a flexible way to convert <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            values into arbitrary string formats for reporting purposes.\n          </p><p>\n            Because Impala implicitly converts string values into <span class=\"hue-doc-codeph\">TIMESTAMP</span>, you can\n            pass date/time values represented as strings (in the standard <span class=\"hue-doc-codeph\">yyyy-MM-dd HH:mm:ss.SSS</span> format)\n            to this function. The result is a string using different separator characters, order of fields, spelled-out month\n            names, or other variation of the date/time string representation.\n          </p><p>\n            The allowed tokens for the pattern string are the same as for the <span class=\"hue-doc-codeph\">from_unixtime()</span> function.\n          </p><p><b>Examples:</b></p><p>\n            The following examples show different ways to format a <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            value as a string:\n          </p><div class=\"hue-doc-codeblock\">\n-- Reformat arbitrary TIMESTAMP value.\nselect from_timestamp(now(), 'yyyy/MM/dd');\n+-------------------------------------+\n| from_timestamp(now(), 'yyyy/mm/dd') |\n+-------------------------------------+\n| 2017/10/01                          |\n+-------------------------------------+\n\n-- Reformat string literal representing date/time.\nselect from_timestamp('1984-09-25', 'yyyy/MM/dd');\n+--------------------------------------------+\n| from_timestamp('1984-09-25', 'yyyy/mm/dd') |\n+--------------------------------------------+\n| 1984/09/25                                 |\n+--------------------------------------------+\n\n-- Alternative format for reporting purposes.\nselect from_timestamp('1984-09-25 16:45:30.125', 'MMM dd, yyyy HH:mm:ss.SSS');\n+------------------------------------------------------------------------+\n| from_timestamp('1984-09-25 16:45:30.125', 'mmm dd, yyyy hh:mm:ss.sss') |\n+------------------------------------------------------------------------+\n| Sep 25, 1984 16:45:30.125                                              |\n+------------------------------------------------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">from_unixtime(bigint unixtime[, string format])</span></dt><dd><b>Purpose:</b> Converts the number of seconds from the Unix epoch to the specified time into a string in\n          the local time zone.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p><p>\n        In Impala 2.2.0 and higher, built-in functions that accept or return integers representing <span class=\"hue-doc-codeph\">TIMESTAMP</span> values\n        use the <span class=\"hue-doc-codeph\">BIGINT</span> type for parameters and return values, rather than <span class=\"hue-doc-codeph\">INT</span>.\n        This change lets the date and time functions avoid an overflow error that would otherwise occur\n        on January 19th, 2038 (known as the\n        <a class=\"hue-doc-external-link\" href=\"http://en.wikipedia.org/wiki/Year_2038_problem\" target=\"_blank\"><q>Year 2038 problem</q> or <q>Y2K38 problem</q></a>).\n        This change affects the <span class=\"hue-doc-codeph\">from_unixtime()</span> and <span class=\"hue-doc-codeph\">unix_timestamp()</span> functions.\n        You might need to change application code that interacts with these functions, change the types of\n        columns that store the return values, or add <span class=\"hue-doc-codeph\">CAST()</span> calls to SQL statements that\n        call these functions.\n      </p><p><b>Usage notes:</b></p><p>\n            The format string accepts the variations allowed for the <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            data type: date plus time, date by itself, time by itself, and optional fractional seconds for the\n            time. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details.\n          </p><p>\n            Currently, the format string is case-sensitive, especially to distinguish <span class=\"hue-doc-codeph\">m</span> for\n            minutes and <span class=\"hue-doc-codeph\">M</span> for months. In Impala 1.3 and later, you can switch the order of\n            elements, use alternative separator characters, and use a different number of placeholders for each\n            unit. Adding more instances of <span class=\"hue-doc-codeph\">y</span>, <span class=\"hue-doc-codeph\">d</span>, <span class=\"hue-doc-codeph\">H</span>, and so on\n            produces output strings zero-padded to the requested number of characters. The exception is\n            <span class=\"hue-doc-codeph\">M</span> for months, where <span class=\"hue-doc-codeph\">M</span> produces a non-padded value such as\n            <span class=\"hue-doc-codeph\">3</span>, <span class=\"hue-doc-codeph\">MM</span> produces a zero-padded value such as <span class=\"hue-doc-codeph\">03</span>,\n            <span class=\"hue-doc-codeph\">MMM</span> produces an abbreviated month name such as <span class=\"hue-doc-codeph\">Mar</span>, and sequences of\n            4 or more <span class=\"hue-doc-codeph\">M</span> are not allowed. A date string including all fields could be\n            <span class=\"hue-doc-codeph\">\"yyyy-MM-dd HH:mm:ss.SSSSSS\"</span>, <span class=\"hue-doc-codeph\">\"dd/MM/yyyy HH:mm:ss.SSSSSS\"</span>,\n            <span class=\"hue-doc-codeph\">\"MMM dd, yyyy HH.mm.ss (SSSSSS)\"</span> or other combinations of placeholders and separator\n            characters.\n          </p><p>\n        The way this function deals with time zones when converting to or from <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n        values is affected by the <span class=\"hue-doc-codeph\">--use_local_tz_for_unix_timestamp_conversions</span> startup flag for the\n        <span class=\"hue-doc-cmdname\">impalad</span> daemon. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details about\n        how Impala handles time zone considerations for the <span class=\"hue-doc-codeph\">TIMESTAMP</span> data type.\n      </p><div class=\"hue-doc-note\"><p>\n              The more flexible format strings allowed with the built-in functions do not change the rules about\n              using <span class=\"hue-doc-codeph\">CAST()</span> to convert from a string to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. Strings\n              being converted through <span class=\"hue-doc-codeph\">CAST()</span> must still have the elements in the specified order and use the specified delimiter\n              characters, as described in <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a>.\n            </p></div><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">select from_unixtime(1392394861,\"yyyy-MM-dd HH:mm:ss.SSSS\");\n+-------------------------------------------------------+\n| from_unixtime(1392394861, 'yyyy-mm-dd hh:mm:ss.ssss') |\n+-------------------------------------------------------+\n| 2014-02-14 16:21:01.0000                              |\n+-------------------------------------------------------+\n\nselect from_unixtime(1392394861,\"yyyy-MM-dd\");\n+-----------------------------------------+\n| from_unixtime(1392394861, 'yyyy-mm-dd') |\n+-----------------------------------------+\n| 2014-02-14                              |\n+-----------------------------------------+\n\nselect from_unixtime(1392394861,\"HH:mm:ss.SSSS\");\n+--------------------------------------------+\n| from_unixtime(1392394861, 'hh:mm:ss.ssss') |\n+--------------------------------------------+\n| 16:21:01.0000                              |\n+--------------------------------------------+\n\nselect from_unixtime(1392394861,\"HH:mm:ss\");\n+---------------------------------------+\n| from_unixtime(1392394861, 'hh:mm:ss') |\n+---------------------------------------+\n| 16:21:01                              |\n+---------------------------------------+</div><p><span class=\"hue-doc-codeph\">unix_timestamp()</span> and <span class=\"hue-doc-codeph\">from_unixtime()</span> are often used in combination to\n        convert a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value into a particular string format. For example:\n<div class=\"hue-doc-codeblock\">select from_unixtime(unix_timestamp(now() + interval 3 days),\n  'yyyy/MM/dd HH:mm') as yyyy_mm_dd_hh_mm;\n+------------------+\n| yyyy_mm_dd_hh_mm |\n+------------------+\n| 2016/06/03 11:38 |\n+------------------+\n</div></p></dd><dt><span class=\"hue-doc-codeph\">from_utc_timestamp(timestamp, string timezone)</span></dt><dd><b>Purpose:</b> Converts a specified UTC timestamp value into the appropriate value for a specified time\n          zone.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Usage notes:</b> Often used to translate UTC time zone data stored in a table back to the local\n            date and time for reporting. The opposite of the <span class=\"hue-doc-codeph\">to_utc_timestamp()</span> function.\n          </p><p>\n        To determine the time zone of the server you are connected to, in Impala 2.3 and\n        higher you can call the <span class=\"hue-doc-codeph\">timeofday()</span> function, which includes the time zone\n        specifier in its return value. Remember that with cloud computing, the server you interact\n        with might be in a different time zone than you are, or different sessions might connect to\n        servers in different time zones, or a cluster might include servers in more than one time zone.\n      </p><p><b>Examples:</b></p><p>\n            See discussion of time zones in <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a>\n            for information about using this function for conversions between the local time zone and UTC.\n          </p><p>\n            The following example shows how when <span class=\"hue-doc-codeph\">TIMESTAMP</span> values representing the UTC time zone\n            are stored in a table, a query can display the equivalent local date and time for a different time zone.\n          </p><div class=\"hue-doc-codeblock\">\nwith t1 as (select cast('2016-06-02 16:25:36.116143000' as timestamp) as utc_datetime)\n  select utc_datetime as 'Date/time in Greenwich UK',\n    from_utc_timestamp(utc_datetime, 'PDT')\n      as 'Equivalent in California USA'\n  from t1;\n+-------------------------------+-------------------------------+\n| date/time in greenwich uk     | equivalent in california usa  |\n+-------------------------------+-------------------------------+\n| 2016-06-02 16:25:36.116143000 | 2016-06-02 09:25:36.116143000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following example shows that for a date and time when daylight savings\n            is in effect (<span class=\"hue-doc-codeph\">PDT</span>), the UTC time\n            is 7 hours ahead of the local California time; while when daylight savings\n            is not in effect (<span class=\"hue-doc-codeph\">PST</span>), the UTC time is 8 hours ahead of\n            the local California time.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as local_datetime,\n  to_utc_timestamp(now(), 'PDT') as utc_datetime;\n+-------------------------------+-------------------------------+\n| local_datetime                | utc_datetime                  |\n+-------------------------------+-------------------------------+\n| 2016-05-31 11:50:02.316883000 | 2016-05-31 18:50:02.316883000 |\n+-------------------------------+-------------------------------+\n\nselect '2016-01-05' as local_datetime,\n  to_utc_timestamp('2016-01-05', 'PST') as utc_datetime;\n+----------------+---------------------+\n| local_datetime | utc_datetime        |\n+----------------+---------------------+\n| 2016-01-05     | 2016-01-05 08:00:00 |\n+----------------+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">hour(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the hour field from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> field.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, hour(now()) as current_hour;\n+-------------------------------+--------------+\n| right_now                     | current_hour |\n+-------------------------------+--------------+\n| 2016-06-01 14:14:12.472846000 | 14           |\n+-------------------------------+--------------+\n\nselect now() + interval 12 hours as 12_hours_from_now,\n  hour(now() + interval 12 hours) as hour_in_12_hours;\n+-------------------------------+-------------------+\n| 12_hours_from_now             | hour_in_12_hours  |\n+-------------------------------+-------------------+\n| 2016-06-02 02:15:32.454750000 | 2                 |\n+-------------------------------+-------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">hours_add(timestamp date, int hours)</span>, <span class=\"hue-doc-codeph\">hours_add(timestamp date, bigint\n          hours)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of hours.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  hours_add(now(), 12) as in_12_hours;\n+-------------------------------+-------------------------------+\n| right_now                     | in_12_hours                   |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:19:48.948107000 | 2016-06-02 02:19:48.948107000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">hours_sub(timestamp date, int hours)</span>, <span class=\"hue-doc-codeph\">hours_sub(timestamp date, bigint\n          hours)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of hours.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  hours_sub(now(), 18) as 18_hours_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 18_hours_ago                  |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:23:13.868150000 | 2016-05-31 20:23:13.868150000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">int_months_between(timestamp newer, timestamp older)</span></dt><dd><b>Purpose:</b> Returns the number of months between the date portions of two <span class=\"hue-doc-codeph\">TIMESTAMP</span> values,\n          as an <span class=\"hue-doc-codeph\">INT</span> representing only the full months that passed.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b></p><p>\n            Typically used in business contexts, for example to determine whether\n            a specified number of months have passed or whether some end-of-month deadline was reached.\n          </p><p>\n            The method of determining the number of elapsed months includes some special handling of\n            months with different numbers of days that creates edge cases for dates between the\n            28th and 31st days of certain months. See <span class=\"hue-doc-codeph\">months_between()</span> for details.\n            The <span class=\"hue-doc-codeph\">int_months_between()</span> result is essentially the <span class=\"hue-doc-codeph\">floor()</span>\n            of the <span class=\"hue-doc-codeph\">months_between()</span> result.\n          </p><p>\n            If either value is <span class=\"hue-doc-codeph\">NULL</span>, which could happen for example when converting a\n            nonexistent date string such as <span class=\"hue-doc-codeph\">'2015-02-29'</span> to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>,\n            the result is also <span class=\"hue-doc-codeph\">NULL</span>.\n          </p><p>\n            If the first argument represents an earlier time than the second argument, the result is negative.\n          </p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">/* Less than a full month = 0. */\nselect int_months_between('2015-02-28', '2015-01-29');\n+------------------------------------------------+\n| int_months_between('2015-02-28', '2015-01-29') |\n+------------------------------------------------+\n| 0                                              |\n+------------------------------------------------+\n\n/* Last day of month to last day of next month = 1. */\nselect int_months_between('2015-02-28', '2015-01-31');\n+------------------------------------------------+\n| int_months_between('2015-02-28', '2015-01-31') |\n+------------------------------------------------+\n| 1                                              |\n+------------------------------------------------+\n\n/* Slightly less than 2 months = 1. */\nselect int_months_between('2015-03-28', '2015-01-31');\n+------------------------------------------------+\n| int_months_between('2015-03-28', '2015-01-31') |\n+------------------------------------------------+\n| 1                                              |\n+------------------------------------------------+\n\n/* 2 full months (identical days of the month) = 2. */\nselect int_months_between('2015-03-31', '2015-01-31');\n+------------------------------------------------+\n| int_months_between('2015-03-31', '2015-01-31') |\n+------------------------------------------------+\n| 2                                              |\n+------------------------------------------------+\n\n/* Last day of month to last day of month-after-next = 2. */\nselect int_months_between('2015-03-31', '2015-01-30');\n+------------------------------------------------+\n| int_months_between('2015-03-31', '2015-01-30') |\n+------------------------------------------------+\n| 2                                              |\n+------------------------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">last_day(timestamp t)</span></dt><dd><b>Purpose:</b> Returns a <span class=\"hue-doc-codeph\">TIMESTAMP</span> corresponding to\n          the beginning of the last calendar day in the same month as the\n          <span class=\"hue-doc-codeph\">TIMESTAMP</span> argument.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Added in:</b>Impala 2.9.0</p><p><b>Usage notes:</b></p><p>\n            If the input argument does not represent a valid Impala <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            including both date and time portions, the function returns <span class=\"hue-doc-codeph\">NULL</span>.\n            For example, if the input argument is a string that cannot be implicitly cast to\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span>, does not include a date portion, or is out of the\n            allowed range for Impala <span class=\"hue-doc-codeph\">TIMESTAMP</span> values, the function returns\n            <span class=\"hue-doc-codeph\">NULL</span>.\n          </p><p><b>Examples:</b></p><p>\n            The following example shows how to examine the current date, and dates around the\n            end of the month, as <span class=\"hue-doc-codeph\">TIMESTAMP</span> values with any time portion removed:\n          </p><div class=\"hue-doc-codeblock\">\nselect\n    now() as right_now\n  , trunc(now(),'dd') as today\n  , last_day(now()) as last_day_of_month\n  , last_day(now()) + interval 1 day as first_of_next_month;\n+-------------------------------+---------------------+---------------------+---------------------+\n| right_now                     | today               | last_day_of_month   | first_of_next_month |\n+-------------------------------+---------------------+---------------------+---------------------+\n| 2017-08-15 15:07:58.823812000 | 2017-08-15 00:00:00 | 2017-08-31 00:00:00 | 2017-09-01 00:00:00 |\n+-------------------------------+---------------------+---------------------+---------------------+\n</div><p>\n            The following example shows how to examine the current date and dates around the\n            end of the month as integers representing the day of the month:\n          </p><div class=\"hue-doc-codeblock\">\nselect\n    now() as right_now\n  , dayofmonth(now()) as day\n  , extract(day from now()) as also_day\n  , dayofmonth(last_day(now())) as last_day\n  , extract(day from last_day(now())) as also_last_day;\n+-------------------------------+-----+----------+----------+---------------+\n| right_now                     | day | also_day | last_day | also_last_day |\n+-------------------------------+-----+----------+----------+---------------+\n| 2017-08-15 15:07:59.417755000 | 15  | 15       | 31       | 31            |\n+-------------------------------+-----+----------+----------+---------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">microseconds_add(timestamp date, int microseconds)</span>, <span class=\"hue-doc-codeph\">microseconds_add(timestamp\n          date, bigint microseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of microseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  microseconds_add(now(), 500000) as half_a_second_from_now;\n+-------------------------------+-------------------------------+\n| right_now                     | half_a_second_from_now        |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:25:11.455051000 | 2016-06-01 14:25:11.955051000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">microseconds_sub(timestamp date, int microseconds)</span>, <span class=\"hue-doc-codeph\">microseconds_sub(timestamp\n          date, bigint microseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of microseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  microseconds_sub(now(), 500000) as half_a_second_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | half_a_second_ago             |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:26:16.509990000 | 2016-06-01 14:26:16.009990000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">millisecond(timestamp)</span></dt><dd><b>Purpose:</b> Returns the millisecond portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Added in:</b>Impala 2.5.0</p><p><b>Usage notes:</b></p><p>\n            The millisecond value is truncated, not rounded, if the <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            value contains more than 3 significant digits to the right of the decimal point.\n          </p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\n252.4 milliseconds truncated to 252.\n\nselect now(), millisecond(now());\n+-------------------------------+--------------------+\n| now()                         | millisecond(now()) |\n+-------------------------------+--------------------+\n| 2016-03-14 22:30:25.252400000 | 252                |\n+-------------------------------+--------------------+\n\n761.767 milliseconds truncated to 761.\n\nselect now(), millisecond(now());\n+-------------------------------+--------------------+\n| now()                         | millisecond(now()) |\n+-------------------------------+--------------------+\n| 2016-03-14 22:30:58.761767000 | 761                |\n+-------------------------------+--------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">milliseconds_add(timestamp date, int milliseconds)</span>, <span class=\"hue-doc-codeph\">milliseconds_add(timestamp\n          date, bigint milliseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of milliseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  milliseconds_add(now(), 1500) as 1_point_5_seconds_from_now;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_point_5_seconds_from_now    |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:30:30.067366000 | 2016-06-01 14:30:31.567366000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">milliseconds_sub(timestamp date, int milliseconds)</span>, <span class=\"hue-doc-codeph\">milliseconds_sub(timestamp\n          date, bigint milliseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of milliseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  milliseconds_sub(now(), 1500) as 1_point_5_seconds_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_point_5_seconds_ago         |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:30:53.467140000 | 2016-06-01 14:30:51.967140000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">minute(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the minute field from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, minute(now()) as current_minute;\n+-------------------------------+----------------+\n| right_now                     | current_minute |\n+-------------------------------+----------------+\n| 2016-06-01 14:34:08.051702000 | 34             |\n+-------------------------------+----------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">minutes_add(timestamp date, int minutes)</span>, <span class=\"hue-doc-codeph\">minutes_add(timestamp date, bigint\n          minutes)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of minutes.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, minutes_add(now(), 90) as 90_minutes_from_now;\n+-------------------------------+-------------------------------+\n| right_now                     | 90_minutes_from_now           |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:36:04.887095000 | 2016-06-01 16:06:04.887095000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">minutes_sub(timestamp date, int minutes)</span>, <span class=\"hue-doc-codeph\">minutes_sub(timestamp date, bigint\n          minutes)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of minutes.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, minutes_sub(now(), 90) as 90_minutes_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 90_minutes_ago                |\n+-------------------------------+-------------------------------+\n| 2016-06-01 14:36:32.643061000 | 2016-06-01 13:06:32.643061000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">month(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the month field, represented as an integer, from the date portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, month(now()) as current_month;\n+-------------------------------+---------------+\n| right_now                     | current_month |\n+-------------------------------+---------------+\n| 2016-06-01 14:43:37.141542000 | 6             |\n+-------------------------------+---------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">monthname(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the month field from a\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, converted to the string\n          corresponding to that month name.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p></dd><dt><span class=\"hue-doc-codeph\">months_add(timestamp date, int months)</span>, <span class=\"hue-doc-codeph\">months_add(timestamp date, bigint\n          months)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of months.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following example shows the effects of adding some number of\n            months to a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, using both the\n            <span class=\"hue-doc-codeph\">months_add()</span> function and its <span class=\"hue-doc-codeph\">add_months()</span>\n            alias. These examples use <span class=\"hue-doc-codeph\">trunc()</span> to strip off the time portion\n            and leave just the date.\n          </p><div class=\"hue-doc-codeblock\">\nwith t1 as (select trunc(now(), 'dd') as today)\n  select today, months_add(today,1) as next_month from t1;\n+---------------------+---------------------+\n| today               | next_month          |\n+---------------------+---------------------+\n| 2016-05-19 00:00:00 | 2016-06-19 00:00:00 |\n+---------------------+---------------------+\n\nwith t1 as (select trunc(now(), 'dd') as today)\n  select today, add_months(today,1) as next_month from t1;\n+---------------------+---------------------+\n| today               | next_month          |\n+---------------------+---------------------+\n| 2016-05-19 00:00:00 | 2016-06-19 00:00:00 |\n+---------------------+---------------------+\n</div><p>\n            The following examples show how if <span class=\"hue-doc-codeph\">months_add()</span>\n            would return a nonexistent date, due to different months having\n            different numbers of days, the function returns a <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            from the last day of the relevant month. For example, adding one month\n            to January 31 produces a date of February 29th in the year 2016 (a leap year),\n            and February 28th in the year 2015 (a non-leap year).\n          </p><div class=\"hue-doc-codeblock\">\nwith t1 as (select cast('2016-01-31' as timestamp) as jan_31)\n  select jan_31, months_add(jan_31,1) as feb_31 from t1;\n+---------------------+---------------------+\n| jan_31              | feb_31              |\n+---------------------+---------------------+\n| 2016-01-31 00:00:00 | 2016-02-29 00:00:00 |\n+---------------------+---------------------+\n\nwith t1 as (select cast('2015-01-31' as timestamp) as jan_31)\n  select jan_31, months_add(jan_31,1) as feb_31 from t1;\n+---------------------+---------------------+\n| jan_31              | feb_31              |\n+---------------------+---------------------+\n| 2015-01-31 00:00:00 | 2015-02-28 00:00:00 |\n+---------------------+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">months_between(timestamp newer, timestamp older)</span></dt><dd><b>Purpose:</b> Returns the number of months between the date portions of two <span class=\"hue-doc-codeph\">TIMESTAMP</span> values.\n          Can include a fractional part representing extra days in addition to the full months\n          between the dates. The fractional component is computed by dividing the difference in days by 31 (regardless of the month).\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">double</span></p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b></p><p>\n            Typically used in business contexts, for example to determine whether\n            a specified number of months have passed or whether some end-of-month deadline was reached.\n          </p><p>\n            If the only consideration is the number of full months and any fractional value is\n            not significant, use <span class=\"hue-doc-codeph\">int_months_between()</span> instead.\n          </p><p>\n            The method of determining the number of elapsed months includes some special handling of\n            months with different numbers of days that creates edge cases for dates between the\n            28th and 31st days of certain months.\n          </p><p>\n            If either value is <span class=\"hue-doc-codeph\">NULL</span>, which could happen for example when converting a\n            nonexistent date string such as <span class=\"hue-doc-codeph\">'2015-02-29'</span> to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>,\n            the result is also <span class=\"hue-doc-codeph\">NULL</span>.\n          </p><p>\n            If the first argument represents an earlier time than the second argument, the result is negative.\n          </p><p><b>Examples:</b></p><p>\n            The following examples show how dates that are on the same day of the month\n            are considered to be exactly N months apart, even if the months have different\n            numbers of days.\n          </p><div class=\"hue-doc-codeblock\">select months_between('2015-02-28', '2015-01-28');\n+--------------------------------------------+\n| months_between('2015-02-28', '2015-01-28') |\n+--------------------------------------------+\n| 1                                          |\n+--------------------------------------------+\n\nselect months_between(now(), now() + interval 1 month);\n+-------------------------------------------------+\n| months_between(now(), now() + interval 1 month) |\n+-------------------------------------------------+\n| -1                                              |\n+-------------------------------------------------+\n\nselect months_between(now() + interval 1 year, now());\n+------------------------------------------------+\n| months_between(now() + interval 1 year, now()) |\n+------------------------------------------------+\n| 12                                             |\n+------------------------------------------------+\n</div><p>\n            The following examples show how dates that are on the last day of the month\n            are considered to be exactly N months apart, even if the months have different\n            numbers of days. For example, from January 28th to February 28th is exactly one\n            month because the day of the month is identical; January 31st to February 28th\n            is exactly one month because in both cases it is the last day of the month;\n            but January 29th or 30th to February 28th is considered a fractional month.\n          </p><div class=\"hue-doc-codeblock\">select months_between('2015-02-28', '2015-01-31');\n+--------------------------------------------+\n| months_between('2015-02-28', '2015-01-31') |\n+--------------------------------------------+\n| 1                                          |\n+--------------------------------------------+\n\nselect months_between('2015-02-28', '2015-01-29');\n+--------------------------------------------+\n| months_between('2015-02-28', '2015-01-29') |\n+--------------------------------------------+\n| 0.967741935483871                          |\n+--------------------------------------------+\n\nselect months_between('2015-02-28', '2015-01-30');;\n+--------------------------------------------+\n| months_between('2015-02-28', '2015-01-30') |\n+--------------------------------------------+\n| 0.935483870967742                          |\n+--------------------------------------------+\n</div><p>\n            The following examples show how dates that are not a precise number\n            of months apart result in a fractional return value.\n          </p><div class=\"hue-doc-codeblock\">select months_between('2015-03-01', '2015-01-28');\n+--------------------------------------------+\n| months_between('2015-03-01', '2015-01-28') |\n+--------------------------------------------+\n| 1.129032258064516                          |\n+--------------------------------------------+\n\nselect months_between('2015-03-01', '2015-02-28');\n+--------------------------------------------+\n| months_between('2015-03-01', '2015-02-28') |\n+--------------------------------------------+\n| 0.1290322580645161                         |\n+--------------------------------------------+\n\nselect months_between('2015-06-02', '2015-05-29');\n+--------------------------------------------+\n| months_between('2015-06-02', '2015-05-29') |\n+--------------------------------------------+\n| 0.1290322580645161                         |\n+--------------------------------------------+\n\nselect months_between('2015-03-01', '2015-01-25');\n+--------------------------------------------+\n| months_between('2015-03-01', '2015-01-25') |\n+--------------------------------------------+\n| 1.225806451612903                          |\n+--------------------------------------------+\n\nselect months_between('2015-03-01', '2015-02-25');\n+--------------------------------------------+\n| months_between('2015-03-01', '2015-02-25') |\n+--------------------------------------------+\n| 0.2258064516129032                         |\n+--------------------------------------------+\n\nselect months_between('2015-02-28', '2015-02-01');\n+--------------------------------------------+\n| months_between('2015-02-28', '2015-02-01') |\n+--------------------------------------------+\n| 0.8709677419354839                         |\n+--------------------------------------------+\n\nselect months_between('2015-03-28', '2015-03-01');\n+--------------------------------------------+\n| months_between('2015-03-28', '2015-03-01') |\n+--------------------------------------------+\n| 0.8709677419354839                         |\n+--------------------------------------------+\n</div><p>\n            The following examples show how the time portion of the <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            values are irrelevant for calculating the month interval. Even the fractional part\n            of the result only depends on the number of full days between the argument values,\n            regardless of the time portion.\n          </p><div class=\"hue-doc-codeblock\">select months_between('2015-05-28 23:00:00', '2015-04-28 11:45:00');\n+--------------------------------------------------------------+\n| months_between('2015-05-28 23:00:00', '2015-04-28 11:45:00') |\n+--------------------------------------------------------------+\n| 1                                                            |\n+--------------------------------------------------------------+\n\nselect months_between('2015-03-28', '2015-03-01');\n+--------------------------------------------+\n| months_between('2015-03-28', '2015-03-01') |\n+--------------------------------------------+\n| 0.8709677419354839                         |\n+--------------------------------------------+\n\nselect months_between('2015-03-28 23:00:00', '2015-03-01 11:45:00');\n+--------------------------------------------------------------+\n| months_between('2015-03-28 23:00:00', '2015-03-01 11:45:00') |\n+--------------------------------------------------------------+\n| 0.8709677419354839                                           |\n+--------------------------------------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">months_sub(timestamp date, int months)</span>, <span class=\"hue-doc-codeph\">months_sub(timestamp date, bigint\n          months)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of months.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nwith t1 as (select trunc(now(), 'dd') as today)\n  select today, months_sub(today,1) as last_month from t1;\n+---------------------+---------------------+\n| today               | last_month          |\n+---------------------+---------------------+\n| 2016-06-01 00:00:00 | 2016-05-01 00:00:00 |\n+---------------------+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">nanoseconds_add(timestamp date, int nanoseconds)</span>, <span class=\"hue-doc-codeph\">nanoseconds_add(timestamp\n          date, bigint nanoseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of nanoseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Kudu considerations:</b></p><p>\n        The nanosecond portion of an Impala <span class=\"hue-doc-codeph\">TIMESTAMP</span> value\n        is rounded to the nearest microsecond when that value is stored in a\n        Kudu table.\n      </p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, nanoseconds_add(now(), 1) as 1_nanosecond_later;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_nanosecond_later            |\n+-------------------------------+-------------------------------+\n| 2016-06-01 15:42:00.361026000 | 2016-06-01 15:42:00.361026001 |\n+-------------------------------+-------------------------------+\n\n-- 1 billion nanoseconds = 1 second.\nselect now() as right_now, nanoseconds_add(now(), 1e9) as 1_second_later;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_second_later                |\n+-------------------------------+-------------------------------+\n| 2016-06-01 15:42:52.926706000 | 2016-06-01 15:42:53.926706000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">nanoseconds_sub(timestamp date, int nanoseconds)</span>, <span class=\"hue-doc-codeph\">nanoseconds_sub(timestamp\n          date, bigint nanoseconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of nanoseconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Kudu considerations:</b></p><p>\n        The nanosecond portion of an Impala <span class=\"hue-doc-codeph\">TIMESTAMP</span> value\n        is rounded to the nearest microsecond when that value is stored in a\n        Kudu table.\n      </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, nanoseconds_sub(now(), 1) as 1_nanosecond_earlier;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_nanosecond_earlier          |\n+-------------------------------+-------------------------------+\n| 2016-06-01 15:44:14.355837000 | 2016-06-01 15:44:14.355836999 |\n+-------------------------------+-------------------------------+\n\n-- 1 billion nanoseconds = 1 second.\nselect now() as right_now, nanoseconds_sub(now(), 1e9) as 1_second_earlier;\n+-------------------------------+-------------------------------+\n| right_now                     | 1_second_earlier              |\n+-------------------------------+-------------------------------+\n| 2016-06-01 15:44:54.474929000 | 2016-06-01 15:44:53.474929000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">now()</span></dt><dd><b>Purpose:</b> Returns the current date and time (in the local time zone) as a\n          <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Usage notes:</b></p><p>\n            To find a date/time value in the future or the past relative to the current date\n            and time, add or subtract an <span class=\"hue-doc-codeph\">INTERVAL</span> expression to the return value of\n            <span class=\"hue-doc-codeph\">now()</span>. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for examples.\n          </p><p>\n            To produce a <span class=\"hue-doc-codeph\">TIMESTAMP</span> representing the current date and time that can be\n            shared or stored without interoperability problems due to time zone differences, use the\n            <span class=\"hue-doc-codeph\">to_utc_timestamp()</span> function and specify the time zone of the server.\n            When <span class=\"hue-doc-codeph\">TIMESTAMP</span> data is stored in UTC form, any application that queries\n            those values can convert them to the appropriate local time zone by calling the inverse\n            function, <span class=\"hue-doc-codeph\">from_utc_timestamp()</span>.\n          </p><p>\n        To determine the time zone of the server you are connected to, in Impala 2.3 and\n        higher you can call the <span class=\"hue-doc-codeph\">timeofday()</span> function, which includes the time zone\n        specifier in its return value. Remember that with cloud computing, the server you interact\n        with might be in a different time zone than you are, or different sessions might connect to\n        servers in different time zones, or a cluster might include servers in more than one time zone.\n      </p><p>\n            Any references to the <span class=\"hue-doc-codeph\">now()</span> function are evaluated at the start of a query.\n            All calls to <span class=\"hue-doc-codeph\">now()</span> within the same query return the same value,\n            and the value does not depend on how long the query takes.\n          </p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as 'Current time in California USA',\n  to_utc_timestamp(now(), 'PDT') as 'Current time in Greenwich UK';\n+--------------------------------+-------------------------------+\n| current time in california usa | current time in greenwich uk  |\n+--------------------------------+-------------------------------+\n| 2016-06-01 15:52:08.980072000  | 2016-06-01 22:52:08.980072000 |\n+--------------------------------+-------------------------------+\n\nselect now() as right_now,\n  now() + interval 1 day as tomorrow,\n  now() + interval 1 week - interval 3 hours as almost_a_week_from_now;\n+-------------------------------+-------------------------------+-------------------------------+\n| right_now                     | tomorrow                      | almost_a_week_from_now        |\n+-------------------------------+-------------------------------+-------------------------------+\n| 2016-06-01 15:55:39.671690000 | 2016-06-02 15:55:39.671690000 | 2016-06-08 12:55:39.671690000 |\n+-------------------------------+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">quarter(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the quarter in the input\n          <span class=\"hue-doc-codeph\">TIMESTAMP</span> expression as an integer value, 1, 2, 3, or\n          4, where 1 represents January 1 through March 31.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p></dd><dt><span class=\"hue-doc-codeph\">second(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the second field from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  second(now()) as seconds_in_current_minute;\n+-------------------------------+---------------------------+\n| right_now                     | seconds_in_current_minute |\n+-------------------------------+---------------------------+\n| 2016-06-01 16:03:57.006603000 | 57                        |\n+-------------------------------+---------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">seconds_add(timestamp date, int seconds)</span>, <span class=\"hue-doc-codeph\">seconds_add(timestamp date, bigint\n          seconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of seconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  seconds_add(now(), 10) as 10_seconds_from_now;\n+-------------------------------+-------------------------------+\n| right_now                     | 10_seconds_from_now           |\n+-------------------------------+-------------------------------+\n| 2016-06-01 16:05:21.573935000 | 2016-06-01 16:05:31.573935000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">seconds_sub(timestamp date, int seconds)</span>, <span class=\"hue-doc-codeph\">seconds_sub(timestamp date, bigint\n          seconds)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of seconds.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  seconds_sub(now(), 10) as 10_seconds_ago;\n+-------------------------------+-------------------------------+\n| right_now                     | 10_seconds_ago                |\n+-------------------------------+-------------------------------+\n| 2016-06-01 16:06:03.467931000 | 2016-06-01 16:05:53.467931000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">subdate(timestamp startdate, int days)</span>, <span class=\"hue-doc-codeph\">subdate(timestamp startdate, bigint\n          days)</span>,\n        </dt><dd><b>Purpose:</b> Subtracts a specified number of days from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. Similar to\n          <span class=\"hue-doc-codeph\">date_sub()</span>, but starts with an actual <span class=\"hue-doc-codeph\">TIMESTAMP</span> value instead of a\n          string that is converted to a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following examples show how to subtract a number of days from a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n            The number of days can also be negative, which gives the same effect as the <span class=\"hue-doc-codeph\">adddate()</span> function.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, subdate(now(), 30) as now_minus_30;\n+-------------------------------+-------------------------------+\n| right_now                     | now_minus_30                  |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:00:15.084991000 | 2016-04-20 11:00:15.084991000 |\n+-------------------------------+-------------------------------+\n\nselect now() as right_now, subdate(now(), -15) as now_plus_15;\n+-------------------------------+-------------------------------+\n| right_now                     | now_plus_15                   |\n+-------------------------------+-------------------------------+\n| 2016-05-20 11:00:44.766091000 | 2016-06-04 11:00:44.766091000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">timeofday()</span></dt><dd><b>Purpose:</b> Returns a string representation of the current date and time, according to the time of the local system,\n          including any time zone designation.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b> The result value represents similar information as the\n            <span class=\"hue-doc-codeph\">now()</span> function, only as a <span class=\"hue-doc-codeph\">STRING</span> type\n            and with somewhat different formatting. For example, the day of the week\n            and the time zone identifier are included. This function is intended\n            primarily for compatibility with SQL code from other systems that\n            also have a <span class=\"hue-doc-codeph\">timeofday()</span> function. Prefer to use\n            <span class=\"hue-doc-codeph\">now()</span> if practical for any new Impala code.\n          </p><p><b>Examples:</b></p><p>\n            The following examples show the format of the <span class=\"hue-doc-codeph\">timeofday()</span>\n            return value, illustrate how that value is represented as a <span class=\"hue-doc-codeph\">STRING</span>\n            that you can manipulate with string processing functions, and how the format\n            compares with the return value from the <span class=\"hue-doc-codeph\">now()</span> function.\n          </p><div class=\"hue-doc-codeblock\">/* Date and time fields in a STRING return value. */\nselect timeofday();\n+------------------------------+\n| timeofday()                  |\n+------------------------------+\n| Tue Sep 01 15:13:18 2015 PDT |\n+------------------------------+\n\n/* The return value can be processed by other string functions. */\nselect upper(timeofday());\n+------------------------------+\n| upper(timeofday())           |\n+------------------------------+\n| TUE SEP 01 15:13:38 2015 PDT |\n+------------------------------+\n\n/* The TIMEOFDAY() result is formatted differently than NOW(). NOW() returns a TIMESTAMP. */\nselect now(), timeofday();\n+-------------------------------+------------------------------+\n| now()                         | timeofday()                  |\n+-------------------------------+------------------------------+\n| 2015-09-01 15:15:25.930021000 | Tue Sep 01 15:15:25 2015 PDT |\n+-------------------------------+------------------------------+\n\n/* You can strip out the time zone field to use in calls to from_utc_timestamp(). */\nselect regexp_replace(timeofday(), '.* ([A-Z]+)$', '\\\\1') as current_timezone;\n+------------------+\n| current_timezone |\n+------------------+\n| PDT              |\n+------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">timestamp_cmp(timestamp t1, timestamp t2)</span></dt><dd><b>Purpose:</b> Tests if one <span class=\"hue-doc-codeph\">TIMESTAMP</span> value is\n          newer than, older than, or identical to another <span class=\"hue-doc-codeph\">TIMESTAMP</span><p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span> (either -1, 0, 1, or <span class=\"hue-doc-codeph\">NULL</span>)\n          </p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b></p><p><b>Usage notes:</b> A comparison function for <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            values that only tests whether the date and time increases, decreases,\n            or stays the same. Similar to the <span class=\"hue-doc-codeph\">sign()</span> function\n            for numeric values.\n          </p><p><b>Examples:</b></p><p>\n            The following examples show all the possible return values for <span class=\"hue-doc-codeph\">timestamp_cmp()</span>.\n            If the first argument represents a later point in time than the second argument, the result is 1.\n            The amount of the difference is irrelevant, only the fact that one argument is greater than or less than the other.\n            If the first argument represents an earlier point in time than the second argument, the result is -1.\n            If the first and second arguments represent identical points in time, the result is 0.\n            If either argument is <span class=\"hue-doc-codeph\">NULL</span>, the result is <span class=\"hue-doc-codeph\">NULL</span>.\n          </p><div class=\"hue-doc-codeblock\">/* First argument 'later' than second argument. */\n\nselect timestamp_cmp(now() + interval 70 minutes, now())\n  as now_vs_in_70_minutes;\n+----------------------+\n| now_vs_in_70_minutes |\n+----------------------+\n| 1                    |\n+----------------------+\n\nselect timestamp_cmp(now() +\n  interval 3 days +\n  interval 5 hours, now())\n  as now_vs_days_from_now;\n+----------------------+\n| now_vs_days_from_now |\n+----------------------+\n| 1                    |\n+----------------------+\n\n/* First argument 'earlier' than second argument. */\nselect timestamp_cmp(now(), now() + interval 2 hours)\n  as now_vs_2_hours_ago;\n+--------------------+\n| now_vs_2_hours_ago |\n+--------------------+\n| -1                 |\n+--------------------+\n\n/* Both arguments represent the same point in time. */\n\nselect timestamp_cmp(now(), now())\n  as identical_timestamps;\n+----------------------+\n| identical_timestamps |\n+----------------------+\n| 0                    |\n+----------------------+\n\nselect timestamp_cmp\n(\n  now() + interval 1 hour,\n  now() + interval 60 minutes\n) as equivalent_date_times;\n+-----------------------+\n| equivalent_date_times |\n+-----------------------+\n| 0                     |\n+-----------------------+\n\n/* Either argument NULL. */\n\nselect timestamp_cmp(now(), null)\n  as now_vs_null;\n+-------------+\n| now_vs_null |\n+-------------+\n| NULL        |\n+-------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">to_date(timestamp)</span></dt><dd><b>Purpose:</b> Returns a string representation of the date field from a timestamp value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">string</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now,\n  concat('The date today is ',to_date(now()),'.') as date_announcement;\n+-------------------------------+-------------------------------+\n| right_now                     | date_announcement             |\n+-------------------------------+-------------------------------+\n| 2016-06-01 16:30:36.890325000 | The date today is 2016-06-01. |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">to_timestamp(bigint unixtime)</span>,\n          <span class=\"hue-doc-codeph\">to_timestamp(string date, string pattern)</span></dt><dd><b>Purpose:</b> Converts an integer or string representing\n          a date/time value into the corresponding <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n          value.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Added in:</b>Impala 2.3.0</p><p><b>Usage notes:</b></p><p>\n            An integer argument represents the number of seconds past the epoch (midnight\n            on January 1, 1970). It is the converse of the <span class=\"hue-doc-codeph\">unix_timestamp()</span>\n            function, which produces a <span class=\"hue-doc-codeph\">BIGINT</span> representing the number of\n            seconds past the epoch.\n          </p><p>\n            A string argument, plus another string argument representing the\n            pattern, turns an arbitrary string representation of a date and time\n            into a true <span class=\"hue-doc-codeph\">TIMESTAMP</span> value. The ability to parse\n            many kinds of date and time formats allows you to deal with temporal\n            data from diverse sources, and if desired to convert to efficient\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> values during your ETL process. Using\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> directly in queries and expressions lets you\n            perform date and time calculations without the overhead of extra\n            function calls and conversions each time you reference the applicable\n            columns.\n          </p><p><b>Examples:</b></p><p>\n            The following examples demonstrate how to convert an arbitrary string\n            representation to <span class=\"hue-doc-codeph\">TIMESTAMP</span> based on a pattern string:\n          </p><div class=\"hue-doc-codeblock\">\nselect to_timestamp('Sep 25, 1984', 'MMM dd, yyyy');\n+----------------------------------------------+\n| to_timestamp('sep 25, 1984', 'mmm dd, yyyy') |\n+----------------------------------------------+\n| 1984-09-25 00:00:00                          |\n+----------------------------------------------+\n\nselect to_timestamp('1984/09/25', 'yyyy/MM/dd');\n+------------------------------------------+\n| to_timestamp('1984/09/25', 'yyyy/mm/dd') |\n+------------------------------------------+\n| 1984-09-25 00:00:00                      |\n+------------------------------------------+\n</div><p>\n            The following examples show how to convert a <span class=\"hue-doc-codeph\">BIGINT</span>\n            representing seconds past epoch into a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value:\n          </p><div class=\"hue-doc-codeblock\">\n-- One day past the epoch.\nselect to_timestamp(24 * 60 * 60);\n+----------------------------+\n| to_timestamp(24 * 60 * 60) |\n+----------------------------+\n| 1970-01-02 00:00:00        |\n+----------------------------+\n\n-- 60 seconds in the past.\nselect now() as 'current date/time',\n  unix_timestamp(now()) 'now in seconds',\n  to_timestamp(unix_timestamp(now()) - 60) as '60 seconds ago';\n+-------------------------------+----------------+---------------------+\n| current date/time             | now in seconds | 60 seconds ago      |\n+-------------------------------+----------------+---------------------+\n| 2017-10-01 22:03:46.885624000 | 1506895426     | 2017-10-01 22:02:46 |\n+-------------------------------+----------------+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">to_utc_timestamp(timestamp, string timezone)</span></dt><dd><b>Purpose:</b> Converts a specified timestamp value in a specified time zone into the corresponding\n          value for the UTC time zone.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Usage notes:</b></p><p>\n            Often used in combination with the <span class=\"hue-doc-codeph\">now()</span> function,\n            to translate local date and time values to the UTC time zone for consistent representation\n            on disk. The opposite of the <span class=\"hue-doc-codeph\">from_utc_timestamp()</span> function.\n          </p><p>\n            See discussion of time zones in <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a>\n            for information about using this function for conversions between the local time zone and UTC.\n          </p><p><b>Examples:</b></p><p>\n            The simplest use of this function is to turn a local date/time value to one with the standardized\n            UTC time zone. Because the time zone specifier is not saved as part of the Impala\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, all applications that refer to such data must agree in advance\n            which time zone the values represent. If different parts of the ETL cycle, or different instances\n            of the application, occur in different time zones, the ideal reference point is to convert\n            all <span class=\"hue-doc-codeph\">TIMESTAMP</span> values to UTC for storage.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as 'Current time in California USA',\n  to_utc_timestamp(now(), 'PDT') as 'Current time in Greenwich UK';\n+--------------------------------+-------------------------------+\n| current time in california usa | current time in greenwich uk  |\n+--------------------------------+-------------------------------+\n| 2016-06-01 15:52:08.980072000  | 2016-06-01 22:52:08.980072000 |\n+--------------------------------+-------------------------------+\n</div><p>\n            Once a value is converted to the UTC time zone by <span class=\"hue-doc-codeph\">to_utc_timestamp()</span>,\n            it can be converted back to the local time zone with <span class=\"hue-doc-codeph\">from_utc_timestamp()</span>.\n            You can combine these functions using different time zone identifiers to convert a\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> between any two time zones. This example starts with a\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> value representing Pacific Daylight Time, converts it to\n            UTC, and converts it to the equivalent value in Eastern Daylight Time.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as 'Current time in California USA',\n  from_utc_timestamp\n  (\n    to_utc_timestamp(now(), 'PDT'),\n    'EDT'\n  ) as 'Current time in New York, USA';\n+--------------------------------+-------------------------------+\n| current time in california usa | current time in new york, usa |\n+--------------------------------+-------------------------------+\n| 2016-06-01 18:14:12.743658000  | 2016-06-01 21:14:12.743658000 |\n+--------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">trunc(timestamp, string unit)</span></dt><dd><b>Purpose:</b> Strips off fields from a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value.\n          <p><b>Unit argument:</b> The <span class=\"hue-doc-codeph\">unit</span> argument value for truncating\n            <span class=\"hue-doc-codeph\">TIMESTAMP</span> values is case-sensitive. This argument string\n            can be one of:\n<ul><li><span class=\"hue-doc-codeph\">SYYYY</span>, <span class=\"hue-doc-codeph\">YYYY</span>, <span class=\"hue-doc-codeph\">YEAR</span>, <span class=\"hue-doc-codeph\">SYEAR</span>,\n                <span class=\"hue-doc-codeph\">YYY</span>, <span class=\"hue-doc-codeph\">YY</span>, <span class=\"hue-doc-codeph\">Y</span>: Year.\n              </li><li><span class=\"hue-doc-codeph\">Q</span>: Quarter.\n              </li><li><span class=\"hue-doc-codeph\">MONTH</span>, <span class=\"hue-doc-codeph\">MON</span>, <span class=\"hue-doc-codeph\">MM</span>, <span class=\"hue-doc-codeph\">RM</span>: Month.\n              </li><li><span class=\"hue-doc-codeph\">WW</span>, <span class=\"hue-doc-codeph\">W</span>: Same day of the week as the first day of the month.\n              </li><li><span class=\"hue-doc-codeph\">DDD</span>, <span class=\"hue-doc-codeph\">DD</span>, <span class=\"hue-doc-codeph\">J</span>: Day.\n              </li><li><span class=\"hue-doc-codeph\">DAY</span>, <span class=\"hue-doc-codeph\">DY</span>, <span class=\"hue-doc-codeph\">D</span>: Starting day of the week.\n                (Not necessarily the current day.)\n              </li><li><span class=\"hue-doc-codeph\">HH</span>, <span class=\"hue-doc-codeph\">HH12</span>, <span class=\"hue-doc-codeph\">HH24</span>: Hour. A\n                <span class=\"hue-doc-codeph\">TIMESTAMP</span> value truncated to the hour is always represented in 24-hour\n                notation, even for the <span class=\"hue-doc-codeph\">HH12</span> argument string.\n              </li><li><span class=\"hue-doc-codeph\">MI</span>: Minute.\n              </li></ul></p><p><b>Added in:</b> The ability to truncate numeric values is new starting in\n            Impala 2.10.\n          </p><p><b>Usage notes:</b></p><p>\n            The <span class=\"hue-doc-codeph\">TIMESTAMP</span> form is typically used in <span class=\"hue-doc-codeph\">GROUP BY</span>\n            queries to aggregate results from the same hour, day, week, month, quarter, and so on.\n            You can also use this function in an <span class=\"hue-doc-codeph\">INSERT ... SELECT</span> into a\n            partitioned table to divide <span class=\"hue-doc-codeph\">TIMESTAMP</span> values into the correct partition.\n          </p><p>\n            Because the return value is a <span class=\"hue-doc-codeph\">TIMESTAMP</span>, if you cast the result of\n            <span class=\"hue-doc-codeph\">TRUNC()</span> to <span class=\"hue-doc-codeph\">STRING</span>, you will often see zeroed-out portions such as\n            <span class=\"hue-doc-codeph\">00:00:00</span> in the time field. If you only need the individual units such as hour, day,\n            month, or year, use the <span class=\"hue-doc-codeph\">EXTRACT()</span> function instead. If you need the individual units\n            from a truncated <span class=\"hue-doc-codeph\">TIMESTAMP</span> value, run the <span class=\"hue-doc-codeph\">TRUNCATE()</span> function on the\n            original value, then run <span class=\"hue-doc-codeph\">EXTRACT()</span> on the result.\n          </p><p>\n            The <span class=\"hue-doc-codeph\">trunc()</span> function also has a signature that applies to\n            <span class=\"hue-doc-codeph\">DOUBLE</span> or <span class=\"hue-doc-codeph\">DECIMAL</span>values. <span class=\"hue-doc-codeph\">truncate()</span>,\n            <span class=\"hue-doc-codeph\">trunc()</span>, and <span class=\"hue-doc-codeph\">dtrunc()</span> are all aliased to the\n            same function. See <span class=\"hue-doc-codeph\">truncate()</span> under <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_math_functions.xml\" data-doc-anchor-id=\"math_functions\">Impala Mathematical Functions</a>\n            for details.\n          </p><p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><p>\n            The following example shows how the argument <span class=\"hue-doc-codeph\">'Q'</span> returns a <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n            representing the beginning of the appropriate calendar quarter. This return value is the same for input\n            values that could be separated by weeks or months. If you stored the <span class=\"hue-doc-codeph\">trunc()</span> result\n            in a partition key column, the table would have four partitions per year.\n          </p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, trunc(now(), 'Q') as current_quarter;\n+-------------------------------+---------------------+\n| right_now                     | current_quarter     |\n+-------------------------------+---------------------+\n| 2016-06-01 18:32:02.097202000 | 2016-04-01 00:00:00 |\n+-------------------------------+---------------------+\n\nselect now() + interval 2 weeks as 2_weeks_from_now,\n  trunc(now() + interval 2 weeks, 'Q') as still_current_quarter;\n+-------------------------------+-----------------------+\n| 2_weeks_from_now              | still_current_quarter |\n+-------------------------------+-----------------------+\n| 2016-06-15 18:36:19.584257000 | 2016-04-01 00:00:00   |\n+-------------------------------+-----------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">unix_timestamp(), unix_timestamp(string datetime), unix_timestamp(string datetime, string\n          format), unix_timestamp(timestamp datetime)</span></dt><dd><b>Purpose:</b> Returns a Unix time, which is a number of seconds\n          elapsed since '1970-01-01 00:00:00' UTC. If called with no\n          argument, the current date and time is converted to its Unix time. If\n          called with arguments, the first argument represented as the\n          <span class=\"hue-doc-codeph\">TIMESTAMP</span> or <span class=\"hue-doc-codeph\">STRING</span> is converted to\n          its Unix time.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">bigint</span></p><p><b>Usage notes:</b></p><p>\n            See <span class=\"hue-doc-codeph\">from_unixtime()</span> for details about the patterns you can use in\n            the <span class=\"hue-doc-codeph\">format</span> string to represent the position of year, month, day, and so on in the\n            <span class=\"hue-doc-codeph\">date</span> string. In Impala 1.3 and higher, you have more flexibility to switch the\n            positions of elements and use different separator characters.\n          </p><p>\n            In Impala 2.2.3 and higher, you can include a trailing uppercase <span class=\"hue-doc-codeph\">Z</span> qualifier\n            to indicate <q>Zulu</q> time, a synonym for UTC.\n          </p><p>\n            In Impala 2.3 and higher, you can include a timezone offset specified as minutes and hours,\n            provided you also specify the details in the format string argument. The offset is specified in the format\n            string as a plus or minus sign followed by <span class=\"hue-doc-codeph\">hh:mm</span>, <span class=\"hue-doc-codeph\">hhmm</span>, or <span class=\"hue-doc-codeph\">hh</span>.\n            The <span class=\"hue-doc-codeph\">hh</span> must be lowercase, to distinguish it from the <span class=\"hue-doc-codeph\">HH</span> represent\n            hours in the actual time value. Currently, only numeric timezone offsets are allowed, not symbolic names.\n          </p><p>\n        In Impala 2.2.0 and higher, built-in functions that accept or return integers representing <span class=\"hue-doc-codeph\">TIMESTAMP</span> values\n        use the <span class=\"hue-doc-codeph\">BIGINT</span> type for parameters and return values, rather than <span class=\"hue-doc-codeph\">INT</span>.\n        This change lets the date and time functions avoid an overflow error that would otherwise occur\n        on January 19th, 2038 (known as the\n        <a class=\"hue-doc-external-link\" href=\"http://en.wikipedia.org/wiki/Year_2038_problem\" target=\"_blank\"><q>Year 2038 problem</q> or <q>Y2K38 problem</q></a>).\n        This change affects the <span class=\"hue-doc-codeph\">from_unixtime()</span> and <span class=\"hue-doc-codeph\">unix_timestamp()</span> functions.\n        You might need to change application code that interacts with these functions, change the types of\n        columns that store the return values, or add <span class=\"hue-doc-codeph\">CAST()</span> calls to SQL statements that\n        call these functions.\n      </p><p><span class=\"hue-doc-codeph\">unix_timestamp()</span> and <span class=\"hue-doc-codeph\">from_unixtime()</span> are often used in combination to\n        convert a <span class=\"hue-doc-codeph\">TIMESTAMP</span> value into a particular string format. For example:\n<div class=\"hue-doc-codeblock\">select from_unixtime(unix_timestamp(now() + interval 3 days),\n  'yyyy/MM/dd HH:mm') as yyyy_mm_dd_hh_mm;\n+------------------+\n| yyyy_mm_dd_hh_mm |\n+------------------+\n| 2016/06/03 11:38 |\n+------------------+\n</div></p><p>\n        The way this function deals with time zones when converting to or from <span class=\"hue-doc-codeph\">TIMESTAMP</span>\n        values is affected by the <span class=\"hue-doc-codeph\">--use_local_tz_for_unix_timestamp_conversions</span> startup flag for the\n        <span class=\"hue-doc-cmdname\">impalad</span> daemon. See <a class=\"hue-doc-internal-link\" href=\"javascript:void(0);\" data-doc-ref=\"topics/impala_timestamp.xml\" data-doc-anchor-id=\"timestamp\">TIMESTAMP Data Type</a> for details about\n        how Impala handles time zone considerations for the <span class=\"hue-doc-codeph\">TIMESTAMP</span> data type.\n      </p><p><b>Examples:</b></p><p>\n            The following examples show different ways of turning the same date and time into an integer value.\n            A format string that Impala recognizes by default is interpreted as a UTC date and time.\n            The trailing <span class=\"hue-doc-codeph\">Z</span> is a confirmation that the timezone is UTC.\n            If the date and time string is formatted differently, a second argument specifies\n            the position and units for each of the date and time values.\n          </p><p>\n            The final two examples show how to specify a timezone offset of Pacific Daylight Saving Time, which is 7 hours earlier than UTC.\n            You can use the numeric offset <span class=\"hue-doc-codeph\">-07:00</span> and the equivalent suffix of <span class=\"hue-doc-codeph\">-hh:mm</span>\n            in the format string, or specify the mnemonic name for the time zone in a call to <span class=\"hue-doc-codeph\">to_utc_timestamp()</span>.\n            This particular date and time expressed in PDT translates to a different number than the same date and time expressed in UTC.\n          </p><div class=\"hue-doc-codeblock\">\n-- 3 ways of expressing the same date/time in UTC and converting to an integer.\n\nselect unix_timestamp('2015-05-15 12:00:00');\n+---------------------------------------+\n| unix_timestamp('2015-05-15 12:00:00') |\n+---------------------------------------+\n| 1431691200                            |\n+---------------------------------------+\n\nselect unix_timestamp('2015-05-15 12:00:00Z');\n+----------------------------------------+\n| unix_timestamp('2015-05-15 12:00:00z') |\n+----------------------------------------+\n| 1431691200                             |\n+----------------------------------------+\n\nselect unix_timestamp\n(\n  'May 15, 2015 12:00:00',\n  'MMM dd, yyyy HH:mm:ss'\n) as may_15_month_day_year;\n+-----------------------+\n| may_15_month_day_year |\n+-----------------------+\n| 1431691200            |\n+-----------------------+\n\n-- 2 ways of expressing the same date and time but in a different timezone.\n-- The resulting integer is different from the previous examples.\n\nselect unix_timestamp\n(\n  '2015-05-15 12:00:00-07:00',\n  'yyyy-MM-dd HH:mm:ss-hh:mm'\n) as may_15_year_month_day;\n+-----------------------+\n| may_15_year_month_day |\n+-----------------------+\n| 1431716400            |\n+-----------------------+\n\nselect unix_timestamp\n  (to_utc_timestamp(\n    '2015-05-15 12:00:00',\n    'PDT')\n  ) as may_15_pdt;\n+------------+\n| may_15_pdt |\n+------------+\n| 1431716400 |\n+------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">utc_timestamp()</span></dt><dd><b>Purpose:</b> Returns a <span class=\"hue-doc-codeph\">TIMESTAMP</span> corresponding to the current\n          date and time in the UTC time zone.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Added in:</b>Impala 2.10</p><p><b>Usage notes:</b></p><p>\n            Similar to the <span class=\"hue-doc-codeph\">now()</span> or <span class=\"hue-doc-codeph\">current_timestamp()</span> functions,\n            but does not use the local time zone as those functions do. Use <span class=\"hue-doc-codeph\">utc_timestamp()</span>\n            to record <span class=\"hue-doc-codeph\">TIMESTAMP</span> values that are interoperable with\n            servers around the world, in arbitrary time zones, without the need for\n            additional conversion functions to standardize the time zone of each\n            value representing a date/time.\n          </p><p>\n            For working with date/time values represented as integer values, you can convert\n            back and forth between <span class=\"hue-doc-codeph\">TIMESTAMP</span> and <span class=\"hue-doc-codeph\">BIGINT</span>\n            with the <span class=\"hue-doc-codeph\">unix_micros_to_utc_timestamp()</span> and\n            <span class=\"hue-doc-codeph\">utc_to_unix_micros()</span> functions. The integer values represent\n            the number of microseconds since the Unix epoch (midnight on January 1, 1970).\n          </p><p><b>Examples:</b></p><p>\n            The following example shows how <span class=\"hue-doc-codeph\">now()</span> and <span class=\"hue-doc-codeph\">current_timestamp()</span>\n            represent the current date/time in the local time zone (in this case, UTC-7), while\n            <span class=\"hue-doc-codeph\">utc_timestamp()</span> represents the same date/time in the standardized UTC\n            time zone:\n          </p><div class=\"hue-doc-codeblock\">\nselect now(), utc_timestamp();\n+-------------------------------+-------------------------------+\n| now()                         | utc_timestamp()               |\n+-------------------------------+-------------------------------+\n| 2017-10-01 23:33:58.919688000 | 2017-10-02 06:33:58.919688000 |\n+-------------------------------+-------------------------------+\n\nselect current_timestamp(), utc_timestamp();\n+-------------------------------+-------------------------------+\n| current_timestamp()           | utc_timestamp()               |\n+-------------------------------+-------------------------------+\n| 2017-10-01 23:34:07.400642000 | 2017-10-02 06:34:07.400642000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">week(timestamp date)</span>, <span class=\"hue-doc-codeph\">weekofyear(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the corresponding week (1-53) from the date portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, weekofyear(now()) as this_week;\n+-------------------------------+-----------+\n| right_now                     | this_week |\n+-------------------------------+-----------+\n| 2016-06-01 22:40:06.763771000 | 22        |\n+-------------------------------+-----------+\n\nselect now() + interval 2 weeks as in_2_weeks,\n  weekofyear(now() + interval 2 weeks) as week_after_next;\n+-------------------------------+-----------------+\n| in_2_weeks                    | week_after_next |\n+-------------------------------+-----------------+\n| 2016-06-15 22:41:22.098823000 | 24              |\n+-------------------------------+-----------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">weeks_add(timestamp date, int weeks)</span>, <span class=\"hue-doc-codeph\">weeks_add(timestamp date, bigint\n          weeks)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of weeks.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, weeks_add(now(), 2) as week_after_next;\n+-------------------------------+-------------------------------+\n| right_now                     | week_after_next               |\n+-------------------------------+-------------------------------+\n| 2016-06-01 22:43:20.973834000 | 2016-06-15 22:43:20.973834000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">weeks_sub(timestamp date, int weeks)</span>, <span class=\"hue-doc-codeph\">weeks_sub(timestamp date, bigint\n          weeks)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of weeks.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, weeks_sub(now(), 2) as week_before_last;\n+-------------------------------+-------------------------------+\n| right_now                     | week_before_last              |\n+-------------------------------+-------------------------------+\n| 2016-06-01 22:44:21.291913000 | 2016-05-18 22:44:21.291913000 |\n+-------------------------------+-------------------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">year(timestamp date)</span></dt><dd><b>Purpose:</b> Returns the year field from the date portion of a <span class=\"hue-doc-codeph\">TIMESTAMP</span>.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">int</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, year(now()) as this_year;\n+-------------------------------+-----------+\n| right_now                     | this_year |\n+-------------------------------+-----------+\n| 2016-06-01 22:46:23.647925000 | 2016      |\n+-------------------------------+-----------+\n</div></dd><dt><span class=\"hue-doc-codeph\">years_add(timestamp date, int years)</span>, <span class=\"hue-doc-codeph\">years_add(timestamp date, bigint\n          years)</span></dt><dd><b>Purpose:</b> Returns the specified date and time plus some number of years.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, years_add(now(), 1) as next_year;\n+-------------------------------+-------------------------------+\n| right_now                     | next_year                     |\n+-------------------------------+-------------------------------+\n| 2016-06-01 22:47:45.556851000 | 2017-06-01 22:47:45.556851000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following example shows how if the equivalent date does not exist in the\n            year of the result due to a leap year, the date is changed to the last day of the appropriate month.\n          </p><div class=\"hue-doc-codeblock\">\n-- Spoiler alert: there is no Feb. 29, 2017\nselect cast('2016-02-29' as timestamp) as feb_29_2016,\n  years_add('2016-02-29', 1) as feb_29_2017;\n+---------------------+---------------------+\n| feb_29_2016         | feb_29_2017         |\n+---------------------+---------------------+\n| 2016-02-29 00:00:00 | 2017-02-28 00:00:00 |\n+---------------------+---------------------+\n</div></dd><dt><span class=\"hue-doc-codeph\">years_sub(timestamp date, int years)</span>, <span class=\"hue-doc-codeph\">years_sub(timestamp date, bigint\n          years)</span></dt><dd><b>Purpose:</b> Returns the specified date and time minus some number of years.\n          <p><b>Return type:</b><span class=\"hue-doc-codeph\">timestamp</span></p><p><b>Examples:</b></p><div class=\"hue-doc-codeblock\">\nselect now() as right_now, years_sub(now(), 1) as last_year;\n+-------------------------------+-------------------------------+\n| right_now                     | last_year                     |\n+-------------------------------+-------------------------------+\n| 2016-06-01 22:48:11.851780000 | 2015-06-01 22:48:11.851780000 |\n+-------------------------------+-------------------------------+\n</div><p>\n            The following example shows how if the equivalent date does not exist in the\n            year of the result due to a leap year, the date is changed to the last day of the appropriate month.\n          </p><div class=\"hue-doc-codeblock\">\n-- Spoiler alert: there is no Feb. 29, 2015\nselect cast('2016-02-29' as timestamp) as feb_29_2016,\n  years_sub('2016-02-29', 1) as feb_29_2015;\n+---------------------+---------------------+\n| feb_29_2016         | feb_29_2015         |\n+---------------------+---------------------+\n| 2016-02-29 00:00:00 | 2015-02-28 00:00:00 |\n+---------------------+---------------------+\n</div></dd></dl></div></div></div>","title":"Impala Date and Time Functions"}