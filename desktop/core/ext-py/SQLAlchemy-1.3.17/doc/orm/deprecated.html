<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
            
    
    Deprecated ORM Event Interfaces
 &mdash;
    SQLAlchemy 1.3 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 1.3 Documentation" href="../index.html" />
        <link rel="up" title="Events and Internals" href="extending.html" />
        <link rel="next" title="ORM Extensions" href="extensions/index.html" />
        <link rel="prev" title="ORM Exceptions" href="exceptions.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">1.3.17</span>


        | Release Date: May 13, 2020

    </div>

    <h1>SQLAlchemy 1.3 Documentation</h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">


        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 1.3 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../contents.html">Contents</a> |
                <a href="../genindex.html">Index</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="SQLAlchemy ORM">SQLAlchemy ORM</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="tutorial.html">Object Relational Tutorial</a></span></li>
<li><span class="link-container"><a class="reference external" href="mapper_config.html">Mapper Configuration</a></span></li>
<li><span class="link-container"><a class="reference external" href="relationships.html">Relationship Configuration</a></span></li>
<li><span class="link-container"><a class="reference external" href="loading_objects.html">Loading Objects</a></span></li>
<li><span class="link-container"><a class="reference external" href="session.html">Using the Session</a></span></li>
<li><span class="link-container"><a class="reference external" href="extending.html">Events and Internals</a></span><ul>
<li><span class="link-container"><a class="reference external" href="events.html">ORM Events</a></span></li>
<li><span class="link-container"><a class="reference external" href="internals.html">ORM Internals</a></span></li>
<li><span class="link-container"><a class="reference external" href="exceptions.html">ORM Exceptions</a></span></li>
<li class="selected"><span class="link-container"><strong>Deprecated ORM Event Interfaces</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span><ul>
<li><span class="link-container"><a class="reference external" href="#mapper-events">Mapper Events</a></span></li>
<li><span class="link-container"><a class="reference external" href="#session-events">Session Events</a></span></li>
<li><span class="link-container"><a class="reference external" href="#attribute-events">Attribute Events</a></span></li>
</ul>
</li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="extensions/index.html">ORM Extensions</a></span></li>
<li><span class="link-container"><a class="reference external" href="examples.html">ORM Examples</a></span></li>
</ul>



        </div>

        </div>

    </div>

    

    <div id="docs-body" class="withsidebar" >
        
<div class="section" id="module-sqlalchemy.orm.interfaces">
<span id="deprecated-orm-event-interfaces"></span><span id="dep-interfaces-orm-toplevel"></span><h1>Deprecated ORM Event Interfaces<a class="headerlink" href="#module-sqlalchemy.orm.interfaces" title="Permalink to this headline">¶</a></h1>
<p>This section describes the class-based ORM event interface which first
existed in SQLAlchemy 0.1, which progressed with more kinds of events up
until SQLAlchemy 0.5.  The non-ORM analogue is described at <a class="reference internal" href="../core/interfaces.html"><span class="std std-ref">Deprecated Event Interfaces</span></a>.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.7: </span>As of SQLAlchemy 0.7, the new event system described in
<a class="reference internal" href="../core/event.html"><span class="std std-ref">Events</span></a> replaces the extension/proxy/listener system, providing
a consistent interface to all events without the need for subclassing.</p>
</div>
<div class="section" id="mapper-events">
<h2>Mapper Events<a class="headerlink" href="#mapper-events" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="sqlalchemy.orm.interfaces.MapperExtension">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.orm.interfaces.</code><code class="sig-name descname">MapperExtension</code><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension" title="Permalink to this definition">¶</a></dt>
<dd><p>Base implementation for <a class="reference internal" href="mapping_api.html#sqlalchemy.orm.Mapper" title="sqlalchemy.orm.Mapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Mapper</span></code></a> event hooks.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.7: </span><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapperExtension</span></code></a> is deprecated and will be removed in a future
release.  Please refer to <a class="reference internal" href="../core/event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> in conjunction with
the <a class="reference internal" href="events.html#sqlalchemy.orm.events.MapperEvents" title="sqlalchemy.orm.events.MapperEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapperEvents</span></code></a> listener interface.</p>
</div>
<p>New extension classes subclass <a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapperExtension</span></code></a> and are specified
using the <code class="docutils literal notranslate"><span class="pre">extension</span></code> mapper() argument, which is a single
<a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension" title="sqlalchemy.orm.interfaces.MapperExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">MapperExtension</span></code></a> or a list of such:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="k">import</span> <span class="n">MapperExtension</span>

<span class="k">class</span> <span class="nc">MyExtension</span><span class="p">(</span><span class="n">MapperExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;instance </span><span class="si">%s</span><span class="s2"> before insert !&quot;</span> <span class="o">%</span> <span class="n">instance</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">users_table</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyExtension</span><span class="p">())</span></pre></div>
</div>
<p>A single mapper can maintain a chain of <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
objects. When a particular mapping event occurs, the
corresponding method on each <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code> is invoked
serially, and each method has the ability to halt the chain
from proceeding further:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">mapper</span><span class="p">(</span><span class="n">User</span><span class="p">,</span> <span class="n">users_table</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="p">[</span><span class="n">ext1</span><span class="p">,</span> <span class="n">ext2</span><span class="p">,</span> <span class="n">ext3</span><span class="p">])</span></pre></div>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code> method returns the symbol
EXT_CONTINUE by default.   This symbol generally means “move
to the next <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code> for processing”.  For methods
that return objects like translated rows or new object
instances, EXT_CONTINUE means the result of the method
should be ignored.   In some cases it’s required for a
default mapper activity to be performed, such as adding a
new instance to a result list.</p>
<p>The symbol EXT_STOP has significance within a chain
of <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code> objects that the chain will be stopped
when this symbol is returned.  Like EXT_CONTINUE, it also
has additional significance in some cases that a default
mapper activity will not be performed.</p>
<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.after_delete">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">after_delete</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance after that instance is deleted.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.after_insert">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">after_insert</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance after that instance is inserted.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.after_update">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">after_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.after_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance after that instance is updated.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.before_delete">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">before_delete</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance before that instance is deleted.</p>
<p>Note that <em>no</em> changes to the overall flush plan can be made
here; and manipulation of the <code class="docutils literal notranslate"><span class="pre">Session</span></code> will not have the
desired effect. To manipulate the <code class="docutils literal notranslate"><span class="pre">Session</span></code> within an
extension, use <code class="docutils literal notranslate"><span class="pre">SessionExtension</span></code>.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.before_insert">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">before_insert</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance before that instance is inserted
into its table.</p>
<p>This is a good place to set up primary key values and such
that aren’t handled otherwise.</p>
<p>Column-based attributes can be modified within this method
which will result in the new value being inserted.  However
<em>no</em> changes to the overall flush plan can be made, and
manipulation of the <code class="docutils literal notranslate"><span class="pre">Session</span></code> will not have the desired effect.
To manipulate the <code class="docutils literal notranslate"><span class="pre">Session</span></code> within an extension, use
<code class="docutils literal notranslate"><span class="pre">SessionExtension</span></code>.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.before_update">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">before_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">connection</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.before_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance before that instance is updated.</p>
<p>Note that this method is called for all instances that are marked as
“dirty”, even those which have no net changes to their column-based
attributes. An object is marked as dirty when any of its column-based
attributes have a “set attribute” operation called or when any of its
collections are modified. If, at update time, no column-based
attributes have any net changes, no UPDATE statement will be issued.
This means that an instance being sent to before_update is <em>not</em> a
guarantee that an UPDATE statement will be issued (although you can
affect the outcome here).</p>
<p>To detect if the column-based attributes on the object have net
changes, and will therefore generate an UPDATE statement, use
<code class="docutils literal notranslate"><span class="pre">object_session(instance).is_modified(instance,</span>
<span class="pre">include_collections=False)</span></code>.</p>
<p>Column-based attributes can be modified within this method
which will result in the new value being updated.  However
<em>no</em> changes to the overall flush plan can be made, and
manipulation of the <code class="docutils literal notranslate"><span class="pre">Session</span></code> will not have the desired effect.
To manipulate the <code class="docutils literal notranslate"><span class="pre">Session</span></code> within an extension, use
<code class="docutils literal notranslate"><span class="pre">SessionExtension</span></code>.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.init_failed">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">init_failed</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">class_</span></em>, <em class="sig-param"><span class="n">oldinit</span></em>, <em class="sig-param"><span class="n">instance</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.init_failed" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an instance when its constructor has been called,
and raised an exception.</p>
<p>This method is only called during a userland construction of
an object.  It is not called when an object is loaded from the
database.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.init_instance">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">init_instance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">class_</span></em>, <em class="sig-param"><span class="n">oldinit</span></em>, <em class="sig-param"><span class="n">instance</span></em>, <em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.init_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an instance when its constructor is called.</p>
<p>This method is only called during a userland construction of
an object.  It is not called when an object is loaded from the
database.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.instrument_class">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">instrument_class</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">class_</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.instrument_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a class when the mapper is first constructed, and has
applied instrumentation to the mapped class.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.MapperExtension.reconstruct_instance">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.MapperExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.MapperExtension.</span></code></a><code class="sig-name descname">reconstruct_instance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapper</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.MapperExtension.reconstruct_instance" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive an object instance after it has been created via
<code class="docutils literal notranslate"><span class="pre">__new__</span></code>, and after initial attribute population has
occurred.</p>
<p>This typically occurs when the instance is created based on
incoming result rows, and is only called once for that
instance’s lifetime.</p>
<p>Note that during a result-row load, this method is called upon
the first row received for this instance.  Note that some
attributes and collections may or may not be loaded or even
initialized, depending on what’s present in the result rows.</p>
<p>The return value is only significant within the <code class="docutils literal notranslate"><span class="pre">MapperExtension</span></code>
chain; the parent mapper’s behavior isn’t modified by this method.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="session-events">
<h2>Session Events<a class="headerlink" href="#session-events" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="sqlalchemy.orm.interfaces.SessionExtension">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.orm.interfaces.</code><code class="sig-name descname">SessionExtension</code><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension" title="Permalink to this definition">¶</a></dt>
<dd><p>Base implementation for <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> event hooks.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.7: </span><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension" title="sqlalchemy.orm.interfaces.SessionExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionExtension</span></code></a> is deprecated and will be removed in a future
release.  Please refer to <a class="reference internal" href="../core/event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> in conjunction with
the <a class="reference internal" href="events.html#sqlalchemy.orm.events.SessionEvents" title="sqlalchemy.orm.events.SessionEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionEvents</span></code></a> listener interface.</p>
</div>
<p>Subclasses may be installed into a <a class="reference internal" href="session_api.html#sqlalchemy.orm.session.Session" title="sqlalchemy.orm.session.Session"><code class="xref py py-class docutils literal notranslate"><span class="pre">Session</span></code></a> (or
<a class="reference internal" href="session_api.html#sqlalchemy.orm.session.sessionmaker" title="sqlalchemy.orm.session.sessionmaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">sessionmaker</span></code></a>) using the <code class="docutils literal notranslate"><span class="pre">extension</span></code> keyword
argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="k">import</span> <span class="n">SessionExtension</span>

<span class="k">class</span> <span class="nc">MySessionExtension</span><span class="p">(</span><span class="n">SessionExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before_commit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">session</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;before commit!&quot;</span>

<span class="n">Session</span> <span class="o">=</span> <span class="n">sessionmaker</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="n">MySessionExtension</span><span class="p">())</span></pre></div>
</div>
<p>The same <a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension" title="sqlalchemy.orm.interfaces.SessionExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">SessionExtension</span></code></a> instance can be used
with any number of sessions.</p>
<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_attach">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_attach</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">instance</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_attach" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after an instance is attached to a session.</p>
<p>This is called after an add, delete or merge.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_begin">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_begin</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">transaction</span></em>, <em class="sig-param"><span class="n">connection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after a transaction is begun on a connection</p>
<p><cite>transaction</cite> is the SessionTransaction. This method is called
after an engine level transaction is begun on a connection.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_bulk_delete">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_bulk_delete</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">query</span></em>, <em class="sig-param"><span class="n">query_context</span></em>, <em class="sig-param"><span class="n">result</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_bulk_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after a bulk delete operation to the session.</p>
<p>This is called after a session.query(…).delete()</p>
<p><cite>query</cite> is the query object that this delete operation was
called on. <cite>query_context</cite> was the query context object.
<cite>result</cite> is the result object returned from the bulk operation.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_bulk_update">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_bulk_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">query</span></em>, <em class="sig-param"><span class="n">query_context</span></em>, <em class="sig-param"><span class="n">result</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_bulk_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after a bulk update operation to the session.</p>
<p>This is called after a session.query(…).update()</p>
<p><cite>query</cite> is the query object that this update operation was
called on. <cite>query_context</cite> was the query context object.
<cite>result</cite> is the result object returned from the bulk operation.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_commit">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_commit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after a commit has occurred.</p>
<p>Note that this may not be per-flush if a longer running
transaction is ongoing.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_flush">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_flush</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">flush_context</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after flush has completed, but before commit has been
called.</p>
<p>Note that the session’s state is still in pre-flush, i.e. ‘new’,
‘dirty’, and ‘deleted’ lists still show pre-flush state as well
as the history settings on instance attributes.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_flush_postexec">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_flush_postexec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">flush_context</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_flush_postexec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after flush has completed, and after the post-exec
state occurs.</p>
<p>This will be when the ‘new’, ‘dirty’, and ‘deleted’ lists are in
their final state.  An actual commit() may or may not have
occurred, depending on whether or not the flush started its own
transaction or participated in a larger transaction.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.after_rollback">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">after_rollback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.after_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute after a rollback has occurred.</p>
<p>Note that this may not be per-flush if a longer running
transaction is ongoing.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.before_commit">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">before_commit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.before_commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute right before commit is called.</p>
<p>Note that this may not be per-flush if a longer running
transaction is ongoing.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.SessionExtension.before_flush">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.SessionExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.SessionExtension.</span></code></a><code class="sig-name descname">before_flush</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">session</span></em>, <em class="sig-param"><span class="n">flush_context</span></em>, <em class="sig-param"><span class="n">instances</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.SessionExtension.before_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute before flush process has started.</p>
<p><cite>instances</cite> is an optional list of objects which were passed to
the <code class="docutils literal notranslate"><span class="pre">flush()</span></code> method.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="attribute-events">
<h2>Attribute Events<a class="headerlink" href="#attribute-events" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="sqlalchemy.orm.interfaces.AttributeExtension">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.orm.interfaces.</code><code class="sig-name descname">AttributeExtension</code><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="Permalink to this definition">¶</a></dt>
<dd><p>Base implementation for <code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeImpl</span></code> event hooks, events
that fire upon attribute mutations in user code.</p>
<div class="deprecated">
<p><span class="versionmodified deprecated">Deprecated since version 0.7: </span><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeExtension</span></code></a> is deprecated and will be removed in a
future release.  Please refer to <a class="reference internal" href="../core/event.html#sqlalchemy.event.listen" title="sqlalchemy.event.listen"><code class="xref py py-func docutils literal notranslate"><span class="pre">listen()</span></code></a> in conjunction
with the <a class="reference internal" href="events.html#sqlalchemy.orm.events.AttributeEvents" title="sqlalchemy.orm.events.AttributeEvents"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeEvents</span></code></a> listener interface.</p>
</div>
<p><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeExtension</span></code></a> is used to listen for set,
remove, and append events on individual mapped attributes.
It is established on an individual mapped attribute using
the <cite>extension</cite> argument, available on
<a class="reference internal" href="mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal notranslate"><span class="pre">column_property()</span></code></a>, <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a>, and
others:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.orm.interfaces</span> <span class="k">import</span> <span class="n">AttributeExtension</span>
<span class="kn">from</span> <span class="nn">sqlalchemy.orm</span> <span class="k">import</span> <span class="n">mapper</span><span class="p">,</span> <span class="n">relationship</span><span class="p">,</span> <span class="n">column_property</span>

<span class="k">class</span> <span class="nc">MyAttrExt</span><span class="p">(</span><span class="n">AttributeExtension</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;append event !&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">oldvalue</span><span class="p">,</span> <span class="n">initiator</span><span class="p">):</span>
        <span class="nb">print</span> <span class="s2">&quot;set event !&quot;</span>
        <span class="k">return</span> <span class="n">value</span>

<span class="n">mapper</span><span class="p">(</span><span class="n">SomeClass</span><span class="p">,</span> <span class="n">sometable</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;foo&#39;</span><span class="p">:</span><span class="n">column_property</span><span class="p">(</span><span class="n">sometable</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyAttrExt</span><span class="p">()),</span>
    <span class="s1">&#39;bar&#39;</span><span class="p">:</span><span class="n">relationship</span><span class="p">(</span><span class="n">Bar</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="n">MyAttrExt</span><span class="p">())</span>
<span class="p">})</span></pre></div>
</div>
<p>Note that the <a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension" title="sqlalchemy.orm.interfaces.AttributeExtension"><code class="xref py py-class docutils literal notranslate"><span class="pre">AttributeExtension</span></code></a> methods
<a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension.append" title="sqlalchemy.orm.interfaces.AttributeExtension.append"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AttributeExtension.append()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension.set" title="sqlalchemy.orm.interfaces.AttributeExtension.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">AttributeExtension.set()</span></code></a> need to return the
<code class="docutils literal notranslate"><span class="pre">value</span></code> parameter. The returned value is used as the
effective value, and allows the extension to change what is
ultimately persisted.</p>
<p>AttributeExtension is assembled within the descriptors associated
with a mapped class.</p>
<dl class="py attribute">
<dt id="sqlalchemy.orm.interfaces.AttributeExtension.active_history">
<em class="property">attribute </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.AttributeExtension.</span></code></a><code class="sig-name descname">active_history</code><em class="property"> = True</em><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.active_history" title="Permalink to this definition">¶</a></dt>
<dd><p>indicates that the set() method would like to receive the ‘old’ value,
even if it means firing lazy callables.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">active_history</span></code> can also be set directly via
<a class="reference internal" href="mapping_columns.html#sqlalchemy.orm.column_property" title="sqlalchemy.orm.column_property"><code class="xref py py-func docutils literal notranslate"><span class="pre">column_property()</span></code></a> and <a class="reference internal" href="relationship_api.html#sqlalchemy.orm.relationship" title="sqlalchemy.orm.relationship"><code class="xref py py-func docutils literal notranslate"><span class="pre">relationship()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.AttributeExtension.append">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.AttributeExtension.</span></code></a><code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">initiator</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a collection append event.</p>
<p>The returned value will be used as the actual value to be
appended.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.AttributeExtension.remove">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.AttributeExtension.</span></code></a><code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">initiator</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a remove event.</p>
<p>No return value is defined.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.orm.interfaces.AttributeExtension.set">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.orm.interfaces.AttributeExtension"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.orm.interfaces.AttributeExtension.</span></code></a><code class="sig-name descname">set</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">oldvalue</span></em>, <em class="sig-param"><span class="n">initiator</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.orm.interfaces.AttributeExtension.set" title="Permalink to this definition">¶</a></dt>
<dd><p>Receive a set event.</p>
<p>The returned value will be used as the actual value to be
set.</p>
</dd></dl>

</dd></dl>

</div>
</div>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="exceptions.html" title="previous chapter">ORM Exceptions</a>
        Next:
        <a href="extensions/index.html" title="next chapter">ORM Extensions</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2020, the SQLAlchemy authors and contributors.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.0.3.
    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '1.3.17',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/detectmobile.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


