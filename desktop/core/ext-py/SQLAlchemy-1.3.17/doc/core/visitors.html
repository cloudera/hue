<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">



<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        
        <title>
            
    
    Visitor and Traversal Utilities
 &mdash;
    SQLAlchemy 1.3 Documentation

        </title>

        
            <!-- begin iterate through site-imported + sphinx environment css_files -->
                <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
                <link rel="stylesheet" href="../_static/docs.css" type="text/css" />
                <link rel="stylesheet" href="../_static/changelog.css" type="text/css" />
                <link rel="stylesheet" href="../_static/sphinx_paramlinks.css" type="text/css" />
            <!-- end iterate through site-imported + sphinx environment css_files -->
        

        

    

    <!-- begin layout.mako headers -->

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
        <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="SQLAlchemy 1.3 Documentation" href="../index.html" />
        <link rel="up" title="SQL Statements and Expressions API" href="expression_api.html" />
        <link rel="next" title="Schema Definition Language" href="schema.html" />
        <link rel="prev" title="Expression Serializer Extension" href="serializer.html" />
    <!-- end layout.mako headers -->


    </head>
    <body>
        
















<div id="docs-container">





<div id="docs-top-navigation-container" class="body-background">
<div id="docs-header">
    <div id="docs-version-header">
        Release: <span class="version-num">1.3.17</span>


        | Release Date: May 13, 2020

    </div>

    <h1>SQLAlchemy 1.3 Documentation</h1>

</div>
</div>

<div id="docs-body-container">

    <div id="fixed-sidebar" class="withsidebar">


        <div id="docs-sidebar-popout">
            <h3><a href="../index.html">SQLAlchemy 1.3 Documentation</a></h3>
            <p id="sidebar-topnav">
                <a href="../contents.html">Contents</a> |
                <a href="../genindex.html">Index</a>
            </p>

            <div id="sidebar-search">
                <form class="search" action="../search.html" method="get">
                  <label>
                  Search terms:
                  <input type="text" placeholder="search..." name="q" size="12" />
                  </label>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </div>

        </div>

        <div id="docs-sidebar">

        <div id="sidebar-banner">
            
        </div>

        <div id="docs-sidebar-inner">

        
        <h3>
            <a href="index.html" title="SQLAlchemy Core">SQLAlchemy Core</a>
        </h3>

        <ul>
<li><span class="link-container"><a class="reference external" href="tutorial.html">SQL Expression Language Tutorial</a></span></li>
<li><span class="link-container"><a class="reference external" href="expression_api.html">SQL Statements and Expressions API</a></span><ul>
<li><span class="link-container"><a class="reference external" href="sqlelement.html">Column Elements and Expressions</a></span></li>
<li><span class="link-container"><a class="reference external" href="selectable.html">Selectables, Tables, FROM objects</a></span></li>
<li><span class="link-container"><a class="reference external" href="dml.html">Insert, Updates, Deletes</a></span></li>
<li><span class="link-container"><a class="reference external" href="functions.html">SQL and Generic Functions</a></span></li>
<li><span class="link-container"><a class="reference external" href="compiler.html">Custom SQL Constructs and Compilation Extension</a></span></li>
<li><span class="link-container"><a class="reference external" href="serializer.html">Expression Serializer Extension</a></span></li>
<li class="selected"><span class="link-container"><strong>Visitor and Traversal Utilities</strong><a class="paramlink headerlink reference internal" href="#">¶</a></span></li>
</ul>
</li>
<li><span class="link-container"><a class="reference external" href="schema.html">Schema Definition Language</a></span></li>
<li><span class="link-container"><a class="reference external" href="types.html">Column and Data Types</a></span></li>
<li><span class="link-container"><a class="reference external" href="engines_connections.html">Engine and Connection Use</a></span></li>
<li><span class="link-container"><a class="reference external" href="api_basics.html">Core API Basics</a></span></li>
</ul>



        </div>

        </div>

    </div>

    

    <div id="docs-body" class="withsidebar" >
        
<div class="section" id="visitor-and-traversal-utilities">
<h1>Visitor and Traversal Utilities<a class="headerlink" href="#visitor-and-traversal-utilities" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-sqlalchemy.sql.visitors" title="sqlalchemy.sql.visitors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors</span></code></a> module consists of classes and functions
that serve the purpose of generically <strong>traversing</strong> a Core SQL expression
structure.   This is not unlike the Python <code class="docutils literal notranslate"><span class="pre">ast</span></code> module in that is presents
a system by which a program can operate upon each component of a SQL
expression.   Common purposes this serves are locating various kinds of
elements such as <a class="reference internal" href="metadata.html#sqlalchemy.schema.Table" title="sqlalchemy.schema.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> or <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.BindParameter" title="sqlalchemy.sql.expression.BindParameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">BindParameter</span></code></a> objects,
as well as altering the state of the structure such as replacing certain FROM
clauses with others.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the <a class="reference internal" href="#module-sqlalchemy.sql.visitors" title="sqlalchemy.sql.visitors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors</span></code></a> module is an internal API and
is not fully public.    It is subject to change and may additionally not
function as expected for use patterns that aren’t considered within
SQLAlchemy’s own internals.</p>
</div>
<p>The <a class="reference internal" href="#module-sqlalchemy.sql.visitors" title="sqlalchemy.sql.visitors"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors</span></code></a> module is part of the <strong>internals</strong> of
SQLAlchemy and it is not usually used by calling application code.  It is
however used in certain edge cases such as when constructing caching routines
as well as when building out custom SQL expressions using the
<a class="reference internal" href="compiler.html"><span class="std std-ref">Custom SQL Constructs and Compilation Extension</span></a>.</p>
<span class="target" id="module-sqlalchemy.sql.visitors"></span><p>Visitor/traversal interface and library functions.</p>
<p>SQLAlchemy schema and expression constructs rely on a Python-centric
version of the classic “visitor” pattern as the primary way in which
they apply functionality.  The most common use of this pattern
is statement compilation, where individual expression classes match
up to rendering methods that produce a string result.   Beyond this,
the visitor system is also used to inspect expressions for various
information and patterns, as well as for the purposes of applying
transformations to expressions.</p>
<p>Examples of how the visit system is used can be seen in the source code
of for example the <code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.util</span></code> and the <code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.compiler</span></code>
modules.  Some background on clause adaption is also at
<a class="reference external" href="http://techspot.zzzeek.org/2008/01/23/expression-transformations/">http://techspot.zzzeek.org/2008/01/23/expression-transformations/</a> .</p>
<dl class="py class">
<dt id="sqlalchemy.sql.visitors.VisitableType">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">VisitableType</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">clsname</span></em>, <em class="sig-param"><span class="n">bases</span></em>, <em class="sig-param"><span class="n">clsdict</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.VisitableType" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="docutils literal notranslate"><span class="pre">builtins.type</span></code></p>
<p>Metaclass which assigns a <code class="docutils literal notranslate"><span class="pre">_compiler_dispatch</span></code> method to classes
having a <code class="docutils literal notranslate"><span class="pre">__visit_name__</span></code> attribute.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_compiler_dispatch</span></code> attribute becomes an instance method which
looks approximately like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">_compiler_dispatch</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visitor</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Look for an attribute named &quot;visit_&quot; + self.__visit_name__</span>
<span class="sd">    on the visitor, and call it with the same kw params.&#39;&#39;&#39;</span>
    <span class="n">visit_attr</span> <span class="o">=</span> <span class="s1">&#39;visit_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">__visit_name__</span>
    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">visitor</span><span class="p">,</span> <span class="n">visit_attr</span><span class="p">)(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span></pre></div>
</div>
<p>Classes having no <code class="docutils literal notranslate"><span class="pre">__visit_name__</span></code> attribute will remain unaffected.</p>
</dd></dl>

<dl class="py class">
<dt id="sqlalchemy.sql.visitors.Visitable">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">Visitable</code><a class="headerlink" href="#sqlalchemy.sql.visitors.Visitable" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for visitable objects, applies the
<a class="reference internal" href="#sqlalchemy.sql.visitors.VisitableType" title="sqlalchemy.sql.visitors.VisitableType"><code class="xref py py-class docutils literal notranslate"><span class="pre">VisitableType</span></code></a> metaclass.</p>
<p>The <a class="reference internal" href="#sqlalchemy.sql.visitors.Visitable" title="sqlalchemy.sql.visitors.Visitable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Visitable</span></code></a> class is essentially at the base of the
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a> hierarchy.</p>
</dd></dl>

<dl class="py class">
<dt id="sqlalchemy.sql.visitors.ClauseVisitor">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">ClauseVisitor</code><a class="headerlink" href="#sqlalchemy.sql.visitors.ClauseVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for visitor objects which can traverse using
the <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a> function.</p>
<p>Direct usage of the <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a> function is usually
preferred.</p>
<dl class="py method">
<dt id="sqlalchemy.sql.visitors.ClauseVisitor.chain">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ClauseVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ClauseVisitor.</span></code></a><code class="sig-name descname">chain</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">visitor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.ClauseVisitor.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>‘chain’ an additional ClauseVisitor onto this ClauseVisitor.</p>
<p>the chained visitor will receive all visit events after this one.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.sql.visitors.ClauseVisitor.iterate">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ClauseVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ClauseVisitor.</span></code></a><code class="sig-name descname">iterate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.ClauseVisitor.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse the given expression structure, returning an iterator
of all elements.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.sql.visitors.ClauseVisitor.traverse">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ClauseVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ClauseVisitor.</span></code></a><code class="sig-name descname">traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.ClauseVisitor.traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse and visit the given expression structure.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sqlalchemy.sql.visitors.ClauseVisitor.visitor_iterator">
<em class="property">attribute </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ClauseVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ClauseVisitor.</span></code></a><code class="sig-name descname">visitor_iterator</code><a class="headerlink" href="#sqlalchemy.sql.visitors.ClauseVisitor.visitor_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>iterate through this visitor and each ‘chained’ visitor.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sqlalchemy.sql.visitors.CloningVisitor">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">CloningVisitor</code><a class="headerlink" href="#sqlalchemy.sql.visitors.CloningVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.sql.visitors.ClauseVisitor" title="sqlalchemy.sql.visitors.ClauseVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ClauseVisitor</span></code></a></p>
<p>Base class for visitor objects which can traverse using
the <a class="reference internal" href="#sqlalchemy.sql.visitors.cloned_traverse" title="sqlalchemy.sql.visitors.cloned_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cloned_traverse()</span></code></a> function.</p>
<p>Direct usage of the <a class="reference internal" href="#sqlalchemy.sql.visitors.cloned_traverse" title="sqlalchemy.sql.visitors.cloned_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cloned_traverse()</span></code></a> function is usually
preferred.</p>
<dl class="py method">
<dt id="sqlalchemy.sql.visitors.CloningVisitor.copy_and_process">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.CloningVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.CloningVisitor.</span></code></a><code class="sig-name descname">copy_and_process</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.CloningVisitor.copy_and_process" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply cloned traversal to the given list of elements, and return
the new list.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.sql.visitors.CloningVisitor.traverse">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.CloningVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.CloningVisitor.</span></code></a><code class="sig-name descname">traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.CloningVisitor.traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse and visit the given expression structure.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sqlalchemy.sql.visitors.ReplacingCloningVisitor">
<em class="property">class </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">ReplacingCloningVisitor</code><a class="headerlink" href="#sqlalchemy.sql.visitors.ReplacingCloningVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlalchemy.sql.visitors.CloningVisitor" title="sqlalchemy.sql.visitors.CloningVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.CloningVisitor</span></code></a></p>
<p>Base class for visitor objects which can traverse using
the <a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a> function.</p>
<p>Direct usage of the <a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a> function is
usually preferred.</p>
<dl class="py method">
<dt id="sqlalchemy.sql.visitors.ReplacingCloningVisitor.replace">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ReplacingCloningVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ReplacingCloningVisitor.</span></code></a><code class="sig-name descname">replace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elem</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.ReplacingCloningVisitor.replace" title="Permalink to this definition">¶</a></dt>
<dd><p>receive pre-copied elements during a cloning traversal.</p>
<p>If the method returns a new element, the element is used
instead of creating a simple copy of the element.  Traversal
will halt on the newly returned element if it is re-encountered.</p>
</dd></dl>

<dl class="py method">
<dt id="sqlalchemy.sql.visitors.ReplacingCloningVisitor.traverse">
<em class="property">method </em><a class="reference internal" href="#sqlalchemy.sql.visitors.ReplacingCloningVisitor"><code class="docutils literal notranslate"><span class="pre">sqlalchemy.sql.visitors.ReplacingCloningVisitor.</span></code></a><code class="sig-name descname">traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.ReplacingCloningVisitor.traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse and visit the given expression structure.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.iterate">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">iterate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse the given expression structure, returning an iterator.</p>
<p>traversal is configured to be breadth-first.</p>
<p>The central API feature used by the <a class="reference internal" href="#sqlalchemy.sql.visitors.iterate" title="sqlalchemy.sql.visitors.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst" title="sqlalchemy.sql.visitors.iterate_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate_depthfirst()</span></code></a> functions is the
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement.get_children" title="sqlalchemy.sql.expression.ClauseElement.get_children"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ClauseElement.get_children()</span></code></a> method of
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
objects.  This method should return all the
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a> objects
which are associated with a particular <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
object.
For example, a <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.Case" title="sqlalchemy.sql.expression.Case"><code class="xref py py-class docutils literal notranslate"><span class="pre">Case</span></code></a> structure will refer to a series of
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ColumnElement" title="sqlalchemy.sql.expression.ColumnElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnElement</span></code></a>
objects within its “whens” and “else_” member
variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.sql.visitors.iterate.params.obj"></span><strong>obj</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.iterate.params.obj">¶</a> – <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a> structure to be traversed</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.iterate.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.iterate.params.opts">¶</a> – dictionary of iteration options.   This dictionary is usually
empty in modern usage.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.iterate_depthfirst">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">iterate_depthfirst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.iterate_depthfirst" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse the given expression structure, returning an iterator.</p>
<p>traversal is configured to be depth-first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.sql.visitors.iterate_depthfirst.params.obj"></span><strong>obj</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst.params.obj">¶</a> – <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a> structure to be traversed</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.iterate_depthfirst.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst.params.opts">¶</a> – dictionary of iteration options.   This dictionary is usually
empty in modern usage.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.iterate" title="sqlalchemy.sql.visitors.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate()</span></code></a> - includes a general overview of iteration.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.traverse_using">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">traverse_using</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterator</span></em>, <em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">visitors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.traverse_using" title="Permalink to this definition">¶</a></dt>
<dd><p>visit the given expression structure using the given iterator of
objects.</p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.traverse_using" title="sqlalchemy.sql.visitors.traverse_using"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse_using()</span></code></a> is usually called internally as the result
of the <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a> or <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse_depthfirst" title="sqlalchemy.sql.visitors.traverse_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse_depthfirst()</span></code></a>
functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse_using.params.iterator"></span><strong>iterator</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse_using.params.iterator">¶</a> – an iterable or sequence which will yield
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
structures; the iterator is assumed to be the
product of the <a class="reference internal" href="#sqlalchemy.sql.visitors.iterate" title="sqlalchemy.sql.visitors.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate()</span></code></a> or
<a class="reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst" title="sqlalchemy.sql.visitors.iterate_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate_depthfirst()</span></code></a> functions.</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse_using.params.obj"></span><strong>obj</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse_using.params.obj">¶</a> – the <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
that was used as the target of the
<a class="reference internal" href="#sqlalchemy.sql.visitors.iterate" title="sqlalchemy.sql.visitors.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate()</span></code></a> or <a class="reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst" title="sqlalchemy.sql.visitors.iterate_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate_depthfirst()</span></code></a> function.</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse_using.params.visitors"></span><strong>visitors</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse_using.params.visitors">¶</a> – dictionary of visit functions.  See <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a>
for details on this dictionary.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.traverse_depthfirst" title="sqlalchemy.sql.visitors.traverse_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse_depthfirst()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.traverse">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em>, <em class="sig-param"><span class="n">visitors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse and visit the given expression structure using the default
iterator.</p>
<blockquote>
<div><p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlalchemy.sql</span> <span class="k">import</span> <span class="n">visitors</span>

<span class="n">stmt</span> <span class="o">=</span> <span class="n">select</span><span class="p">([</span><span class="n">some_table</span><span class="p">])</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">some_table</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">foo</span> <span class="o">==</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">visit_bindparam</span><span class="p">(</span><span class="n">bind_param</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;found bound value: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">bind_param</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

<span class="n">visitors</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">stmt</span><span class="p">,</span> <span class="p">{},</span> <span class="p">{</span><span class="s2">&quot;bindparam&quot;</span><span class="p">:</span> <span class="n">visit_bindparam</span><span class="p">})</span></pre></div>
</div>
</div></blockquote>
<p>The iteration of objects uses the <a class="reference internal" href="#sqlalchemy.sql.visitors.iterate" title="sqlalchemy.sql.visitors.iterate"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate()</span></code></a> function,
which does a breadth-first traversal using a stack.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse.params.obj"></span><strong>obj</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse.params.obj">¶</a> – <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a> structure to be traversed</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse.params.opts"></span><strong>opts</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse.params.opts">¶</a> – dictionary of iteration options.   This dictionary is usually
empty in modern usage.</p></li>
<li><p><span class="target" id="sqlalchemy.sql.visitors.traverse.params.visitors"></span><strong>visitors</strong><a class="paramlink headerlink reference internal" href="#sqlalchemy.sql.visitors.traverse.params.visitors">¶</a> – dictionary of visit functions.   The dictionary should
have strings as keys, each of which would correspond to the
<code class="docutils literal notranslate"><span class="pre">__visit_name__</span></code> of a particular kind of SQL expression object, and
callable functions  as values, each of which represents a visitor function
for that kind of object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.traverse_depthfirst">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">traverse_depthfirst</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em>, <em class="sig-param"><span class="n">visitors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.traverse_depthfirst" title="Permalink to this definition">¶</a></dt>
<dd><p>traverse and visit the given expression structure using the
depth-first iterator.</p>
<p>The iteration of objects uses the <a class="reference internal" href="#sqlalchemy.sql.visitors.iterate_depthfirst" title="sqlalchemy.sql.visitors.iterate_depthfirst"><code class="xref py py-func docutils literal notranslate"><span class="pre">iterate_depthfirst()</span></code></a>
function, which does a depth-first traversal using a stack.</p>
<p>Usage is the same as that of <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a> function.</p>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.cloned_traverse">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">cloned_traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em>, <em class="sig-param"><span class="n">visitors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.cloned_traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>clone the given expression structure, allowing modifications by
visitors.</p>
<p>Traversal usage is the same as that of <a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a>.
The visitor functions present in the <code class="docutils literal notranslate"><span class="pre">visitors</span></code> dictionary may also
modify the internals of the given structure as the traversal proceeds.</p>
<p>The central API feature used by the <a class="reference internal" href="#sqlalchemy.sql.visitors.cloned_traverse" title="sqlalchemy.sql.visitors.cloned_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cloned_traverse()</span></code></a>
and <a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a> functions, in addition to the
<a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement.get_children" title="sqlalchemy.sql.expression.ClauseElement.get_children"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ClauseElement.get_children()</span></code></a>
function that is used to achieve
the iteration, is the <code class="xref py py-meth docutils literal notranslate"><span class="pre">ClauseElement._copy_internals()</span></code>
method.
For a <a class="reference internal" href="sqlelement.html#sqlalchemy.sql.expression.ClauseElement" title="sqlalchemy.sql.expression.ClauseElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">ClauseElement</span></code></a>
structure to support cloning and replacement
traversals correctly, it needs to be able to pass a cloning function into
its internal members in order to make copies of them.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.traverse" title="sqlalchemy.sql.visitors.traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">traverse()</span></code></a></p>
<p><a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt id="sqlalchemy.sql.visitors.replacement_traverse">
<em class="property">function </em><code class="sig-prename descclassname">sqlalchemy.sql.visitors.</code><code class="sig-name descname">replacement_traverse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">opts</span></em>, <em class="sig-param"><span class="n">replace</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sqlalchemy.sql.visitors.replacement_traverse" title="Permalink to this definition">¶</a></dt>
<dd><p>clone the given expression structure, allowing element
replacement by a given replacement function.</p>
<p>This function is very similar to the <a class="reference internal" href="#sqlalchemy.sql.visitors.cloned_traverse" title="sqlalchemy.sql.visitors.cloned_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cloned_traverse()</span></code></a>
function, except instead of being passed a dictionary of visitors, all
elements are unconditionally passed into the given replace function.
The replace function then has the option to return an entirely new object
which will replace the one given.  if it returns <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the object
is kept in place.</p>
<p>The difference in usage between <a class="reference internal" href="#sqlalchemy.sql.visitors.cloned_traverse" title="sqlalchemy.sql.visitors.cloned_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">cloned_traverse()</span></code></a> and
<a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a> is that in the former case, an
already-cloned object is passed to the visitor function, and the visitor
function can then manipulate the internal state of the object.
In the case of the latter, the visitor function should only return an
entirely different object, or do nothing.</p>
<p>The use case for <a class="reference internal" href="#sqlalchemy.sql.visitors.replacement_traverse" title="sqlalchemy.sql.visitors.replacement_traverse"><code class="xref py py-func docutils literal notranslate"><span class="pre">replacement_traverse()</span></code></a> is that of
replacing a FROM clause inside of a SQL structure with a different one,
as is a common use case within the ORM.</p>
</dd></dl>

</div>

    </div>

</div>

<div id="docs-bottom-navigation" class="docs-navigation-links, withsidebar">
        Previous:
        <a href="serializer.html" title="previous chapter">Expression Serializer Extension</a>
        Next:
        <a href="schema.html" title="next chapter">Schema Definition Language</a>

    <div id="docs-copyright">
        &copy; <a href="../copyright.html">Copyright</a> 2007-2020, the SQLAlchemy authors and contributors.
        Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 3.0.3.
    </div>
</div>

</div>



        
        

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '../',
          VERSION:     '1.3.17',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>

    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>

    <!-- begin iterate through sphinx environment script_files -->
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    <!-- end iterate through sphinx environment script_files -->

    <script type="text/javascript" src="../_static/detectmobile.js"></script>
    <script type="text/javascript" src="../_static/init.js"></script>


    </body>
</html>


